!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=24)}([function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var t,o;t=n(7),e.graph=t.graph,e.Graph=t.Graph,e.journal=t.journal,e.Journal=t.Journal,e.Network=n(15).Network,e.isBrowser=n(5).isBrowser,e.ComponentLoader=n(10).ComponentLoader,e.Component=n(17).Component,e.AsyncComponent=n(89).AsyncComponent,e.helpers=n(90),e.streams=n(12),o=n(18),e.InPorts=o.InPorts,e.OutPorts=o.OutPorts,e.InPort=n(19),e.OutPort=n(21),e.Port=n(11).Port,e.ArrayPort=n(91).ArrayPort,e.internalSocket=n(6),e.IP=n(4),e.createNetwork=function(t,n,o){var i,s;return"object"!==r(o)&&(o={delay:o}),"function"!=typeof n&&(n=function(t){if(t)throw t}),i=new e.Network(t,o),s=function(t){return t.start(function(e){return e?n(e):n(null,t)})},i.loader.listComponents(function(e){return e?n(e):0===t.nodes.length?s(i):o.delay?void n(null,i):i.connect(function(t){return t?n(t):s(i)})}),i},e.loadFile=function(t,n,o){return o||(o=n,null),o&&"object"!==r(n)&&(n={baseDir:n}),e.graph.loadFile(t,function(t,r){return t?o(t):(n.baseDir&&(r.baseDir=n.baseDir),e.createNetwork(r,o,n))})},e.saveFile=function(t,n,r){return e.graph.save(n,r)},e.asCallback=n(92).asCallback}).call(this)},function(t,e,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function p(t,e,n,r){var o,i,s,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=c(t))>0&&s.length>o&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return t}function d(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,i(this.listener,this.target,t))}.bind(r);return o.listener=n,r.wrapFn=o,o}function l(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):f(o,o.length)}function h(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=o[t];if(void 0===u)return!1;if("function"==typeof u)i(u,this,e);else{var c=u.length,p=f(u,c);for(n=0;n<c;++n)i(p[n],this,e)}return!0},a.prototype.addListener=function(t,e){return p(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return p(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,d(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,d(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,o,i,s;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return l(this,t,!0)},a.prototype.rawListeners=function(t){return l(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):h.call(t,e)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],p=!1,d=-1;function l(){p&&u&&(p=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!p){var t=a(l);p=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,p=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new f(t,e)),1!==c.length||p||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";(function(r){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.log=function(){var t;return"object"===("undefined"==typeof console?"undefined":o(console))&&console.log&&(t=console).log.apply(t,arguments)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))}),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(87)(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(2))},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){t.exports=function(){function t(t,e,n){var r,o;for(r in this.type=null!=t?t:"data",this.data=null!=e?e:null,null==n&&(n={}),this._isIP=!0,this.scope=null,this.owner=null,this.clonable=!1,this.index=null,this.schema=null,this.datatype="all",n)o=n[r],this[r]=o}return t.types=["data","openBracket","closeBracket"],t.isIP=function(t){return t&&"object"===n(t)&&!0===t._isIP},t.prototype.clone=function(){var e,r,o;for(r in e=new t(this.type),this)o=this[r],-1===["owner"].indexOf(r)&&null!==o&&("object"===n(o)?e[r]=JSON.parse(JSON.stringify(o)):e[r]=o);return e},t.prototype.move=function(t){this.owner=t},t.prototype.drop=function(){var t,e;for(t in e=[],this)this[t],e.push(delete this[t]);return e},t}()}).call(this)},function(t,e,n){(function(t){(function(){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this)}).call(this,n(2))},function(t,e,n){(function(){var t,r,o,i={}.hasOwnProperty;t=n(1).EventEmitter,r=n(4),o=function(e){function n(t){this.metadata=null!=t?t:{},this.brackets=[],this.connected=!1,this.dataDelegate=null,this.debug=!1,this.emitEvent=this.regularEmitEvent}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.regularEmitEvent=function(t,e){return this.emit(t,e)},n.prototype.debugEmitEvent=function(t,e){var n,r;try{return this.emit(t,e)}catch(r){if((n=r).id&&n.metadata&&n.error){if(0===this.listeners("error").length)throw n.error;return void this.emit("error",n)}if(0===this.listeners("error").length)throw n;return this.emit("error",{id:this.to.process.id,error:n,metadata:this.metadata})}},n.prototype.connect=function(){if(!this.connected)return this.connected=!0,this.emitEvent("connect",null)},n.prototype.disconnect=function(){if(this.connected)return this.connected=!1,this.emitEvent("disconnect",null)},n.prototype.isConnected=function(){return this.connected},n.prototype.send=function(t){return void 0===t&&"function"==typeof this.dataDelegate&&(t=this.dataDelegate()),this.handleSocketEvent("data",t)},n.prototype.post=function(t,e){if(null==e&&(e=!0),void 0===t&&"function"==typeof this.dataDelegate&&(t=this.dataDelegate()),this.isConnected()||0!==this.brackets.length||this.connect(),this.handleSocketEvent("ip",t,!1),e&&this.isConnected()&&0===this.brackets.length)return this.disconnect()},n.prototype.beginGroup=function(t){return this.handleSocketEvent("begingroup",t)},n.prototype.endGroup=function(){return this.handleSocketEvent("endgroup")},n.prototype.setDataDelegate=function(t){if("function"!=typeof t)throw Error("A data delegate must be a function.");return this.dataDelegate=t},n.prototype.setDebug=function(t){return this.debug=t,this.emitEvent=this.debug?this.debugEmitEvent:this.regularEmitEvent},n.prototype.getId=function(){var t,e;return t=function(t){return t.process.id+"() "+t.port.toUpperCase()},e=function(t){return t.port.toUpperCase()+" "+t.process.id+"()"},this.from||this.to?this.from&&!this.to?t(this.from)+" -> ANON":this.from?t(this.from)+" -> "+e(this.to):"DATA -> "+e(this.to):"UNDEFINED"},n.prototype.legacyToIp=function(t,e){if(r.isIP(e))return e;switch(t){case"begingroup":return new r("openBracket",e);case"endgroup":return new r("closeBracket");case"data":return new r("data",e);default:return null}},n.prototype.ipToLegacy=function(t){switch(t.type){case"openBracket":return{event:"begingroup",payload:t.data};case"data":return{event:"data",payload:t.data};case"closeBracket":return{event:"endgroup",payload:t.data}}},n.prototype.handleSocketEvent=function(t,e,n){var o,i,s;if(null==n&&(n=!0),o=(i="ip"===t&&r.isIP(e))?e:this.legacyToIp(t,e)){if(!this.isConnected()&&n&&0===this.brackets.length&&this.connect(),"begingroup"===t&&this.brackets.push(e),i&&"openBracket"===o.type&&this.brackets.push(o.data),"endgroup"===t){if(0===this.brackets.length)return;o.data=this.brackets.pop(),e=o.data}if(i&&"closeBracket"===e.type){if(0===this.brackets.length)return;this.brackets.pop()}if(this.emitEvent("ip",o),o&&o.type)return i&&(t=(s=this.ipToLegacy(o)).event,e=s.payload),"connect"===t&&(this.connected=!0),"disconnect"===t&&(this.connected=!1),this.emitEvent(t,e)}},n}(),e.InternalSocket=o,e.createSocket=function(){return new o}}).call(this)},function(t,e,n){e.graph=n(25),e.Graph=e.graph.Graph,e.journal=n(32),e.Journal=e.journal.Journal},function(t,e){},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var o,i,s,a,u,c={}.hasOwnProperty;a=n(6),s=n(7),i=n(1).EventEmitter,u=n(33),o=function(e){function n(t,e){this.baseDir=t,this.options=null!=e?e:{},this.components=null,this.libraryIcons={},this.processing=!1,this.ready=!1,"function"==typeof this.setMaxListeners&&this.setMaxListeners(0)}return function(t,e){for(var n in e)c.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,i),n.prototype.getModulePrefix=function(t){return t?"noflo"===t?"":("@"===t[0]&&(t=t.replace(/\@[a-z\-]+\//,"")),t.replace("noflo-","")):""},n.prototype.listComponents=function(t){if(this.processing)this.once("ready",(e=this,function(){return t(null,e.components)}));else{var e;if(this.components)return t(null,this.components);this.ready=!1,this.processing=!0,this.components={},u.register(this,function(e){return function(n){if(n){if(t)return t(n);throw n}if(e.processing=!1,e.ready=!0,e.emit("ready",!0),t)return t(null,e.components)}}(this))}},n.prototype.load=function(e,n,r){var o,i;if(this.ready){var s;if(!(o=this.components[e])){for(i in this.components)if(i.split("/")[1]===e){o=this.components[i];break}if(!o)return void n(new Error("Component "+e+" not available with base "+this.baseDir))}if(!this.isGraph(o))return this.createComponent(e,o,r,function(t){return function(r,o){return r?n(r):o?("Graph"===e&&(o.baseDir=t.baseDir),"string"==typeof e&&(o.componentName=e),t.setIcon(e,o),n(null,o)):void n(new Error("Component "+e+" could not be loaded."))}}(this));void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(function(t){return function(){return t.loadGraph(e,o,n,r)}}(this)):setTimeout(function(t){return function(){return t.loadGraph(e,o,n,r)}}(this),0)}else this.listComponents((s=this,function(t){return t?n(t):s.load(e,n,r)}))},n.prototype.createComponent=function(t,e,n,o){var i,s;if(!(i=e))return o(new Error("Component "+t+" not available"));if("string"==typeof i)return"function"==typeof u.dynamicLoad?void u.dynamicLoad(t,i,n,o):o(Error("Dynamic loading of "+i+" for component "+t+" not available on this platform."));if("function"==typeof i.getComponent)s=i.getComponent(n);else{if("function"!=typeof i)return void o(new Error("Invalid type "+r(i)+" for component "+t+"."));s=i(n)}return o(null,s)},n.prototype.isGraph=function(t){return"object"===r(t)&&t instanceof s.Graph||(!("object"!==r(t)||!t.processes||!t.connections)||"string"==typeof t&&(-1!==t.indexOf(".fbp")||-1!==t.indexOf(".json")))},n.prototype.loadGraph=function(t,e,n,r){var o;this.createComponent(t,this.components.Graph,r,(o=this,function(r,i){if(r)return n(r);a.createSocket(),i.loader=o,i.baseDir=o.baseDir,i.inPorts.remove("graph"),i.setGraph(e,function(e){return e?n(e):(o.setIcon(t,i),n(null,i))})}))},n.prototype.setIcon=function(t,e){var n,r;e.getIcon&&!e.getIcon()&&(n=(r=t.split("/"))[0],r[1]&&this.getLibraryIcon(n)?e.setIcon(this.getLibraryIcon(n)):e.isSubgraph()?e.setIcon("sitemap"):e.setIcon("square"))},n.prototype.getLibraryIcon=function(t){return this.libraryIcons[t]?this.libraryIcons[t]:null},n.prototype.setLibraryIcon=function(t,e){return this.libraryIcons[t]=e},n.prototype.normalizeName=function(t,e){var n;return n=this.getModulePrefix(t)+"/"+e,t||(n=e),n},n.prototype.registerComponent=function(t,e,n,r){var o;if(o=this.normalizeName(t,e),this.components[o]=n,r)return r()},n.prototype.registerGraph=function(t,e,n,r){return this.registerComponent(t,e,n,r)},n.prototype.registerLoader=function(t,e){return t(this,e)},n.prototype.setSource=function(t,e,n,r,o){return u.setSource?this.ready?u.setSource(this,t,e,n,r,o):void this.listComponents((i=this,function(s){return s?o(s):i.setSource(t,e,n,r,o)})):o(new Error("setSource not allowed"));var i},n.prototype.getSource=function(t,e){return u.getSource?this.ready?u.getSource(this,t,e):void this.listComponents((n=this,function(r){return r?e(r):n.getSource(t,e)})):e(new Error("getSource not allowed"));var n},n.prototype.clear=function(){return this.components=null,this.ready=!1,this.processing=!1},n}(),e.ComponentLoader=o}).call(this)}).call(this,n(2))},function(t,e,n){(function(){var t,r,o,i={}.hasOwnProperty;t=n(1).EventEmitter,o=n(5),r=function(e){function n(t){this.type=t,o.deprecated("noflo.Port is deprecated. Please port to noflo.InPort/noflo.OutPort"),this.type||(this.type="all"),"integer"===this.type&&(this.type="int"),this.sockets=[],this.from=null,this.node=null,this.name=null}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,t),n.prototype.description="",n.prototype.required=!0,n.prototype.getId=function(){return this.node&&this.name?this.node+" "+this.name.toUpperCase():"Port"},n.prototype.getDataType=function(){return this.type},n.prototype.getSchema=function(){return null},n.prototype.getDescription=function(){return this.description},n.prototype.attach=function(t){return this.sockets.push(t),this.attachSocket(t)},n.prototype.attachSocket=function(t,e){var n;return null==e&&(e=null),this.emit("attach",t,e),this.from=t.from,t.setMaxListeners&&t.setMaxListeners(0),t.on("connect",(n=this,function(){return n.emit("connect",t,e)})),t.on("begingroup",function(t){return function(n){return t.emit("begingroup",n,e)}}(this)),t.on("data",function(t){return function(n){return t.emit("data",n,e)}}(this)),t.on("endgroup",function(t){return function(n){return t.emit("endgroup",n,e)}}(this)),t.on("disconnect",function(n){return function(){return n.emit("disconnect",t,e)}}(this))},n.prototype.connect=function(){var t,e,n,r,o;if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");for(r=[],t=0,e=(n=this.sockets).length;t<e;t++)o=n[t],r.push(o.connect());return r},n.prototype.beginGroup=function(t){if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");return this.sockets.forEach(function(e){return e.isConnected()?e.beginGroup(t):(e.once("connect",function(){return e.beginGroup(t)}),e.connect())})},n.prototype.send=function(t){if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");return this.sockets.forEach(function(e){return e.isConnected()?e.send(t):(e.once("connect",function(){return e.send(t)}),e.connect())})},n.prototype.endGroup=function(){var t,e,n,r,o;if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");for(r=[],t=0,e=(n=this.sockets).length;t<e;t++)o=n[t],r.push(o.endGroup());return r},n.prototype.disconnect=function(){var t,e,n,r,o;if(0===this.sockets.length)throw new Error(this.getId()+": No connections available");for(r=[],t=0,e=(n=this.sockets).length;t<e;t++)o=n[t],r.push(o.disconnect());return r},n.prototype.detach=function(t){var e;if(0!==this.sockets.length&&(t||(t=this.sockets[0]),-1!==(e=this.sockets.indexOf(t))))return this.isAddressable()?(this.sockets[e]=void 0,void this.emit("detach",t,e)):(this.sockets.splice(e,1),this.emit("detach",t))},n.prototype.isConnected=function(){var t;return t=!1,this.sockets.forEach(function(e){if(e.isConnected())return t=!0}),t},n.prototype.isAddressable=function(){return!1},n.prototype.isRequired=function(){return this.required},n.prototype.isAttached=function(){return this.sockets.length>0},n.prototype.listAttached=function(){var t,e,n,r,o;for(t=[],n=e=0,r=(o=this.sockets).length;e<r;n=++e)o[n]&&t.push(n);return t},n.prototype.canAttach=function(){return!0},n.prototype.clear=function(){},n}(),e.Port=r}).call(this)},function(t,e){(function(){var t,n,r,o;t=function(){function t(t){this.data=t}return t.prototype.sendTo=function(t){return t.send(this.data)},t.prototype.getValue=function(){return this.data},t.prototype.toObject=function(){return this.data},t}(),e.IP=t,o=function(){function e(t){this.key=t,this.value=[]}return e.prototype.push=function(t){return this.value.push(t)},e.prototype.sendTo=function(n){var r,o,i,s;for(n.beginGroup(this.key),r=0,i=(s=this.value).length;r<i;r++)(o=s[r])instanceof e||o instanceof t?o.sendTo(n):n.send(o);return n.endGroup(this.key)},e.prototype.getKey=function(){return this.key},e.prototype.getValue=function(){var t,n,r,o,i,s,a;switch(this.value.length){case 0:return null;case 1:return"function"==typeof this.value[0].getValue?this.value[0]instanceof e?((o={})[this.value[0].key]=this.value[0].getValue(),o):this.value[0].getValue():this.value[0];default:for(s=[],!1,t=0,r=(i=this.value).length;t<r;t++)a="function"==typeof(n=i[t]).getValue?n.getValue():n,n instanceof e?((o={})[n.key]=n.getValue(),s.push(o)):s.push(a);return s}},e.prototype.toObject=function(){var t;return(t={})[this.key]=this.getValue(),t},e}(),e.Substream=o,r=function(){function e(t,e){this.port=t,this.ordered=null!=e&&e,this.q=[],this.resetCurrent(),this.resolved=!1}return e.prototype.resetCurrent=function(){return this.level=0,this.current=null,this.stack=[]},e.prototype.beginGroup=function(t){var e;return this.level++,e=new o(t),this.stack.push(e),this.current=e,this},e.prototype.endGroup=function(){var t,e;return this.level>0&&this.level--,e=this.stack.pop(),0===this.level?(this.q.push(e),this.resetCurrent()):((t=this.stack[this.stack.length-1]).push(e),this.current=t),this},e.prototype.send=function(e){return 0===this.level?this.q.push(new t(e)):this.current.push(new t(e)),this},e.prototype.done=function(){return this.ordered?this.resolved=!0:this.flush(),this},e.prototype.disconnect=function(){return this.q.push(null),this},e.prototype.flush=function(){var t,e,n,r,o;if(o=!1,this.q.length>0){for(t=0,n=(r=this.q).length;t<n;t++)null===(e=r[t])?this.port.isConnected()&&this.port.disconnect():e.sendTo(this.port);o=!0}return this.q=[],o},e.prototype.isAttached=function(){return this.port.isAttached()},e}(),e.StreamSender=r,n=function(){function e(e,n,r){var i;this.port=e,this.buffered=null!=n&&n,this.process=null!=r?r:null,this.q=[],this.resetCurrent(),this.port.process=(i=this,function(e,n,r){var s;switch(e){case"connect":if("function"==typeof i.process)return i.process("connect",r);break;case"begingroup":return i.level++,s=new o(n),1===i.level?(i.root=s,i.parent=null):i.parent=i.current,i.current=s;case"endgroup":return i.level>0&&i.level--,0===i.level?(i.buffered?(i.q.push(i.root),i.process("readable",r)):"function"==typeof i.process&&i.process("data",i.root,r),i.resetCurrent()):(i.parent.push(i.current),i.current=i.parent);case"data":return 0===i.level?i.q.push(new t(n)):i.current.push(new t(n));case"disconnect":if("function"==typeof i.process)return i.process("disconnect",r)}})}return e.prototype.resetCurrent=function(){return this.level=0,this.root=null,this.current=null,this.parent=null},e.prototype.read=function(){if(0!==this.q.length)return this.q.shift()},e}(),e.StreamReceiver=n}).call(this)},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var n,r,o;try{n=Map}catch(t){n=function(){}}try{r=Set}catch(t){r=function(){}}try{o=Promise}catch(t){o=function(){}}function i(s,u,c,p,d){"object"==typeof u&&(c=u.depth,p=u.prototype,d=u.includeNonEnumerable,u=u.circular);var l=[],h=[],f=void 0!==e;return void 0===u&&(u=!0),void 0===c&&(c=1/0),function s(c,m){if(null===c)return null;if(0===m)return c;var g,y;if("object"!=typeof c)return c;if(t(c,n))g=new n;else if(t(c,r))g=new r;else if(t(c,o))g=new o(function(t,e){c.then(function(e){t(s(e,m-1))},function(t){e(s(t,m-1))})});else if(i.__isArray(c))g=[];else if(i.__isRegExp(c))g=new RegExp(c.source,a(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(i.__isDate(c))g=new Date(c.getTime());else{if(f&&e.isBuffer(c))return g=e.allocUnsafe?e.allocUnsafe(c.length):new e(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):void 0===p?(y=Object.getPrototypeOf(c),g=Object.create(y)):(g=Object.create(p),y=p)}if(u){var v=l.indexOf(c);if(-1!=v)return h[v];l.push(c),h.push(g)}for(var b in t(c,n)&&c.forEach(function(t,e){var n=s(e,m-1),r=s(t,m-1);g.set(n,r)}),t(c,r)&&c.forEach(function(t){var e=s(t,m-1);g.add(e)}),c){var w;y&&(w=Object.getOwnPropertyDescriptor(y,b)),w&&null==w.set||(g[b]=s(c[b],m-1))}if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(c);for(b=0;b<P.length;b++){var k=P[b];(!(E=Object.getOwnPropertyDescriptor(c,k))||E.enumerable||d)&&(g[k]=s(c[k],m-1),E.enumerable||Object.defineProperty(g,k,{enumerable:!1}))}}if(d){var C=Object.getOwnPropertyNames(c);for(b=0;b<C.length;b++){var E,x=C[b];(E=Object.getOwnPropertyDescriptor(c,x))&&E.enumerable||(g[x]=s(c[x],m-1),Object.defineProperty(g,x,{enumerable:!1}))}}return g}(s,c)}function s(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=s,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===s(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===s(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===s(t)},i.__getRegExpFlags=a,i}();t.exports&&(t.exports=n)}).call(this,n(14).Buffer)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(26),o=n(27),i=n(28);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=l(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(e,n),o=(t=a(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|h(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):l(t,e);if("Buffer"===e.type&&i(e.data))return l(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function p(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(p(e),t=a(t,e<0?0:0|h(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e){var n=e.length<0?0:0|h(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function f(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(t).length;default:if(r)return M(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,o);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,o){var i,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var p=-1;for(i=n;i<a;i++)if(c(t,i)===c(e,-1===p?0:i-p)){if(-1===p&&(p=i),i-p+1===u)return p*s}else-1!==p&&(i-=i-p),p=-1}else for(n+u>a&&(n=a-u),i=n;i>=0;i--){for(var d=!0,l=0;l<u;l++)if(c(t,i+l)!==c(e,l)){d=!1;break}if(d)return i}return-1}function v(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function b(t,e,n,r){return U(M(e,t.length-n),t,n,r)}function w(t,e,n,r){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function P(t,e,n,r){return w(t,e,n,r)}function k(t,e,n,r){return U(q(e),t,n,r)}function C(t,e,n,r){return U(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function x(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,a,u,c=t[o],p=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(p=c);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&c)<<6|63&i)>127&&(p=u);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(p=u);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(p=u)}null===p?(p=65533,d=1):p>65535&&(p-=65536,r.push(p>>>10&1023|55296),p=56320|1023&p),r.push(p),o+=d}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return p(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return d(null,t)},u.allocUnsafeSlow=function(t){return d(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},u.byteLength=f,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?x(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return x(this,e,n);case"ascii":return _(this,e,n);case"latin1":case"binary":return O(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,o){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(i,s),c=this.slice(r,o),p=t.slice(e,n),d=0;d<a;++d)if(c[d]!==p[d]){i=c[d],s=p[d];break}return i<s?-1:s<i?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return P(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function _(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function O(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function I(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=F(t[i]);return o}function S(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,n,r,o,i){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function N(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function L(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function j(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,i){return i||j(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,i){return i||j(t,0,n,8),o.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var o=e-t;n=new u(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},u.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},u.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||T(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||T(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):L(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);T(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);T(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):L(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=u.isBuffer(t)?t:M(new u(t,r).toString()),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var G=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function M(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function q(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(9))},function(t,e,n){(function(t){(function(){var r,o,i,s,a,u,c,p={}.hasOwnProperty;a=n(6),n(7),r=n(1).EventEmitter,u=n(5),s=n(10),c=n(16),o=n(4),i=function(e){function n(e,n){this.options=null!=n?n:{},this.processes={},this.connections=[],this.initials=[],this.nextInitials=[],this.defaults=[],this.graph=e,this.started=!1,this.stopped=!0,this.debug=!0,this.eventBuffer=[],u.isBrowser()?this.baseDir=e.baseDir||"/":this.baseDir=e.baseDir||t.cwd(),this.startupDate=null,e.componentLoader?this.loader=e.componentLoader:this.loader=new s.ComponentLoader(this.baseDir,this.options)}return function(t,e){for(var n in e)p.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,r),n.prototype.processes={},n.prototype.connections=[],n.prototype.initials=[],n.prototype.defaults=[],n.prototype.graph=null,n.prototype.startupDate=null,n.prototype.uptime=function(){return this.startupDate?new Date-this.startupDate:0},n.prototype.getActiveProcesses=function(){var t,e,n,r;if(t=[],!this.started)return t;for(e in r=this.processes)(n=r[e]).component.load>0&&t.push(e),n.component.__openConnections>0&&t.push(e);return t},n.prototype.bufferedEmit=function(t,e){var n,r,o,i;if("error"!==t&&"process-error"!==t&&"end"!==t)if(this.isStarted()||"end"===t){if(this.emit(t,e),"start"===t){for(r=0,o=(i=this.eventBuffer).length;r<o;r++)n=i[r],this.emit(n.type,n.payload);return this.eventBuffer=[]}}else this.eventBuffer.push({type:t,payload:e});else this.emit(t,e)},n.prototype.load=function(t,e,n){return this.loader.load(t,n,e)},n.prototype.addNode=function(t,e){var n,r;if(!this.processes[t.id])return n={id:t.id},t.component?this.load(t.component,t.metadata,(r=this,function(o,i){var s,a,u,c;if(o)return e(o);for(a in i.nodeId=t.id,n.component=i,n.componentName=t.component,s=n.component.inPorts.ports||n.component.inPorts,u=n.component.outPorts.ports||n.component.outPorts,s)(c=s[a]).node=t.id,c.nodeInstance=i,c.name=a;for(a in u)(c=u[a]).node=t.id,c.nodeInstance=i,c.name=a;return i.isSubgraph()&&r.subscribeSubgraph(n),r.subscribeNode(n),r.processes[n.id]=n,e(null,n)})):(this.processes[n.id]=n,void e(null,n));e(null,this.processes[t.id])},n.prototype.removeNode=function(t,e){return this.processes[t.id]?this.processes[t.id].component.shutdown((n=this,function(r){return r?e(r):(delete n.processes[t.id],e(null))})):e(new Error("Node "+t.id+" not found"));var n},n.prototype.renameNode=function(t,e,n){var r,o,i,s,a;if(!(a=this.getNode(t)))return n(new Error("Process "+t+" not found"));for(o in a.id=e,r=a.component.inPorts.ports||a.component.inPorts,i=a.component.outPorts.ports||a.component.outPorts,r)(s=r[o])&&(s.node=e);for(o in i)(s=i[o])&&(s.node=e);return this.processes[e]=a,delete this.processes[t],n(null)},n.prototype.getNode=function(t){return this.processes[t]},n.prototype.connect=function(t){var e,n,r,o,i,s,a;return null==t&&(t=function(){}),e=0,a=this,o=function(n,r){return function(o){return a["add"+o](r,function(r){return r?t(r):++e%100!=0?n(o):void setTimeout(function(){return n(o)},0)})}},s=function(e){return function(){return e.subscribeGraph(),t()}}(this),i=c.reduceRight(this.graph.nodes,o,s),r=c.reduceRight(this.graph.initializers,o,function(){return i("Defaults")}),n=c.reduceRight(this.graph.edges,o,function(){return r("Initial")}),c.reduceRight(this.graph.nodes,o,function(){return n("Edge")})("Node")},n.prototype.connectPort=function(t,e,n,r,o,i){if(o)return t.to={process:e,port:n,index:r},e.component.inPorts&&e.component.inPorts[n]?e.component.inPorts[n].isAddressable()?(e.component.inPorts[n].attach(t,r),void i()):(e.component.inPorts[n].attach(t),void i()):void i(new Error("No inport '"+n+"' defined in process "+e.id+" ("+t.getId()+")"));if(t.from={process:e,port:n,index:r},e.component.outPorts&&e.component.outPorts[n]){if(e.component.outPorts[n].isAddressable())return e.component.outPorts[n].attach(t,r),void i();e.component.outPorts[n].attach(t),i()}else i(new Error("No outport '"+n+"' defined in process "+e.id+" ("+t.getId()+")"))},n.prototype.subscribeGraph=function(){var t,e,n,r,o;return t=[],n=!1,r=function(e,n){return t.push({op:e,details:n})},o=this,e=function(r){var i,s;if(r){if(0===o.listeners("process-error").length)throw r;o.bufferedEmit("process-error",r)}if(t.length)switch(n=!0,s=t.shift(),i=e,s.op){case"renameNode":return o.renameNode(s.details.from,s.details.to,i);default:return o[s.op](s.details,i)}else n=!1},this.graph.on("addNode",function(t){if(r("addNode",t),!n)return e()}),this.graph.on("removeNode",function(t){if(r("removeNode",t),!n)return e()}),this.graph.on("renameNode",function(t,o){if(r("renameNode",{from:t,to:o}),!n)return e()}),this.graph.on("addEdge",function(t){if(r("addEdge",t),!n)return e()}),this.graph.on("removeEdge",function(t){if(r("removeEdge",t),!n)return e()}),this.graph.on("addInitial",function(t){if(r("addInitial",t),!n)return e()}),this.graph.on("removeInitial",function(t){if(r("removeInitial",t),!n)return e()})},n.prototype.subscribeSubgraph=function(t){var e,n;if(t.component.isReady()){if(t.component.network)return t.component.network.setDebug(this.debug),e=function(e){return function(n,r){if("process-error"===n&&0===e.listeners("process-error").length){if(r.id&&r.metadata&&r.error)throw r.error;throw r}return r||(r={}),r.subgraph?(r.subgraph.unshift||(r.subgraph=[r.subgraph]),r.subgraph=r.subgraph.unshift(t.id)):r.subgraph=[t.id],e.bufferedEmit(n,r)}}(this),t.component.network.on("connect",function(t){return e("connect",t)}),t.component.network.on("begingroup",function(t){return e("begingroup",t)}),t.component.network.on("data",function(t){return e("data",t)}),t.component.network.on("endgroup",function(t){return e("endgroup",t)}),t.component.network.on("disconnect",function(t){return e("disconnect",t)}),t.component.network.on("ip",function(t){return e("ip",t)}),t.component.network.on("process-error",function(t){return e("process-error",t)})}else t.component.once("ready",(n=this,function(){return n.subscribeSubgraph(t)}))},n.prototype.subscribeSocket=function(t,e){var n;return t.on("ip",(n=this,function(e){return n.bufferedEmit("ip",{id:t.getId(),type:e.type,socket:t,data:e.data,metadata:t.metadata})})),t.on("connect",function(n){return function(){return e&&e.component.isLegacy()&&(e.component.__openConnections||(e.component.__openConnections=0),e.component.__openConnections++),n.bufferedEmit("connect",{id:t.getId(),socket:t,metadata:t.metadata})}}(this)),t.on("begingroup",function(e){return function(n){return e.bufferedEmit("begingroup",{id:t.getId(),socket:t,group:n,metadata:t.metadata})}}(this)),t.on("data",function(e){return function(n){return e.bufferedEmit("data",{id:t.getId(),socket:t,data:n,metadata:t.metadata})}}(this)),t.on("endgroup",function(e){return function(n){return e.bufferedEmit("endgroup",{id:t.getId(),socket:t,group:n,metadata:t.metadata})}}(this)),t.on("disconnect",function(n){return function(){if(n.bufferedEmit("disconnect",{id:t.getId(),socket:t,metadata:t.metadata}),e&&e.component.isLegacy()&&(e.component.__openConnections--,e.component.__openConnections<0&&(e.component.__openConnections=0),0===e.component.__openConnections))return n.checkIfFinished()}}(this)),t.on("error",function(t){return function(e){if(0===t.listeners("process-error").length){if(e.id&&e.metadata&&e.error)throw e.error;throw e}return t.bufferedEmit("process-error",e)}}(this))},n.prototype.subscribeNode=function(t){var e;if(t.component.on("deactivate",(e=this,function(t){if(!(t>0))return e.checkIfFinished()})),t.component.getIcon)return t.component.on("icon",function(e){return function(){return e.bufferedEmit("icon",{id:t.id,icon:t.component.getIcon()})}}(this))},n.prototype.addEdge=function(t,e){var n,r,o;if((r=a.createSocket(t.metadata)).setDebug(this.debug),!(n=this.getNode(t.from.node)))return e(new Error("No process defined for outbound node "+t.from.node));if(!n.component)return e(new Error("No component defined for outbound node "+t.from.node));if(n.component.isReady()){var i;if(!(o=this.getNode(t.to.node)))return e(new Error("No process defined for inbound node "+t.to.node));if(!o.component)return e(new Error("No component defined for inbound node "+t.to.node));if(o.component.isReady())return this.subscribeSocket(r,n),this.connectPort(r,o,t.to.port,t.to.index,!0,function(o){return function(i){return i?e(i):o.connectPort(r,n,t.from.port,t.from.index,!1,function(t){return t?e(t):(o.connections.push(r),e())})}}(this));o.component.once("ready",function(n){return function(){return n.addEdge(t,e)}}(this))}else n.component.once("ready",(i=this,function(){return i.addEdge(t,e)}))},n.prototype.removeEdge=function(t,e){var n,r,o,i,s;for(s=[],r=0,o=(i=this.connections).length;r<o;r++)(n=i[r])&&t.to.node===n.to.process.id&&t.to.port===n.to.port&&(n.to.process.component.inPorts[n.to.port].detach(n),t.from.node&&n.from&&t.from.node===n.from.process.id&&t.from.port===n.from.port&&n.from.process.component.outPorts[n.from.port].detach(n),this.connections.splice(this.connections.indexOf(n),1),s.push(e()));return s},n.prototype.addDefaults=function(t,e){var n,r,o,i,s,u;if(!(o=this.processes[t.id]).component.isReady())return o.component.setMaxListeners&&o.component.setMaxListeners(0),void o.component.once("ready",(u=this,function(){return u.addDefaults(o,e)}));for(n in i=o.component.inPorts.ports)"function"==typeof(r=i[n]).hasDefault&&r.hasDefault()&&!r.isAttached()&&((s=a.createSocket()).setDebug(this.debug),this.subscribeSocket(s),this.connectPort(s,o,n,void 0,!0,function(){}),this.connections.push(s),this.defaults.push(s));return e()},n.prototype.addInitial=function(t,e){var n,r,o;return(n=a.createSocket(t.metadata)).setDebug(this.debug),this.subscribeSocket(n),(r=this.getNode(t.to.node))?r.component.isReady()||r.component.inPorts[t.to.port]?this.connectPort(n,r,t.to.port,t.to.index,!0,function(r){return function(o){var i;return o?e(o):(r.connections.push(n),i={socket:n,data:t.from.data},r.initials.push(i),r.nextInitials.push(i),r.isRunning()?r.sendInitials():r.isStopped()||(r.setStarted(!0),r.sendInitials()),e())}}(this)):(r.component.setMaxListeners&&r.component.setMaxListeners(0),void r.component.once("ready",(o=this,function(){return o.addInitial(t,e)}))):e(new Error("No process defined for inbound node "+t.to.node))},n.prototype.removeInitial=function(t,e){var n,r,o,i,s,a,u,c,p,d,l;for(r=0,a=(p=this.connections).length;r<a;r++)if((n=p[r])&&t.to.node===n.to.process.id&&t.to.port===n.to.port){for(n.to.process.component.inPorts[n.to.port].detach(n),this.connections.splice(this.connections.indexOf(n),1),i=0,u=(d=this.initials).length;i<u;i++)(o=d[i])&&o.socket===n&&this.initials.splice(this.initials.indexOf(o),1);for(s=0,c=(l=this.nextInitials).length;s<c;s++)(o=l[s])&&o.socket===n&&this.nextInitials.splice(this.nextInitials.indexOf(o),1)}return e()},n.prototype.sendInitial=function(t){return t.socket.post(new o("data",t.data,{initial:!0}))},n.prototype.sendInitials=function(e){var n,r;return e||(e=function(){}),r=this,n=function(){var t,n,o,i;for(t=0,o=(i=r.initials).length;t<o;t++)n=i[t],r.sendInitial(n);return r.initials=[],e()},void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(n):setTimeout(n,0)},n.prototype.isStarted=function(){return this.started},n.prototype.isStopped=function(){return this.stopped},n.prototype.isRunning=function(){return!!this.started&&this.getActiveProcesses().length>0},n.prototype.startComponents=function(t){var e,n,r,o,i,s,a;if(t||(t=function(){}),e=0,r=this.processes?Object.keys(this.processes).length:0,o=function(n){return n?t(n):++e===r?t():void 0},!this.processes||!Object.keys(this.processes).length)return t();for(n in a=[],s=this.processes)(i=s[n]).component.isStarted()?o():0!==i.component.start.length?a.push(i.component.start(o)):(u.deprecated("component.start method without callback is deprecated"),i.component.start(),o());return a},n.prototype.sendDefaults=function(t){var e,n,r,o;if(t||(t=function(){}),!this.defaults.length)return t();for(e=0,n=(r=this.defaults).length;e<n;e++)1===(o=r[e]).to.process.component.inPorts[o.to.port].sockets.length&&(o.connect(),o.send(),o.disconnect());return t()},n.prototype.start=function(t){var e;if(t||(u.deprecated("Calling network.start() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),!this.started)return this.initials=this.nextInitials.slice(0),this.eventBuffer=[],this.startComponents(function(e){return function(n){return n?t(n):e.sendInitials(function(n){return n?t(n):e.sendDefaults(function(n){return n?t(n):(e.setStarted(!0),t(null))})})}}(this));this.stop((e=this,function(n){return n?t(n):e.start(t)}))},n.prototype.stop=function(t){var e,n,r,o,i,s,a,c,p,d,l,h;if(t||(u.deprecated("Calling network.stop() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),!this.started)return this.stopped=!0,t(null);for(r=0,i=(p=this.connections).length;r<i;r++)(e=p[r]).isConnected()&&e.disconnect();if(n=0,s=this.processes?Object.keys(this.processes).length:0,h=this,a=function(e){return e?t(e):++n===s?(h.setStarted(!1),h.stopped=!0,t()):void 0},!this.processes||!Object.keys(this.processes).length)return this.setStarted(!1),this.stopped=!0,t();for(o in l=[],d=this.processes)(c=d[o]).component.isStarted()?0!==c.component.shutdown.length?l.push(c.component.shutdown(a)):(u.deprecated("component.shutdown method without callback is deprecated"),c.component.shutdown(),a()):a();return l},n.prototype.setStarted=function(t){if(this.started!==t)return t?(this.startupDate||(this.startupDate=new Date),this.started=!0,this.stopped=!1,this.bufferedEmit("start",{start:this.startupDate})):(this.started=!1,void this.bufferedEmit("end",{start:this.startupDate,end:new Date,uptime:this.uptime()}))},n.prototype.checkIfFinished=function(){var t;if(!this.isRunning())return delete this.abortDebounce,this.debouncedEnd||(this.debouncedEnd=c.debounce((t=this,function(){if(!t.abortDebounce&&!t.isRunning())return t.setStarted(!1)}),50)),this.debouncedEnd()},n.prototype.getDebug=function(){return this.debug},n.prototype.setDebug=function(t){var e,n,r,o,i,s,a;if(t!==this.debug){for(this.debug=t,e=0,r=(i=this.connections).length;e<r;e++)i[e].setDebug(t);for(o in a=[],s=this.processes)(n=s[o].component).isSubgraph()?a.push(n.network.setDebug(t)):a.push(void 0);return a}},n}(),e.Network=i}).call(this)}).call(this,n(2))},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var t,r,o,i,s,a,u,c,p,d,l,h;t=function(e){var r,o,i;if(null==e||"object"!==n(e))return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return r="",null!=e.global&&(r+="g"),null!=e.ignoreCase&&(r+="i"),null!=e.multiline&&(r+="m"),null!=e.sticky&&(r+="y"),new RegExp(e.source,r);for(o in i=new e.constructor,e)i[o]=t(e[o]);return i},a=function(t){return/.*\.coffee$/.test(t)?"coffeescript":"javascript"},c=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(arg)},p=function(t){var e;return"function"===(e=n(t))||"object"===e&&!!t},h=function(t){var e,n,r,o,i,s;for(r={},n=e=0,o=t.length;0<=o?e<o:e>o;n=0<=o?++e:--e)r[t[n]]=t[n];for(n in i=[],r)s=r[n],i.push(s);return i},d=function(t,e,n){if(void 0===e)return t;switch(null===n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}},l=function(t){var e;return e=function(e,n,r,o,i,s){for(var a;i>=0&&i<s;)r=n(r,e[a=o?o[i]:i],a,e),i+=t;return r},function(n,r,o,i){var s,a,u;return r=d(r,i,4),u=((a=Object.keys(n))||n).length,s=t>0?0:u-1,arguments.length<3&&(o=n[a?a[s]:s],s+=t),e(n,r,o,a,s,u)}}(-1),o=function(t,e,n){var r,o,i,s,a,u;return a=void 0,r=void 0,o=void 0,u=void 0,s=void 0,i=function(){var c;(c=Date.now-u)<e&&c>=0?a=setTimeout(i,e-c):(a=null,n||(s=t.apply(o,r),a||(o=r=null)))},function(){var c;return o=this,r=arguments,u=Date.now,c=n&&!a,a||(a=setTimeout(i,e)),c&&(s=t.apply(o,r),o=r=null),s}},i=function(t){var e,n;if(!p(t))return[];if(Object.keys)return Object.keys(t);for(e in n=[],t)t.has(e)&&n.push(e);return n},s=function(t){var e,n,r,o;for(r=(n=i(t)).length,o=Array(r),e=0;e<r;)o[e]=t[n[e]],e++;return o},r=function(t,e,n){return c(t)||(t=s(t)),("number"!=typeof n||guard)&&(n=0),t.indexOf(e)>=0},u=function(t){var e,n,o,i,s,a,u,c,p;for(p=[],e=arguments.length,n=s=0,u=t.length;0<=u?s<=u:s>=u;n=0<=u?++s:--s)if(o=t[n],!r(p,o)){for(i=a=1,c=e;(1<=c?a<=c:a>=c)&&r(arguments[i],o);i=1<=c?++a:--a);i===e&&p.push(o)}return p},e.clone=t,e.guessLanguageFromFilename=a,e.optimizeCb=d,e.reduceRight=l,e.debounce=o,e.unique=h,e.intersection=u,e.getValues=s}).call(this)},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var t,o,i,s,a,u,c,p,d,l,h=function(t,e){return function(){return t.apply(e,arguments)}},f={}.hasOwnProperty,m=[].slice;o=n(1).EventEmitter,l=n(18),i=n(4),c=n(3)("noflo:component"),p=n(3)("noflo:component:brackets"),d=n(3)("noflo:component:send"),t=function(t){function e(t){var e,n,r;this.error=h(this.error,this),t||(t={}),t.inPorts||(t.inPorts={}),t.inPorts instanceof l.InPorts?this.inPorts=t.inPorts:this.inPorts=new l.InPorts(t.inPorts),t.outPorts||(t.outPorts={}),t.outPorts instanceof l.OutPorts?this.outPorts=t.outPorts:this.outPorts=new l.OutPorts(t.outPorts),t.icon&&(this.icon=t.icon),t.description&&(this.description=t.description),this.started=!1,this.load=0,this.ordered=null!=(e=t.ordered)&&e,this.autoOrdering=null!=(n=t.autoOrdering)?n:null,this.outputQ=[],this.bracketContext={in:{},out:{}},this.activateOnInput=null==(r=t.activateOnInput)||r,this.forwardBrackets={in:["out","error"]},"forwardBrackets"in t&&(this.forwardBrackets=t.forwardBrackets),"function"==typeof t.process&&this.process(t.process)}return function(t,e){for(var n in e)f.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o),e.prototype.description="",e.prototype.icon=null,e.prototype.getDescription=function(){return this.description},e.prototype.isReady=function(){return!0},e.prototype.isSubgraph=function(){return!1},e.prototype.setIcon=function(t){return this.icon=t,this.emit("icon",this.icon)},e.prototype.getIcon=function(){return this.icon},e.prototype.error=function(t,e,n,r){var o,i,s,a,u;if(null==e&&(e=[]),null==n&&(n="error"),null==r&&(r=null),!this.outPorts[n]||!this.outPorts[n].isAttached()&&this.outPorts[n].isRequired())throw t;for(i=0,a=e.length;i<a;i++)o=e[i],this.outPorts[n].openBracket(o,{scope:r});for(this.outPorts[n].data(t,{scope:r}),s=0,u=e.length;s<u;s++)o=e[s],this.outPorts[n].closeBracket(o,{scope:r})},e.prototype.setUp=function(t){return t()},e.prototype.tearDown=function(t){return t()},e.prototype.start=function(t){return this.isStarted()?t():this.setUp((e=this,function(n){return n?t(n):(e.started=!0,e.emit("start"),t(null))}));var e},e.prototype.shutdown=function(t){var e,n;return n=this,e=function(){var e,r,o;for(o in r=n.inPorts.ports||n.inPorts)"function"==typeof(e=r[o]).clear&&e.clear();return n.bracketContext={in:{},out:{}},n.isStarted()?(n.started=!1,n.emit("end"),t()):t()},this.tearDown(function(n){return function(r){var o;return r?t(r):n.load>0?(o=function(t){if(!(t>0))return this.removeListener("deactivate",o),e()},void n.on("deactivate",o)):e()}}(this))},e.prototype.isStarted=function(){return this.started},e.prototype.prepareForwarding=function(){var t,e,n,r,o,i,s,a;for(e in s=[],i=this.forwardBrackets)if(o=i[e],e in this.inPorts.ports){for(a=[],t=0,n=o.length;t<n;t++)(r=o[t])in this.outPorts.ports&&a.push(r);0===a.length?s.push(delete this.forwardBrackets[e]):s.push(this.forwardBrackets[e]=a)}else delete this.forwardBrackets[e];return s},e.prototype.isLegacy=function(){return!this.handle&&!this._wpData},e.prototype.process=function(t){var e,n,r,o;if("function"!=typeof t)throw new Error("Process handler must be a function");if(!this.inPorts)throw new Error("Component ports must be defined before process function");for(n in this.prepareForwarding(),this.handle=t,r=this.inPorts.ports,o=this,e=function(t,e){return e.name||(e.name=t),e.on("ip",function(t){return o.handleIP(t,e)})},r)e(n,r[n]);return this},e.prototype.isForwardingInport=function(t){return("string"==typeof t?t:t.name)in this.forwardBrackets},e.prototype.isForwardingOutport=function(t,e){var n,r;return n="string"==typeof t?t:t.name,r="string"==typeof e?e:e.name,!!this.forwardBrackets[n]&&-1!==this.forwardBrackets[n].indexOf(r)},e.prototype.isOrdered=function(){return!!this.ordered||!!this.autoOrdering},e.prototype.handleIP=function(t,e){var n,r,o,i,d,l,h,f;if(e.options.triggering){if("openBracket"!==t.type||null!==this.autoOrdering||this.ordered||(c(this.nodeId+" port '"+e.name+"' entered auto-ordering mode"),this.autoOrdering=!0),f={},this.isForwardingInport(e)){if("openBracket"===t.type)return;if("closeBracket"===t.type){if(o=(n=e.getBuffer(t.scope,t.index)).filter(function(t){return"data"===t.type}),this.outputQ.length>=this.load&&0===o.length){if(n[0]!==t)return;e.get(t.scope,t.index),(r=this.getBracketContext("in",e.name,t.scope,t.index).pop()).closeIp=t,p(this.nodeId+" closeBracket-C from '"+r.source+"' to "+r.ports+": '"+t.data+"'"),f={__resolved:!0,__bracketClosingAfter:[r]},this.outputQ.push(f),this.processOutputQueue()}if(!o.length)return}}r=new s(t,this,e,f),l=new a(this.inPorts,r),h=new u(this.outPorts,r);try{this.handle(l,h,r)}catch(d){i=d,this.deactivate(r),h.sendDone(i)}r.activated||(e.isAddressable()?c(this.nodeId+" packet on '"+e.name+"["+t.index+"]' didn't match preconditions: "+t.type):c(this.nodeId+" packet on '"+e.name+"' didn't match preconditions: "+t.type))}},e.prototype.getBracketContext=function(t,e,n,r){var o,i,s;return i=(s=l.normalizePortName(e)).name,o=s.index,null!=r&&(o=r),("in"===t?this.inPorts:this.outPorts)[i].isAddressable()&&(e=i+"["+o+"]"),this.bracketContext[t][e]||(this.bracketContext[t][e]={}),this.bracketContext[t][e][n]||(this.bracketContext[t][e][n]=[]),this.bracketContext[t][e][n]},e.prototype.addToResult=function(t,e,n,r){var o,i,s,a,u;return null==r&&(r=!1),a=(u=l.normalizePortName(e)).name,i=u.index,s=r?"unshift":"push",this.outPorts[a].isAddressable()?(o=i?parseInt(i):n.index,t[a]||(t[a]={}),t[a][o]||(t[a][o]=[]),n.index=o,void t[a][o][s](n)):(t[a]||(t[a]=[]),t[a][s](n))},e.prototype.getForwardableContexts=function(t,e,n){var r,o,i,s,a;return s=l.normalizePortName(e),i=s.name,o=s.index,r=[],n.forEach((a=this,function(n,s){var u;if(a.isForwardingOutport(t,i)&&-1===n.ports.indexOf(e)&&(!(u=a.getBracketContext("out",i,n.ip.scope,o)[s])||u.ip.data!==n.ip.data||-1===u.ports.indexOf(e)))return r.push(n)})),r},e.prototype.addBracketForwards=function(t){var e,n,r,o,i,s,a,u,c,d,l,h,f,m,g,y,v,b;if(null!=(h=t.__bracketClosingBefore)?h.length:void 0)for(n=0,a=(f=t.__bracketClosingBefore).length;n<a;n++)if(e=f[n],p(this.nodeId+" closeBracket-A from '"+e.source+"' to "+e.ports+": '"+e.closeIp.data+"'"),e.ports.length)for(o=0,u=(m=e.ports).length;o<u;o++)l=m[o],r=e.closeIp.clone(),this.addToResult(t,l,r,!0),this.getBracketContext("out",l,r.scope).pop();if(t.__bracketContext&&Object.keys(t.__bracketContext).reverse().forEach((b=this,function(n){var o,i,s,a,u,c,d,l,h,f,m,g,y,v,w;if((e=t.__bracketContext[n]).length){for(g in v=[],t)if(u=t[g],0!==g.indexOf("__"))if(b.outPorts[g].isAddressable()){for(s in u)if(u[s].filter(function(t){return"data"===t.type}).length&&(y=g+"["+s+"]",(w=b.getForwardableContexts(n,y,e)).length)){for(i=[],c=0,l=w.length;c<l;c++)o=w[c],p(b.nodeId+" openBracket from '"+n+"' to '"+y+"': '"+o.ip.data+"'"),(r=o.ip.clone()).index=parseInt(s),i.push(r),o.ports.push(y),b.getBracketContext("out",g,o.ip.scope,s).push(o);for(i.reverse(),d=0,h=i.length;d<h;d++)a=i[d],b.addToResult(t,g,a,!0)}}else if(u.filter(function(t){return"data"===t.type}).length&&(w=b.getForwardableContexts(n,g,e)).length){for(i=[],m=0,f=w.length;m<f;m++)o=w[m],p(b.nodeId+" openBracket from '"+n+"' to '"+g+"': '"+o.ip.data+"'"),i.push(o.ip.clone()),o.ports.push(g),b.getBracketContext("out",g,o.ip.scope).push(o);i.reverse(),v.push(function(){var e,n,r;for(r=[],n=0,e=i.length;n<e;n++)a=i[n],r.push(this.addToResult(t,g,a,!0));return r}.call(b))}return v}})),null!=(g=t.__bracketClosingAfter)?g.length:void 0)for(i=0,c=(y=t.__bracketClosingAfter).length;i<c;i++)if(e=y[i],p(this.nodeId+" closeBracket-B from '"+e.source+"' to "+e.ports+": '"+e.closeIp.data+"'"),e.ports.length)for(s=0,d=(v=e.ports).length;s<d;s++)l=v[s],r=e.closeIp.clone(),this.addToResult(t,l,r,!1),this.getBracketContext("out",l,r.scope).pop();return delete t.__bracketClosingBefore,delete t.__bracketContext,delete t.__bracketClosingAfter},e.prototype.processOutputQueue=function(){var t,e,n,r,o,i,s,a;for(a=[];this.outputQ.length>0&&this.outputQ[0].__resolved;)s=this.outputQ.shift(),this.addBracketForwards(s),a.push(function(){var a,u,c;for(o in c=[],s)if(r=s[o],0!==o.indexOf("__"))if(this.outPorts.ports[o].isAddressable()){for(t in r)if(e=r[t],t=parseInt(t),this.outPorts.ports[o].isAttached(t))for(a=0,u=e.length;a<u;a++)n=e[a],i=o+"["+n.index+"]","openBracket"===n.type?d(this.nodeId+" sending "+i+" < '"+n.data+"'"):"closeBracket"===n.type?d(this.nodeId+" sending "+i+" > '"+n.data+"'"):d(this.nodeId+" sending "+i+" DATA"),this.outPorts[o].sendIP(n)}else this.outPorts.ports[o].isAttached()&&c.push(function(){var t,e,s;for(s=[],t=0,e=r.length;t<e;t++)n=r[t],i=o,"openBracket"===n.type?d(this.nodeId+" sending "+i+" < '"+n.data+"'"):"closeBracket"===n.type?d(this.nodeId+" sending "+i+" > '"+n.data+"'"):d(this.nodeId+" sending "+i+" DATA"),s.push(this.outPorts[o].sendIP(n));return s}.call(this));return c}.call(this));return a},e.prototype.activate=function(t){if(!t.activated)return t.activated=!0,t.deactivated=!1,this.load++,this.emit("activate",this.load),this.ordered||this.autoOrdering?this.outputQ.push(t.result):void 0},e.prototype.deactivate=function(t){if(!t.deactivated)return t.deactivated=!0,t.activated=!1,this.isOrdered()&&this.processOutputQueue(),this.load--,this.emit("deactivate",this.load)},e}(),e.Component=t,s=function(){function t(t,e,n,r){this.ip=t,this.nodeInstance=e,this.port=n,this.result=r,this.scope=this.ip.scope,this.activated=!1,this.deactivated=!1}return t.prototype.activate=function(){return(this.result.__resolved||-1===this.nodeInstance.outputQ.indexOf(this.result))&&(this.result={}),this.nodeInstance.activate(this)},t.prototype.deactivate=function(){return this.result.__resolved||(this.result.__resolved=!0),this.nodeInstance.deactivate(this)},t}(),a=function(){function t(t,e){this.ports=t,this.context=e,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.port=this.context.port,this.result=this.context.result,this.scope=this.context.scope}return t.prototype.activate=function(){if(!this.context.activated)return this.nodeInstance.isOrdered()&&(this.result.__resolved=!1),this.nodeInstance.activate(this.context),this.port.isAddressable()?c(this.nodeInstance.nodeId+" packet on '"+this.port.name+"["+this.ip.index+"]' caused activation "+this.nodeInstance.load+": "+this.ip.type):c(this.nodeInstance.nodeId+" packet on '"+this.port.name+"' caused activation "+this.nodeInstance.load+": "+this.ip.type)},t.prototype.attached=function(){var t,e,n,r,o;for((t=1<=arguments.length?m.call(arguments,0):[]).length||(t=["in"]),o=[],e=0,n=t.length;e<n;e++)r=t[e],o.push(this.ports[r].listAttached());return 1===t.length?o.pop():o},t.prototype.has=function(){var t,e,n,r,o;for((t=1<=arguments.length?m.call(arguments,0):[]).length||(t=["in"]),o="function"==typeof t[t.length-1]?t.pop():function(){return!0},e=0,n=t.length;e<n;e++)if(r=t[e],Array.isArray(r)){if(!this.ports[r[0]].isAddressable())throw new Error("Non-addressable ports, access must be with string "+r[0]);if(!this.ports[r[0]].has(this.scope,r[1],o))return!1}else{if(this.ports[r].isAddressable())throw new Error("For addressable ports, access must be with array ["+r+", idx]");if(!this.ports[r].has(this.scope,o))return!1}return!0},t.prototype.hasData=function(){var t;return(t=1<=arguments.length?m.call(arguments,0):[]).length||(t=["in"]),t.push(function(t){return"data"===t.type}),this.has.apply(this,t)},t.prototype.hasStream=function(){var t,e,n,r,o,i,s,a;for((t=1<=arguments.length?m.call(arguments,0):[]).length||(t=["in"]),a="function"==typeof t[t.length-1]?t.pop():function(){return!0},n=0,r=t.length;n<r;n++)if(o=t[n],i=[],[],e=!1,s=function(t){return"openBracket"===t.type?(i.push(t.data),!1):"data"===t.type?(e=a(t,i),!i.length&&e):"closeBracket"===t.type?(i.pop(),!i.length&&!!e):void 0},!this.has(o,s))return!1;return!0},t.prototype.get=function(){var t,e,n,r,o,i,s,a;for(t=1<=arguments.length?m.call(arguments,0):[],this.activate(),t.length||(t=["in"]),a=[],e=0,o=t.length;e<o;e++){if(i=t[e],Array.isArray(i)){if(s=i[0],n=i[1],!this.ports[s].isAddressable())throw new Error("Non-addressable ports, access must be with string portname")}else if(s=i,this.ports[s].isAddressable())throw new Error("For addressable ports, access must be with array [portname, idx]");this.nodeInstance.isForwardingInport(s)?(r=this.__getForForwarding(s,n),a.push(r)):(r=this.ports[s].get(this.scope,n),a.push(r))}return 1===t.length?a[0]:a},t.prototype.__getForForwarding=function(t,e){var n,r,o,i,s,a;for(a=[],r=null;i=this.ports[t].get(this.scope,e);){if("data"===i.type){r=i;break}a.push(i)}for(o=0,s=a.length;o<s;o++)"closeBracket"!==(i=a[o]).type?"openBracket"!==i.type||this.nodeInstance.getBracketContext("in",t,this.scope,e).push({ip:i,ports:[],source:t}):(this.result.__bracketClosingBefore||(this.result.__bracketClosingBefore=[]),(n=this.nodeInstance.getBracketContext("in",t,this.scope,e).pop()).closeIp=i,this.result.__bracketClosingBefore.push(n));return this.result.__bracketContext||(this.result.__bracketContext={}),this.result.__bracketContext[t]=this.nodeInstance.getBracketContext("in",t,this.scope,e).slice(0),r},t.prototype.getData=function(){var t,e,n,r,o,i;for((t=1<=arguments.length?m.call(arguments,0):[]).length||(t=["in"]),e=[],n=0,r=t.length;n<r;n++)if(i=t[n],null!=(o=this.get(i))){for(;"data"!==o.type&&(o=this.get(i)););e.push(o.data)}else e.push(o);return 1===t.length?e.pop():e},t.prototype.getStream=function(){var t,e,n,r,o,i,s,a,u;for((t=1<=arguments.length?m.call(arguments,0):[]).length||(t=["in"]),e=[],r=0,i=t.length;r<i;r++){for(s=t[r],a=[],u=[],n=!1,(o=this.get(s))||e.push(void 0);o&&("openBracket"===o.type&&(a.length||(u=[],n=!1),a.push(o.data),u.push(o)),"data"!==o.type||(u.push(o),n=!0,a.length))&&("closeBracket"!==o.type||(u.push(o),a.pop(),!n||a.length));)o=this.get(s);e.push(u)}return 1===t.length?e.pop():e},t}(),u=function(){function t(t,e){this.ports=t,this.context=e,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.result=this.context.result,this.scope=this.context.scope}return t.prototype.isError=function(t){return t instanceof Error||Array.isArray(t)&&t.length>0&&t[0]instanceof Error},t.prototype.error=function(t){var e,n,r,o,s,a,u;if((a=Array.isArray(t))||(t=[t]),!("error"in this.ports)||!this.ports.error.isAttached()&&this.ports.error.isRequired()){for(u=[],r=0,s=t.length;r<s;r++)throw e=t[r];return u}for(a&&this.sendIP("error",new i("openBracket")),n=0,o=t.length;n<o;n++)e=t[n],this.sendIP("error",e);if(a)return this.sendIP("error",new i("closeBracket"))},t.prototype.sendIP=function(t,e){var n;if(n=i.isIP(e)?e:new i("data",e),null!==this.scope&&null===n.scope&&(n.scope=this.scope),this.nodeInstance.outPorts[t].isAddressable()&&null===n.index)throw new Error("Sending packets to addressable ports requires specifying index");if(!this.nodeInstance.isOrdered())return this.nodeInstance.outPorts[t].sendIP(n);this.nodeInstance.addToResult(this.result,t,n)},t.prototype.send=function(t){var e,n,o,i,s,a,u,c;if(this.isError(t))return this.error(t);for(e=[],i=!1,n=0,o=(u=Object.keys(this.ports.ports)).length;n<o;n++)"error"!==(a=u[n])&&"ports"!==a&&"_callbacks"!==a&&e.push(a),i||null==t||"object"!==r(t)||-1===Object.keys(t).indexOf(a)||(i=!0);if(1!==e.length||i){if(e.length>1&&!i)throw new Error("Port must be specified for sending output");for(a in c=[],t)s=t[a],c.push(this.sendIP(a,s));return c}this.sendIP(e[0],t)},t.prototype.sendDone=function(t){return this.send(t),this.done()},t.prototype.pass=function(t,e){var n,r;if(null==e&&(e={}),!("out"in this.ports))throw new Error('output.pass() requires port "out" to be present');for(n in e)r=e[n],this.ip[n]=r;return this.ip.data=t,this.sendIP("out",this.ip),this.done()},t.prototype.done=function(t){var e,n,r,o,i,s,a,u,p,d;if(this.result.__resolved=!0,this.nodeInstance.activate(this.context),t&&this.error(t),d=this,s=function(){var t,e,n,r;return n=(r=d.nodeInstance.outputQ.filter(function(t){return!t.__resolved||2!==Object.keys(t).length||!t.__bracketClosingAfter})).indexOf(d.result),t=r.length,e=d.nodeInstance.load,n===t-1||-1===n&&e===t+1||t<=1&&1===e},this.nodeInstance.isOrdered()&&s())for(u in p=this.nodeInstance.bracketContext.in)if((r=p[u])[this.scope]&&(a=r[this.scope]).length)for(n=a[a.length-1],e=this.nodeInstance.inPorts[n.source].getBuffer(n.ip.scope,n.ip.index);e.length&&"closeBracket"===e[0].type;)i=this.nodeInstance.inPorts[n.source].get(n.ip.scope,n.ip.index),(o=a.pop()).closeIp=i,this.result.__bracketClosingAfter||(this.result.__bracketClosingAfter=[]),this.result.__bracketClosingAfter.push(o);return c(this.nodeInstance.nodeId+" finished processing "+this.nodeInstance.load),this.nodeInstance.deactivate(this.context)},t}()}).call(this)},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var t,o,i,s,a=function(t,e){for(var n in e)u.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},u={}.hasOwnProperty;t=n(1).EventEmitter,o=n(19),i=n(21),s=function(e){function n(t){var e,n;if(this.ports={},t)for(e in t)n=t[e],this.add(e,n)}return a(n,t),n.prototype.model=o,n.prototype.add=function(t,e,n){if("add"===t||"remove"===t)throw new Error("Add and remove are restricted port names");if(!t.match(/^[a-z0-9_\.\/]+$/))throw new Error("Port names can only contain lowercase alphanumeric characters and underscores. '"+t+"' not allowed");return this.ports[t]&&this.remove(t),"object"===r(e)&&e.canAttach?this.ports[t]=e:this.ports[t]=new this.model(e,n),this[t]=this.ports[t],this.emit("add",t),this},n.prototype.remove=function(t){if(!this.ports[t])throw new Error("Port "+t+" not defined");return delete this.ports[t],delete this[t],this.emit("remove",t),this},n}(),e.InPorts=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,s),e.prototype.on=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].on(e,n)},e.prototype.once=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].once(e,n)},e}(),e.OutPorts=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,s),e.prototype.model=i,e.prototype.connect=function(t,e){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].connect(e)},e.prototype.beginGroup=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].beginGroup(e,n)},e.prototype.send=function(t,e,n){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].send(e,n)},e.prototype.endGroup=function(t,e){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].endGroup(e)},e.prototype.disconnect=function(t,e){if(!this.ports[t])throw new Error("Port "+t+" not available");return this.ports[t].disconnect(e)},e}(),e.normalizePortName=function(t){var e,n;return n={name:t},-1===t.indexOf("[")?n:(null!=(e=t.match(/(.*)\[([0-9]+)\]/))?e.length:void 0)?(n.name=e[1],n.index=e[2],n):t}}).call(this)},function(t,e,n){(function(){var e,r,o,i,s={}.hasOwnProperty;e=n(20),r=n(4),i=n(5),o=function(t){function n(t,e){if(this.process=null,e||"function"!=typeof t||(e=t,t={}),null==t&&(t={}),null==t.buffered&&(t.buffered=!1),null==t.control&&(t.control=!1),null==t.scoped&&(t.scoped=!0),null==t.triggering&&(t.triggering=!0),!e&&t&&t.process&&(e=t.process,delete t.process),e){if(i.deprecated("InPort process callback is deprecated. Please use Process API or the InPort handle option"),"function"!=typeof e)throw new Error("process must be a function");this.process=e}if(t.handle){if(i.deprecated("InPort handle callback is deprecated. Please use Process API"),"function"!=typeof t.handle)throw new Error("handle must be a function");this.handle=t.handle,delete t.handle}n.__super__.constructor.call(this,t),this.prepareBuffer()}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,e),n.prototype.attachSocket=function(t,e){var n;return null==e&&(e=null),this.hasDefault()&&(this.handle?t.setDataDelegate((n=this,function(){return new r("data",n.options.default)})):t.setDataDelegate(function(t){return function(){return t.options.default}}(this))),t.on("connect",function(n){return function(){return n.handleSocketEvent("connect",t,e)}}(this)),t.on("begingroup",function(t){return function(n){return t.handleSocketEvent("begingroup",n,e)}}(this)),t.on("data",function(t){return function(n){return t.validateData(n),t.handleSocketEvent("data",n,e)}}(this)),t.on("endgroup",function(t){return function(n){return t.handleSocketEvent("endgroup",n,e)}}(this)),t.on("disconnect",function(n){return function(){return n.handleSocketEvent("disconnect",t,e)}}(this)),t.on("ip",function(t){return function(n){return t.handleIP(n,e)}}(this))},n.prototype.handleIP=function(t,e){var n;if(!(this.process||this.options.control&&"data"!==t.type))return t.owner=this.nodeInstance,this.isAddressable()&&(t.index=e),"all"===t.datatype&&(t.datatype=this.getDataType()),this.getSchema()&&!t.schema&&(t.schema=this.getSchema()),(n=this.prepareBufferForIP(t)).push(t),this.options.control&&n.length>1&&n.shift(),this.handle&&this.handle(t,this.nodeInstance),this.emit("ip",t,e)},n.prototype.handleSocketEvent=function(t,e,n){return this.isBuffered()?(this.buffer.push({event:t,payload:e,id:n}),void(this.isAddressable()?(this.process&&this.process(t,n,this.nodeInstance),this.emit(t,n)):(this.process&&this.process(t,this.nodeInstance),this.emit(t)))):(this.process&&(this.isAddressable()?this.process(t,e,n,this.nodeInstance):this.process(t,e,this.nodeInstance)),this.isAddressable()?this.emit(t,e,n):this.emit(t,e))},n.prototype.hasDefault=function(){return void 0!==this.options.default},n.prototype.prepareBuffer=function(){return this.buffer=[],this.isAddressable()&&(this.indexedBuffer={}),this.scopedBuffer={},this.iipBuffer=this.isAddressable()?{}:[]},n.prototype.prepareBufferForIP=function(t){return this.isAddressable()?null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),t.index in this.scopedBuffer[t.scope]||(this.scopedBuffer[t.scope][t.index]=[]),this.scopedBuffer[t.scope][t.index]):t.initial?(t.index in this.iipBuffer||(this.iipBuffer[t.index]=[]),this.iipBuffer[t.index]):(t.index in this.indexedBuffer||(this.indexedBuffer[t.index]=[]),this.indexedBuffer[t.index]):null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),this.scopedBuffer[t.scope]):t.initial?this.iipBuffer:this.buffer},n.prototype.validateData=function(t){if(this.options.values&&-1===this.options.values.indexOf(t))throw new Error("Invalid data='"+t+"' received, not in ["+this.options.values+"]")},n.prototype.receive=function(){if(i.deprecated("InPort.receive is deprecated. Use InPort.get instead"),!this.isBuffered())throw new Error("Receive is only possible on buffered ports");return this.buffer.shift()},n.prototype.contains=function(){if(i.deprecated("InPort.contains is deprecated. Use InPort.has instead"),!this.isBuffered())throw new Error("Contains query is only possible on buffered ports");return this.buffer.filter(function(t){if("data"===t.event)return!0}).length},n.prototype.getBuffer=function(t,e,n){if(null==n&&(n=!1),this.isAddressable()){if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;if(!(e in this.scopedBuffer[t]))return;return this.scopedBuffer[t][e]}if(n){if(!(e in this.iipBuffer))return;return this.iipBuffer[e]}if(!(e in this.indexedBuffer))return;return this.indexedBuffer[e]}if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;return this.scopedBuffer[t]}return n?this.iipBuffer:this.buffer},n.prototype.getFromBuffer=function(t,e,n){var r;if(null==n&&(n=!1),null!=(r=this.getBuffer(t,e,n))?r.length:void 0)return this.options.control?r[r.length-1]:r.shift()},n.prototype.get=function(t,e){var n;return void 0!==(n=this.getFromBuffer(t,e))?n:this.getFromBuffer(null,e,!0)},n.prototype.hasIPinBuffer=function(t,e,n,r){var o,i,s;if(null==r&&(r=!1),!(null!=(o=this.getBuffer(t,e,r))?o.length:void 0))return!1;for(i=0,s=o.length;i<s;i++)if(n(o[i]))return!0;return!1},n.prototype.hasIIP=function(t,e){return this.hasIPinBuffer(null,t,e,!0)},n.prototype.has=function(t,e,n){return this.isAddressable()||(n=e,e=null),!!this.hasIPinBuffer(t,e,n)||!!this.hasIIP(e,n)},n.prototype.length=function(t,e){var n;return(n=this.getBuffer(t,e))?n.length:0},n.prototype.ready=function(t,e){return this.length(t)>0},n.prototype.clear=function(){return this.prepareBuffer()},n}(),t.exports=o}).call(this)},function(t,e,n){(function(){var e,r,o,i={}.hasOwnProperty;r=n(1).EventEmitter,o=["all","string","number","int","object","array","boolean","color","date","bang","function","buffer","stream"],e=function(t){function e(t){this.handleOptions(t),this.sockets=[],this.node=null,this.name=null}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,r),e.prototype.handleOptions=function(t){if(t||(t={}),t.datatype||(t.datatype="all"),void 0===t.required&&(t.required=!1),"integer"===t.datatype&&(t.datatype="int"),-1===o.indexOf(t.datatype))throw new Error("Invalid port datatype '"+t.datatype+"' specified, valid are "+o.join(", "));if(t.type&&!t.schema&&(t.schema=t.type,delete t.type),t.schema&&-1===t.schema.indexOf("/"))throw new Error("Invalid port schema '"+t.schema+"' specified. Should be URL or MIME type");return this.options=t},e.prototype.getId=function(){return this.node&&this.name?this.node+" "+this.name.toUpperCase():"Port"},e.prototype.getDataType=function(){return this.options.datatype},e.prototype.getSchema=function(){return this.options.schema||null},e.prototype.getDescription=function(){return this.options.description},e.prototype.attach=function(t,e){if(null==e&&(e=null),this.isAddressable()&&null!==e||(e=this.sockets.length),this.sockets[e]=t,this.attachSocket(t,e),!this.isAddressable())return this.emit("attach",t);this.emit("attach",t,e)},e.prototype.attachSocket=function(){},e.prototype.detach=function(t){var e;if(-1!==(e=this.sockets.indexOf(t))){if(this.sockets[e]=void 0,!this.isAddressable())return this.emit("detach",t);this.emit("detach",t,e)}},e.prototype.isAddressable=function(){return!!this.options.addressable},e.prototype.isBuffered=function(){return!!this.options.buffered},e.prototype.isRequired=function(){return!!this.options.required},e.prototype.isAttached=function(t){return null==t&&(t=null),this.isAddressable()&&null!==t?!!this.sockets[t]:!!this.sockets.length},e.prototype.listAttached=function(){var t,e,n,r,o;for(t=[],n=e=0,r=(o=this.sockets).length;e<r;n=++e)o[n]&&t.push(n);return t},e.prototype.isConnected=function(t){var e;if(null==t&&(t=null),this.isAddressable()){if(null===t)throw new Error(this.getId()+": Socket ID required");if(!this.sockets[t])throw new Error(this.getId()+": Socket "+t+" not available");return this.sockets[t].isConnected()}return e=!1,this.sockets.forEach(function(t){if(t)return t.isConnected()?e=!0:void 0}),e},e.prototype.canAttach=function(){return!0},e}(),t.exports=e}).call(this)},function(t,e,n){(function(){var e,r,o,i={}.hasOwnProperty;e=n(20),r=n(4),o=function(t){function n(t){this.cache={},n.__super__.constructor.call(this,t)}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,e),n.prototype.attach=function(t,e){if(null==e&&(e=null),n.__super__.attach.call(this,t,e),this.isCaching()&&null!=this.cache[e])return this.send(this.cache[e],e)},n.prototype.connect=function(t){var e,n,r,o,i;for(null==t&&(t=null),i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.connect());return r},n.prototype.beginGroup=function(t,e){var n;return null==e&&(e=null),n=this.getSockets(e),this.checkRequired(n),n.forEach(function(e){if(e)return e.beginGroup(t)})},n.prototype.send=function(t,e){var n;return null==e&&(e=null),n=this.getSockets(e),this.checkRequired(n),this.isCaching()&&t!==this.cache[e]&&(this.cache[e]=t),n.forEach(function(e){if(e)return e.send(t)})},n.prototype.endGroup=function(t){var e,n,r,o,i;for(null==t&&(t=null),i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.endGroup());return r},n.prototype.disconnect=function(t){var e,n,r,o,i;for(null==t&&(t=null),i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.disconnect());return r},n.prototype.sendIP=function(t,e,n,o,i){var s,a,u,c,p,d,l;for(null==i&&(i=!0),r.isIP(t)?o=(a=t).index:a=new r(t,e,n),l=this.getSockets(o),this.checkRequired(l),"all"===a.datatype&&(a.datatype=this.getDataType()),this.getSchema()&&!a.schema&&(a.schema=this.getSchema()),this.isCaching()&&e!==(null!=(p=this.cache[o])?p.data:void 0)&&(this.cache[o]=a),c=!0,s=0,u=l.length;s<u;s++)(d=l[s])&&(c?(d.post(a,i),c=!1):(a.clonable&&(a=a.clone()),d.post(a,i)));return this},n.prototype.openBracket=function(t,e,n){return null==t&&(t=null),null==e&&(e={}),null==n&&(n=null),this.sendIP("openBracket",t,e,n)},n.prototype.data=function(t,e,n){return null==e&&(e={}),null==n&&(n=null),this.sendIP("data",t,e,n)},n.prototype.closeBracket=function(t,e,n){return null==t&&(t=null),null==e&&(e={}),null==n&&(n=null),this.sendIP("closeBracket",t,e,n)},n.prototype.checkRequired=function(t){if(0===t.length&&this.isRequired())throw new Error(this.getId()+": No connections available")},n.prototype.getSockets=function(t){if(this.isAddressable()){if(null===t)throw new Error(this.getId()+" Socket ID required");return this.sockets[t]?[this.sockets[t]]:[]}return this.sockets},n.prototype.isCaching=function(){return!!this.options.caching},n}(),t.exports=o}).call(this)},function(t,e,n){!function(e){n(0);var r=n(23),o=function(t){t||(t={}),t.catchExceptions&&(e.onerror=function(t){return this.client&&this.send("network","error",t,{href:this.context?this.context.href:this.client.location.href}),console.error(t),!0}.bind(this)),t.defaultPermissions||(t.defaultPermissions=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource"]),this.prototype.constructor.apply(this,arguments),this.receive=this.prototype.receive,this.canDo=this.prototype.canDo,this.getPermitted=this.prototype.getPermitted,this.client=null};(o.prototype=r).setClient=function(t){this.client=t},o.prototype.send=function(t,e,n,r){this.client&&(n instanceof Error&&(n={message:n.message,stack:n.stack}),this.context&&(r=this.context),this.client.postMessage(JSON.stringify({protocol:t,command:e,payload:n}),r.href),this.prototype.send.apply(this,arguments))},o.prototype.sendAll=function(t,e,n){this.send(t,e,n,window.context)},o.prototype.start=function(){},o.normalizeOptions=function(t){return void 0===t.catchExceptions&&(t.catchExceptions=!0,e.location.search&&"debug"===e.location.search.substring(1)&&(t.catchExceptions=!1)),t},o.subscribe=function(t,e){t.addEventListener("message",function(t){var n;(n="string"==typeof t.data?JSON.parse(t.data):t.data).protocol&&n.command&&e(n,t)})},t.exports=o}(window)},function(t,e,n){(function(){var e,r,o,i,s,a;a={Runtime:n(95),Graph:n(96),Network:n(97),Component:n(98)},r=n(3)("noflo-runtime-base:messaging:receive"),o=n(3)("noflo-runtime-base:messaging:receive:payload"),i=n(3)("noflo-runtime-base:messaging:send"),s=n(3)("noflo-runtime-base:messaging:send:payload"),e=function(){function t(t){this.options=t,this.options||(this.options={}),this.version="0.5",this.component=new a.Component(this),this.graph=new a.Graph(this),this.network=new a.Network(this),this.runtime=new a.Runtime(this),this.context=null,null!=this.options.defaultGraph&&(this.options.defaultGraph.baseDir=this.options.baseDir,"default/main",this.context="none",this.graph.registerGraph("default/main",this.options.defaultGraph),this.network.startNetwork(this.options.defaultGraph,{graph:"default/main"},this.context)),null!=this.options.captureOutput&&this.options.captureOutput&&this.startCapture(),this.options.defaultPermissions||(this.options.defaultPermissions=[]),this.options.permissions||(this.options.permissions={})}return t.prototype.canDo=function(t,e){return-1!==this.getPermitted(e).indexOf(t)},t.prototype.getPermitted=function(t){return t?this.options.permissions[t]?this.options.permissions[t]:[]:this.options.defaultPermissions},t.prototype.send=function(t,e,n,r){return i(t+" "+e),s(n)},t.prototype.sendAll=function(t,e,n,r){},t.prototype.receive=function(t,e,n,i){switch(n||(n={}),r(t+" "+e),o(n),this.context=i,t){case"runtime":return this.runtime.receive(e,n,i);case"graph":return this.graph.receive(e,n,i);case"network":return this.network.receive(e,n,i);case"component":return this.component.receive(e,n,i)}},t}(),t.exports=e,t.exports.trace=n(101),t.exports.direct=n(104)}).call(this)},function(t,e,n){var r={noflo:n(0),"noflo-runtime-postmessage":n(93)};window&&(window.require=function(t){if(r[t])return r[t];throw new Error("Module "+t+" not available")})},function(t,e,n){(function(){var t,r,o,i,s,a,u={}.hasOwnProperty;t=n(1).EventEmitter,o=n(13),s=n(29),r=function(e){function r(t,e){this.name=null!=t?t:"",null==e&&(e={}),this.properties={},this.nodes=[],this.edges=[],this.initializers=[],this.exports=[],this.inports={},this.outports={},this.groups=[],this.transaction={id:null,depth:0},this.caseSensitive=e.caseSensitive||!1}return function(t,e){for(var n in e)u.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(r,t),r.prototype.name="",r.prototype.caseSensitive=!1,r.prototype.properties={},r.prototype.nodes=[],r.prototype.edges=[],r.prototype.initializers=[],r.prototype.exports=[],r.prototype.inports={},r.prototype.outports={},r.prototype.groups=[],r.prototype.getPortName=function(t){return this.caseSensitive?t:t.toLowerCase()},r.prototype.startTransaction=function(t,e){if(this.transaction.id)throw Error("Nested transactions not supported");return this.transaction.id=t,this.transaction.depth=1,this.emit("startTransaction",t,e)},r.prototype.endTransaction=function(t,e){if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");return this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",t,e)},r.prototype.checkTransactionStart=function(){return this.transaction.id?"implicit"===this.transaction.id?this.transaction.depth+=1:void 0:this.startTransaction("implicit")},r.prototype.checkTransactionEnd=function(){if("implicit"===this.transaction.id&&(this.transaction.depth-=1),0===this.transaction.depth)return this.endTransaction("implicit")},r.prototype.setProperties=function(t){var e,n,r;for(n in this.checkTransactionStart(),e=o(this.properties),t)r=t[n],this.properties[n]=r;return this.emit("changeProperties",this.properties,e),this.checkTransactionEnd()},r.prototype.addExport=function(t,e,n,r){var o;if(null==r&&(r={x:0,y:0}),s.deprecated("fbp-graph.Graph exports is deprecated: please use specific inport or outport instead"),this.getNode(e))return this.checkTransactionStart(),o={public:this.getPortName(t),process:e,port:this.getPortName(n),metadata:r},this.exports.push(o),this.emit("addExport",o),this.checkTransactionEnd()},r.prototype.removeExport=function(t){var e,n,r,o,i,a;for(s.deprecated("fbp-graph.Graph exports is deprecated: please use specific inport or outport instead"),t=this.getPortName(t),n=null,o=r=0,i=(a=this.exports).length;r<i;o=++r)(e=a[o]).public===t&&(n=e);if(n)return this.checkTransactionStart(),this.exports.splice(this.exports.indexOf(n),1),this.emit("removeExport",n),this.checkTransactionEnd()},r.prototype.addInport=function(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.inports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addInport",t,this.inports[t]),this.checkTransactionEnd()},r.prototype.removeInport=function(t){var e;if(t=this.getPortName(t),this.inports[t])return this.checkTransactionStart(),e=this.inports[t],this.setInportMetadata(t,{}),delete this.inports[t],this.emit("removeInport",t,e),this.checkTransactionEnd()},r.prototype.renameInport=function(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.inports[t])return this.checkTransactionStart(),this.inports[e]=this.inports[t],delete this.inports[t],this.emit("renameInport",t,e),this.checkTransactionEnd()},r.prototype.setInportMetadata=function(t,e){var n,r,i;if(t=this.getPortName(t),this.inports[t]){for(r in this.checkTransactionStart(),n=o(this.inports[t].metadata),this.inports[t].metadata||(this.inports[t].metadata={}),e)null!=(i=e[r])?this.inports[t].metadata[r]=i:delete this.inports[t].metadata[r];return this.emit("changeInport",t,this.inports[t],n),this.checkTransactionEnd()}},r.prototype.addOutport=function(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.outports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addOutport",t,this.outports[t]),this.checkTransactionEnd()},r.prototype.removeOutport=function(t){var e;if(t=this.getPortName(t),this.outports[t])return this.checkTransactionStart(),e=this.outports[t],this.setOutportMetadata(t,{}),delete this.outports[t],this.emit("removeOutport",t,e),this.checkTransactionEnd()},r.prototype.renameOutport=function(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.outports[t])return this.checkTransactionStart(),this.outports[e]=this.outports[t],delete this.outports[t],this.emit("renameOutport",t,e),this.checkTransactionEnd()},r.prototype.setOutportMetadata=function(t,e){var n,r,i;if(t=this.getPortName(t),this.outports[t]){for(r in this.checkTransactionStart(),n=o(this.outports[t].metadata),this.outports[t].metadata||(this.outports[t].metadata={}),e)null!=(i=e[r])?this.outports[t].metadata[r]=i:delete this.outports[t].metadata[r];return this.emit("changeOutport",t,this.outports[t],n),this.checkTransactionEnd()}},r.prototype.addGroup=function(t,e,n){var r;return this.checkTransactionStart(),r={name:t,nodes:e,metadata:n},this.groups.push(r),this.emit("addGroup",r),this.checkTransactionEnd()},r.prototype.renameGroup=function(t,e){var n,r,o,i;for(this.checkTransactionStart(),r=0,o=(i=this.groups).length;r<o;r++)(n=i[r])&&n.name===t&&(n.name=e,this.emit("renameGroup",t,e));return this.checkTransactionEnd()},r.prototype.removeGroup=function(t){var e,n,r,o;for(this.checkTransactionStart(),n=0,r=(o=this.groups).length;n<r;n++)(e=o[n])&&e.name===t&&(this.setGroupMetadata(e.name,{}),this.groups.splice(this.groups.indexOf(e),1),this.emit("removeGroup",e));return this.checkTransactionEnd()},r.prototype.setGroupMetadata=function(t,e){var n,r,i,s,a,u,c;for(this.checkTransactionStart(),i=0,a=(u=this.groups).length;i<a;i++)if((r=u[i])&&r.name===t){for(s in n=o(r.metadata),e)null!=(c=e[s])?r.metadata[s]=c:delete r.metadata[s];this.emit("changeGroup",r,n)}return this.checkTransactionEnd()},r.prototype.addNode=function(t,e,n){var r;return this.checkTransactionStart(),n||(n={}),r={id:t,component:e,metadata:n},this.nodes.push(r),this.emit("addNode",r),this.checkTransactionEnd(),r},r.prototype.removeNode=function(t){var e,n,r,o,i,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E,x,A,_,O,I,S,D,T;if(P=this.getNode(t)){for(this.checkTransactionStart(),T=[],o=0,p=(A=this.edges).length;o<p;o++)(e=A[o]).from.node!==P.id&&e.to.node!==P.id||T.push(e);for(a=0,d=T.length;a<d;a++)e=T[a],this.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(T=[],u=0,l=(_=this.initializers).length;u<l;u++)(s=_[u]).to.node===P.id&&T.push(s);for(c=0,h=T.length;c<h;c++)s=T[c],this.removeInitial(s.to.node,s.to.port);for(T=[],b=0,f=(O=this.exports).length;b<f;b++)n=O[b],this.getPortName(t)===n.process&&T.push(n);for(w=0,m=T.length;w<m;w++)n=T[w],this.removeExport(n.public);for(E in T=[],I=this.inports)I[E].process===t&&T.push(E);for(k=0,g=T.length;k<g;k++)E=T[k],this.removeInport(E);for(E in T=[],S=this.outports)S[E].process===t&&T.push(E);for(C=0,y=T.length;C<y;C++)E=T[C],this.removeOutport(E);for(x=0,v=(D=this.groups).length;x<v;x++)(r=D[x])&&-1!==(i=r.nodes.indexOf(t))&&r.nodes.splice(i,1);return this.setNodeMetadata(t,{}),-1!==this.nodes.indexOf(P)&&this.nodes.splice(this.nodes.indexOf(P),1),this.emit("removeNode",P),this.checkTransactionEnd()}},r.prototype.getNode=function(t){var e,n,r,o;for(e=0,n=(o=this.nodes).length;e<n;e++)if((r=o[e])&&r.id===t)return r;return null},r.prototype.renameNode=function(t,e){var n,r,o,i,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C;if(this.checkTransactionStart(),m=this.getNode(t)){for(m.id=e,i=0,d=(v=this.edges).length;i<d;i++)(n=v[i])&&(n.from.node===t&&(n.from.node=e),n.to.node===t&&(n.to.node=e));for(u=0,l=(b=this.initializers).length;u<l;u++)(s=b[u])&&s.to.node===t&&(s.to.node=e);for(y in w=this.inports)(g=w[y]).process===t&&(g.process=e);for(y in P=this.outports)(g=P[y]).process===t&&(g.process=e);for(c=0,h=(k=this.exports).length;c<h;c++)(r=k[c]).process===t&&(r.process=e);for(p=0,f=(C=this.groups).length;p<f;p++)(o=C[p])&&-1!==(a=o.nodes.indexOf(t))&&(o.nodes[a]=e);return this.emit("renameNode",t,e),this.checkTransactionEnd()}},r.prototype.setNodeMetadata=function(t,e){var n,r,i,s;if(i=this.getNode(t)){for(r in this.checkTransactionStart(),n=o(i.metadata),i.metadata||(i.metadata={}),e)null!=(s=e[r])?i.metadata[r]=s:delete i.metadata[r];return this.emit("changeNode",i,n),this.checkTransactionEnd()}},r.prototype.addEdge=function(t,e,n,r,o){var i,s,a,u;for(null==o&&(o={}),e=this.getPortName(e),r=this.getPortName(r),s=0,a=(u=this.edges).length;s<a;s++)if((i=u[s]).from.node===t&&i.from.port===e&&i.to.node===n&&i.to.port===r)return;if(this.getNode(t)&&this.getNode(n))return this.checkTransactionStart(),i={from:{node:t,port:e},to:{node:n,port:r},metadata:o},this.edges.push(i),this.emit("addEdge",i),this.checkTransactionEnd(),i},r.prototype.addEdgeIndex=function(t,e,n,r,o,i,s){var a;if(null==s&&(s={}),this.getNode(t)&&this.getNode(r))return e=this.getPortName(e),o=this.getPortName(o),null===i&&(i=void 0),null===n&&(n=void 0),s||(s={}),this.checkTransactionStart(),a={from:{node:t,port:e,index:n},to:{node:r,port:o,index:i},metadata:s},this.edges.push(a),this.emit("addEdge",a),this.checkTransactionEnd(),a},r.prototype.removeEdge=function(t,e,n,r){var o,i,s,a,u,c,p,d,l,h,f,m;if(this.checkTransactionStart(),e=this.getPortName(e),r=this.getPortName(r),m=[],f=[],n&&r)for(s=i=0,c=(l=this.edges).length;i<c;s=++i)(o=l[s]).from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),m.push(o)):f.push(o);else for(s=a=0,p=(h=this.edges).length;a<p;s=++a)(o=h[s]).from.node===t&&o.from.port===e||o.to.node===t&&o.to.port===e?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),m.push(o)):f.push(o);for(this.edges=f,u=0,d=m.length;u<d;u++)o=m[u],this.emit("removeEdge",o);return this.checkTransactionEnd()},r.prototype.getEdge=function(t,e,n,r){var o,i,s,a,u;for(e=this.getPortName(e),r=this.getPortName(r),s=i=0,a=(u=this.edges).length;i<a;s=++i)if((o=u[s])&&o.from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r)return o;return null},r.prototype.setEdgeMetadata=function(t,e,n,r,i){var s,a,u,c;if(a=this.getEdge(t,e,n,r)){for(u in this.checkTransactionStart(),s=o(a.metadata),a.metadata||(a.metadata={}),i)null!=(c=i[u])?a.metadata[u]=c:delete a.metadata[u];return this.emit("changeEdge",a,s),this.checkTransactionEnd()}},r.prototype.addInitial=function(t,e,n,r){var o;if(this.getNode(e))return n=this.getPortName(n),this.checkTransactionStart(),o={from:{data:t},to:{node:e,port:n},metadata:r},this.initializers.push(o),this.emit("addInitial",o),this.checkTransactionEnd(),o},r.prototype.addInitialIndex=function(t,e,n,r,o){var i;if(this.getNode(e))return null===r&&(r=void 0),n=this.getPortName(n),this.checkTransactionStart(),i={from:{data:t},to:{node:e,port:n,index:r},metadata:o},this.initializers.push(i),this.emit("addInitial",i),this.checkTransactionEnd(),i},r.prototype.addGraphInitial=function(t,e,n){var r;if(r=this.inports[e])return this.addInitial(t,r.process,r.port,n)},r.prototype.addGraphInitialIndex=function(t,e,n,r){var o;if(o=this.inports[e])return this.addInitialIndex(t,o.process,o.port,n,r)},r.prototype.removeInitial=function(t,e){var n,r,o,i,s,a,u,c,p;for(e=this.getPortName(e),this.checkTransactionStart(),p=[],c=[],o=r=0,s=(u=this.initializers).length;r<s;o=++r)(n=u[o]).to.node===t&&n.to.port===e?p.push(n):c.push(n);for(this.initializers=c,i=0,a=p.length;i<a;i++)n=p[i],this.emit("removeInitial",n);return this.checkTransactionEnd()},r.prototype.removeGraphInitial=function(t){var e;if(e=this.inports[t])return this.removeInitial(e.process,e.port)},r.prototype.toDOT=function(){var t,e,n,r,o,i,s,a,u,c,p,d,l,h,f,m;for(t=function(t){return t.replace(/\s*/g,"")},e=function(t){return t.replace(/\./g,"")},n="digraph {\n",o=0,c=(h=this.nodes).length;o<c;o++)n+="    "+t((l=h[o]).id)+" [label="+l.id+" shape=box]\n";for(i=a=0,p=(f=this.initializers).length;a<p;i=++a)n+="    data"+i+" [label=\"'"+("function"==typeof(s=f[i]).from.data?"Function":s.from.data)+"'\" shape=plaintext]\n",n+="    data"+i+" -> "+t(s.to.node)+"[headlabel="+e(s.to.port)+" labelfontcolor=blue labelfontsize=8.0]\n";for(u=0,d=(m=this.edges).length;u<d;u++)n+="    "+t((r=m[u]).from.node)+" -> "+t(r.to.node)+"[taillabel="+e(r.from.port)+" headlabel="+e(r.to.port)+" labelfontcolor=blue labelfontsize=8.0]\n";return n+="}"},r.prototype.toYUML=function(){var t,e,n,r,o,i,s,a,u;for(u=[],e=0,o=(s=this.initializers).length;e<o;e++)n=s[e],u.push("(start)["+n.to.port+"]->("+n.to.node+")");for(r=0,i=(a=this.edges).length;r<i;r++)t=a[r],u.push("("+t.from.node+")["+t.from.port+"]->("+t.to.node+")");return u.join(",")},r.prototype.toJSON=function(){var t,e,n,r,o,i,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E,x,A,_,O,I;for(b in u={caseSensitive:this.caseSensitive,properties:{},inports:{},outports:{},groups:[],processes:{},connections:[]},this.name&&(u.properties.name=this.name),P=this.properties)I=P[b],u.properties[b]=I;for(w in k=this.inports)v=k[w],u.inports[w]=v;for(w in C=this.outports)v=C[w],u.outports[w]=v;for(i=0,d=(E=this.exports).length;i<d;i++)n=E[i],u.exports||(u.exports=[]),u.exports.push(n);for(a=0,l=(x=this.groups).length;a<l;a++)o={name:(r=x[a]).name,nodes:r.nodes},Object.keys(r.metadata).length&&(o.metadata=r.metadata),u.groups.push(o);for(c=0,h=(A=this.nodes).length;c<h;c++)y=A[c],u.processes[y.id]={component:y.component},y.metadata&&(u.processes[y.id].metadata=y.metadata);for(p=0,f=(_=this.edges).length;p<f;p++)t={src:{process:(e=_[p]).from.node,port:e.from.port,index:e.from.index},tgt:{process:e.to.node,port:e.to.port,index:e.to.index}},Object.keys(e.metadata).length&&(t.metadata=e.metadata),u.connections.push(t);for(g=0,m=(O=this.initializers).length;g<m;g++)s=O[g],u.connections.push({data:s.from.data,tgt:{process:s.to.node,port:s.to.port,index:s.to.index}});return u},r.prototype.save=function(t,e){var r;return s.isBrowser()?e(new Error("Saving graphs not supported on browser")):(r=JSON.stringify(this.toJSON(),null,4),n(8).writeFile(t+".json",r,"utf-8",function(n,r){if(n)throw n;return e(t)}))},r}(),e.Graph=r,e.createGraph=function(t,e){return new r(t,e)},e.loadJSON=function(t,e,n){var o,i,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E,x,A,_,O,I,S,D;for(P in null==n&&(n={}),"string"==typeof t&&(t=JSON.parse(t)),t.properties||(t.properties={}),t.processes||(t.processes={}),t.connections||(t.connections=[]),o=t.caseSensitive||!1,(u=new r(t.properties.name,{caseSensitive:o})).startTransaction("loadJSON",n),w={},C=t.properties)D=C[P],"name"!==P&&(w[P]=D);for(d in u.setProperties(w),E=t.processes)(s=E[d]).metadata||(s.metadata={}),u.addNode(d,s.component,s.metadata);for(p=0,f=(x=t.connections).length;p<f;p++)n=(i=x[p]).metadata?i.metadata:{},void 0===i.data?"number"!=typeof i.src.index&&"number"!=typeof i.tgt.index?u.addEdge(i.src.process,u.getPortName(i.src.port),i.tgt.process,u.getPortName(i.tgt.port),n):u.addEdgeIndex(i.src.process,u.getPortName(i.src.port),i.src.index,i.tgt.process,u.getPortName(i.tgt.port),i.tgt.index,n):"number"==typeof i.tgt.index?u.addInitialIndex(i.data,i.tgt.process,u.getPortName(i.tgt.port),i.tgt.index,n):u.addInitial(i.data,i.tgt.process,u.getPortName(i.tgt.port),n);if(t.exports&&t.exports.length)for(l=0,m=(A=t.exports).length;l<m;l++){if((a=A[l]).private){if(2!==(S=a.private.split(".")).length)continue;for(d in b=S[0],y=S[1],t.processes)u.getPortName(d)===u.getPortName(b)&&(b=d)}else b=a.process,y=u.getPortName(a.port);u.addExport(a.public,b,y,a.metadata)}if(t.inports)for(k in _=t.inports)v=_[k],u.addInport(k,v.process,u.getPortName(v.port),v.metadata);if(t.outports)for(k in O=t.outports)v=O[k],u.addOutport(k,v.process,u.getPortName(v.port),v.metadata);if(t.groups)for(h=0,g=(I=t.groups).length;h<g;h++)c=I[h],u.addGroup(c.name,c.nodes,c.metadata||{});return u.endTransaction("loadJSON"),e(null,u)},e.loadFBP=function(t,r,o,i){var s,a;null==o&&(o={}),null==i&&(i=!1);try{s=n(30).parse(t,{caseSensitive:i})}catch(a){return r(a)}return e.loadJSON(s,r,o)},e.loadHTTP=function(t,e){var n;return(n=new XMLHttpRequest).onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?e(new Error("Failed to load "+t+": HTTP "+n.status)):e(null,n.responseText)},n.open("GET",t,!0),n.send()},e.loadFile=function(t,r,o,i){if(null==o&&(o={}),null==i&&(i=!1),!s.isBrowser())return n(8).readFile(t,"utf-8",function(n,o){var s;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(o,r,{},i):(s=JSON.parse(o),e.loadJSON(s,r,{}))});e.loadHTTP(t,function(n,i){var s;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(i,r,o):(s=JSON.parse(i),e.loadJSON(s,r,o))})},a=function(t){var e,n,r,i,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E,x;for(i=0,p=(v=o(t.groups).reverse()).length;i<p;i++)null!=(r=v[i])&&t.removeGroup(r.name);for(y in b=o(t.outports))b[y],t.removeOutport(y);for(y in w=o(t.inports))w[y],t.removeInport(y);for(a=0,d=(P=o(t.exports.reverse())).length;a<d;a++)n=P[a],t.removeExport(n.public);for(t.setProperties({}),u=0,l=(k=o(t.initializers).reverse()).length;u<l;u++)s=k[u],t.removeInitial(s.to.node,s.to.port);for(c=0,h=(C=o(t.edges).reverse()).length;c<h;c++)e=C[c],t.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(x=[],m=0,f=(E=o(t.nodes).reverse()).length;m<f;m++)g=E[m],x.push(t.removeNode(g.id));return x},i=function(t,e){var n,r,o,i,s,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E,x,A,_;for(a(t),i=0,d=(w=e.nodes).length;i<d;i++)y=w[i],t.addNode(y.id,y.component,y.metadata);for(u=0,l=(P=e.edges).length;u<l;u++)n=P[u],t.addEdge(n.from.node,n.from.port,n.to.node,n.to.port,n.metadata);for(c=0,h=(k=e.initializers).length;c<h;c++)s=k[c],t.addInitial(s.from.data,s.to.node,s.to.port,s.metadata);for(p=0,f=(C=e.exports).length;p<f;p++)r=C[p],t.addExport(r.public,r.node,r.port,r.metadata);for(b in t.setProperties(e.properties),E=e.inports)v=E[b],t.addInport(b,v.process,v.port,v.metadata);for(b in x=e.outports)v=x[b],t.addOutport(b,v.process,v.port,v.metadata);for(_=[],g=0,m=(A=e.groups).length;g<m;g++)o=A[g],_.push(t.addGroup(o.name,o.nodes,o.metadata));return _},e.equivalent=function(t,e,n){return null==n&&(n={}),JSON.stringify(t)===JSON.stringify(e)},e.mergeResolveTheirs=i}).call(this)},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],s=n[1],a=new i(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),u=0,p=s>0?r-4:r,d=0;d<p;d+=4)e=o[t.charCodeAt(d)]<<18|o[t.charCodeAt(d+1)]<<12|o[t.charCodeAt(d+2)]<<6|o[t.charCodeAt(d+3)],a[u++]=e>>16&255,a[u++]=e>>8&255,a[u++]=255&e;2===s&&(e=o[t.charCodeAt(d)]<<2|o[t.charCodeAt(d+1)]>>4,a[u++]=255&e);1===s&&(e=o[t.charCodeAt(d)]<<10|o[t.charCodeAt(d+1)]<<4|o[t.charCodeAt(d+2)]>>2,a[u++]=e>>8&255,a[u++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(p(t,s,s+16383>a?a:s+16383));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function p(t,e,n){for(var o,i,s=[],a=e;a<n;a+=3)o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,p=-7,d=n?o-1:0,l=n?-1:1,h=t[e+d];for(d+=l,i=h&(1<<-p)-1,h>>=-p,p+=a;p>0;i=256*i+t[e+d],d+=l,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=r;p>0;s=256*s+t[e+d],d+=l,p-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),i-=c}return(h?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,p=(1<<c)-1,d=p>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+d>=1?l/u:l*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=p?(a=0,s=p):s+d>=1?(a=(e*u-1)*Math.pow(2,o),s+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;t[n+h]=255&a,h+=f,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+h]=255&s,h+=f,s/=256,c-=8);t[n+h-f]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){(function(){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this)}).call(this,n(2))},function(t,e,n){t.exports=function(){"use strict";function t(e,n,r,o){this.message=e,this.expected=n,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),{SyntaxError:t,parse:function(e){var r,o,i=arguments.length>1?arguments[1]:{},s=this,a={},u={start:rn},c=rn,p=function(){return s.getResult()},d="EXPORT=",l={type:"literal",value:"EXPORT=",description:'"EXPORT="'},h=":",f={type:"literal",value:":",description:'":"'},m=function(t,e){return s.registerExports(t,e)},g="INPORT=",y={type:"literal",value:"INPORT=",description:'"INPORT="'},v=".",b={type:"literal",value:".",description:'"."'},w=function(t,e,n){return s.registerInports(t,e,n)},P="OUTPORT=",k={type:"literal",value:"OUTPORT=",description:'"OUTPORT="'},C=function(t,e,n){return s.registerOutports(t,e,n)},E="DEFAULT_INPORT=",x={type:"literal",value:"DEFAULT_INPORT=",description:'"DEFAULT_INPORT="'},A=function(t){Tn=t},_="DEFAULT_OUTPORT=",O={type:"literal",value:"DEFAULT_OUTPORT=",description:'"DEFAULT_OUTPORT="'},I=function(t){Nn=t},S=/^[\n\r\u2028\u2029]/,D={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},T=function(t){return s.registerEdges(t)},N=",",L={type:"literal",value:",",description:'","'},j="#",R={type:"literal",value:"#",description:'"#"'},B="->",G={type:"literal",value:"->",description:'"->"'},F=function(t,e){return[t,e]},M=function(t,e,n){return[{tgt:Mn(e,t)},{src:qn(e,n)}]},q=function(t,e){return{src:qn(t,e)}},U=function(t,e){return{tgt:Mn(e,t)}},z="'",H={type:"literal",value:"'",description:'"\'"'},J=function(t){return{data:t.join("")}},Y=function(t){return{data:t}},W=function(t){return t},K=/^[a-zA-Z_]/,Q={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},X=/^[a-zA-Z0-9_\-]/,V={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},Z=function(t){return Gn(t)},$=function(t,e){return s.addNode(t,e),t},tt=function(t){return s.addAnonymousNode(t,tn(Ke,We).start.offset)},et="(",nt={type:"literal",value:"(",description:'"("'},rt=/^[a-zA-Z\/\-0-9_]/,ot={type:"class",value:"[a-zA-Z/\\-0-9_]",description:"[a-zA-Z/\\-0-9_]"},it=")",st={type:"literal",value:")",description:'")"'},at=function(t,e){var n={};return n.comp=t?t.join(""):"",e&&(n.meta=e.join("").split(",")),n},ut=/^[a-zA-Z\/=_,0-9]/,ct={type:"class",value:"[a-zA-Z/=_,0-9]",description:"[a-zA-Z/=_,0-9]"},pt=function(t){return t},dt=function(t,e){return{port:i.caseSensitive?t:t.toLowerCase(),index:null!=e?e:void 0}},lt=function(t){return t},ht=/^[a-zA-Z.0-9_]/,ft={type:"class",value:"[a-zA-Z.0-9_]",description:"[a-zA-Z.0-9_]"},mt=function(t){return Gn(t)},gt="[",yt={type:"literal",value:"[",description:'"["'},vt=/^[0-9]/,bt={type:"class",value:"[0-9]",description:"[0-9]"},wt="]",Pt={type:"literal",value:"]",description:'"]"'},kt=function(t){return parseInt(t.join(""))},Ct=/^[^\n\r\u2028\u2029]/,Et={type:"class",value:"[^\\n\\r\\u2028\\u2029]",description:"[^\\n\\r\\u2028\\u2029]"},xt=/^[\\]/,At={type:"class",value:"[\\\\]",description:"[\\\\]"},_t=/^[']/,Ot={type:"class",value:"[']",description:"[']"},It=function(){return"'"},St=/^[^']/,Dt={type:"class",value:"[^']",description:"[^']"},Tt=" ",Nt={type:"literal",value:" ",description:'" "'},Lt=function(t){return t},jt="{",Rt={type:"literal",value:"{",description:'"{"'},Bt="}",Gt={type:"literal",value:"}",description:'"}"'},Ft={type:"other",description:"whitespace"},Mt=/^[ \t\n\r]/,qt={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},Ut="false",zt={type:"literal",value:"false",description:'"false"'},Ht=function(){return!1},Jt="null",Yt={type:"literal",value:"null",description:'"null"'},Wt=function(){return null},Kt="true",Qt={type:"literal",value:"true",description:'"true"'},Xt=function(){return!0},Vt=function(t,e){return e},Zt=function(t,e){var n,r={};for(r[t.name]=t.value,n=0;n<e.length;n++)r[e[n].name]=e[n].value;return r},$t=function(t){return null!==t?t:{}},te=function(t,e){return{name:t,value:e}},ee=function(t,e){return e},ne=function(t,e){return[t].concat(e)},re=function(t){return null!==t?t:[]},oe={type:"other",description:"number"},ie=function(){return parseFloat(e.substring(Ke,We))},se=/^[1-9]/,ae={type:"class",value:"[1-9]",description:"[1-9]"},ue=/^[eE]/,ce={type:"class",value:"[eE]",description:"[eE]"},pe="-",de={type:"literal",value:"-",description:'"-"'},le="+",he={type:"literal",value:"+",description:'"+"'},fe="0",me={type:"literal",value:"0",description:'"0"'},ge={type:"other",description:"string"},ye=function(t){return t.join("")},ve='"',be={type:"literal",value:'"',description:'"\\""'},we="\\",Pe={type:"literal",value:"\\",description:'"\\\\"'},ke="/",Ce={type:"literal",value:"/",description:'"/"'},Ee="b",xe={type:"literal",value:"b",description:'"b"'},Ae=function(){return"\b"},_e="f",Oe={type:"literal",value:"f",description:'"f"'},Ie=function(){return"\f"},Se="n",De={type:"literal",value:"n",description:'"n"'},Te=function(){return"\n"},Ne="r",Le={type:"literal",value:"r",description:'"r"'},je=function(){return"\r"},Re="t",Be={type:"literal",value:"t",description:'"t"'},Ge=function(){return"\t"},Fe="u",Me={type:"literal",value:"u",description:'"u"'},qe=function(t){return String.fromCharCode(parseInt(t,16))},Ue=function(t){return t},ze=/^[^\0-\x1F"\\]/,He={type:"class",value:"[^\\0-\\x1F\\x22\\x5C]",description:"[^\\0-\\x1F\\x22\\x5C]"},Je=/^[0-9a-f]/i,Ye={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},We=0,Ke=0,Qe=[{line:1,column:1,seenCR:!1}],Xe=0,Ve=[],Ze=0;if("startRule"in i){if(!(i.startRule in u))throw new Error("Can't start parsing from rule \""+i.startRule+'".');c=u[i.startRule]}function $e(t){var n,r,o=Qe[t];if(o)return o;for(n=t-1;!Qe[n];)n--;for(o={line:(o=Qe[n]).line,column:o.column,seenCR:o.seenCR};n<t;)"\n"===(r=e.charAt(n))?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),n++;return Qe[t]=o,o}function tn(t,e){var n=$e(t),r=$e(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function en(t){We<Xe||(We>Xe&&(Xe=We,Ve=[]),Ve.push(t))}function nn(e,n,r,o){return null!==n&&function(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(n),new t(null!==e?e:function(t,e){var n,r=new Array(t.length);for(n=0;n<t.length;n++)r[n]=t[n].description;return"Expected "+(t.length>1?r.slice(0,-1).join(", ")+" or "+r[t.length-1]:r[0])+" but "+(e?'"'+function(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+e(t)})}(e)+'"':"end of input")+" found."}(n,r),n,r,o)}function rn(){var t,e,n;for(t=We,e=[],n=on();n!==a;)e.push(n),n=on();return e!==a&&(Ke=t,e=p()),t=e}function on(){var t,n,r,o,i,s,u,c,p;return t=We,(n=wn())!==a?(e.substr(We,7)===d?(r=d,We+=7):(r=a,0===Ze&&en(l)),r!==a&&(o=yn())!==a?(58===e.charCodeAt(We)?(i=h,We++):(i=a,0===Ze&&en(f)),i!==a&&(s=yn())!==a&&(u=wn())!==a?((c=sn())===a&&(c=null),c!==a?(Ke=t,t=n=m(o,s)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=wn())!==a?(e.substr(We,7)===g?(r=g,We+=7):(r=a,0===Ze&&en(y)),r!==a&&(o=cn())!==a?(46===e.charCodeAt(We)?(i=v,We++):(i=a,0===Ze&&en(b)),i!==a&&(s=yn())!==a?(58===e.charCodeAt(We)?(u=h,We++):(u=a,0===Ze&&en(f)),u!==a&&(c=yn())!==a&&wn()!==a?((p=sn())===a&&(p=null),p!==a?(Ke=t,t=n=w(o,s,c)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=wn())!==a?(e.substr(We,8)===P?(r=P,We+=8):(r=a,0===Ze&&en(k)),r!==a&&(o=cn())!==a?(46===e.charCodeAt(We)?(i=v,We++):(i=a,0===Ze&&en(b)),i!==a&&(s=yn())!==a?(58===e.charCodeAt(We)?(u=h,We++):(u=a,0===Ze&&en(f)),u!==a&&(c=yn())!==a&&wn()!==a?((p=sn())===a&&(p=null),p!==a?(Ke=t,t=n=C(o,s,c)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=wn())!==a?(e.substr(We,15)===E?(r=E,We+=15):(r=a,0===Ze&&en(x)),r!==a&&(o=yn())!==a&&(i=wn())!==a?((s=sn())===a&&(s=null),s!==a?(Ke=t,t=n=A(o)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=wn())!==a?(e.substr(We,16)===_?(r=_,We+=16):(r=a,0===Ze&&en(O)),r!==a&&(o=yn())!==a&&(i=wn())!==a?((s=sn())===a&&(s=null),s!==a?(Ke=t,t=n=I(o)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=an())!==a?(S.test(e.charAt(We))?(r=e.charAt(We),We++):(r=a,0===Ze&&en(D)),r===a&&(r=null),r!==a?t=n=[n,r]:(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=wn())!==a?(S.test(e.charAt(We))?(r=e.charAt(We),We++):(r=a,0===Ze&&en(D)),r!==a?t=n=[n,r]:(We=t,t=a)):(We=t,t=a),t===a&&(t=We,(n=wn())!==a&&(r=function t(){var n,r,o,i;return n=We,(r=function(){var t;return(t=un())===a&&(t=function(){var t,e,n;return t=We,(e=cn())!==a?((n=gn())===a&&(n=null),n!==a?(Ke=t,e=q(e,n),t=e):(We=t,t=a)):(We=t,t=a),t}())===a&&(t=function(){var t,n,r,o;if(t=We,39===e.charCodeAt(We)?(n=z,We++):(n=a,0===Ze&&en(H)),n!==a){for(r=[],o=bn();o!==a;)r.push(o),o=bn();r!==a?(39===e.charCodeAt(We)?(o=z,We++):(o=a,0===Ze&&en(H)),o!==a?(Ke=t,n=J(r),t=n):(We=t,t=a)):(We=t,t=a)}else We=t,t=a;return t===a&&(t=We,(n=function(){var t,e,n;return t=We,(e=Cn())!==a&&(n=En())!==a&&Cn()!==a?(Ke=t,e=Lt(n),t=e):(We=t,t=a),t}())!==a&&(Ke=t,n=Y(n)),t=n),t}()),t}())!==a&&wn()!==a?(e.substr(We,2)===B?(o=B,We+=2):(o=a,0===Ze&&en(G)),o!==a&&wn()!==a&&(i=t())!==a?(Ke=n,r=F(r,i),n=r):(We=n,n=a)):(We=n,n=a),n===a&&(n=function(){var t;return(t=function(){var t,e,n;return t=We,(e=mn())===a&&(e=null),e!==a&&(n=cn())!==a?(Ke=t,e=U(e,n),t=e):(We=t,t=a),t}())===a&&(t=un()),t}()),n}())!==a&&(o=wn())!==a?((i=sn())===a&&(i=null),i!==a?(Ke=t,t=n=T(r)):(We=t,t=a)):(We=t,t=a)))))))),t}function sn(){var t,n,r,o,i;return t=We,(n=wn())!==a?(44===e.charCodeAt(We)?(r=N,We++):(r=a,0===Ze&&en(L)),r===a&&(r=null),r!==a?((o=an())===a&&(o=null),o!==a?(S.test(e.charAt(We))?(i=e.charAt(We),We++):(i=a,0===Ze&&en(D)),i===a&&(i=null),i!==a?t=n=[n,r,o,i]:(We=t,t=a)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),t}function an(){var t,n,r,o,i;if(t=We,(n=wn())!==a)if(35===e.charCodeAt(We)?(r=j,We++):(r=a,0===Ze&&en(R)),r!==a){for(o=[],i=vn();i!==a;)o.push(i),i=vn();o!==a?t=n=[n,r,o]:(We=t,t=a)}else We=t,t=a;else We=t,t=a;return t}function un(){var t,e,n,r;return t=We,(e=mn())!==a&&(n=cn())!==a&&(r=gn())!==a?(Ke=t,t=e=M(e,n,r)):(We=t,t=a),t===a&&(t=We,(e=mn())===a&&(e=null),e!==a&&(n=function(){var t;return(t=dn())===a&&(t=ln()),t}())!==a?((r=gn())===a&&(r=null),r!==a?(Ke=t,t=e=M(e,n,r)):(We=t,t=a)):(We=t,t=a)),t}function cn(){var t,e;return t=We,(e=dn())!==a&&(Ke=t,e=W(e)),(t=e)===a&&(t=We,(e=pn())!==a&&(Ke=t,e=W(e)),(t=e)===a&&(t=We,(e=ln())!==a&&(Ke=t,e=W(e)),t=e)),t}function pn(){var t,n,r,o,i;if(t=We,n=We,K.test(e.charAt(We))?(r=e.charAt(We),We++):(r=a,0===Ze&&en(Q)),r!==a){for(o=[],X.test(e.charAt(We))?(i=e.charAt(We),We++):(i=a,0===Ze&&en(V));i!==a;)o.push(i),X.test(e.charAt(We))?(i=e.charAt(We),We++):(i=a,0===Ze&&en(V));o!==a?n=r=[r,o]:(We=n,n=a)}else We=n,n=a;return n!==a&&(Ke=t,n=Z(n)),t=n}function dn(){var t,e,n;return t=We,(e=pn())!==a&&(n=hn())!==a?(Ke=t,t=e=$(e,n)):(We=t,t=a),t}function ln(){var t,e;return t=We,(e=hn())!==a&&(Ke=t,e=tt(e)),t=e}function hn(){var t,n,r,o,i;if(t=We,40===e.charCodeAt(We)?(n=et,We++):(n=a,0===Ze&&en(nt)),n!==a){for(r=[],rt.test(e.charAt(We))?(o=e.charAt(We),We++):(o=a,0===Ze&&en(ot));o!==a;)r.push(o),rt.test(e.charAt(We))?(o=e.charAt(We),We++):(o=a,0===Ze&&en(ot));r===a&&(r=null),r!==a?((o=function(){var t,n,r,o;if(t=We,58===e.charCodeAt(We)?(n=h,We++):(n=a,0===Ze&&en(f)),n!==a){if(r=[],ut.test(e.charAt(We))?(o=e.charAt(We),We++):(o=a,0===Ze&&en(ct)),o!==a)for(;o!==a;)r.push(o),ut.test(e.charAt(We))?(o=e.charAt(We),We++):(o=a,0===Ze&&en(ct));else r=a;r!==a?(Ke=t,n=pt(r),t=n):(We=t,t=a)}else We=t,t=a;return t}())===a&&(o=null),o!==a?(41===e.charCodeAt(We)?(i=it,We++):(i=a,0===Ze&&en(st)),i!==a?(Ke=t,t=n=at(r,o)):(We=t,t=a)):(We=t,t=a)):(We=t,t=a)}else We=t,t=a;return t}function fn(){var t,n,r;return t=We,(n=yn())!==a?((r=function(){var t,n,r,o;if(t=We,91===e.charCodeAt(We)?(n=gt,We++):(n=a,0===Ze&&en(yt)),n!==a){if(r=[],vt.test(e.charAt(We))?(o=e.charAt(We),We++):(o=a,0===Ze&&en(bt)),o!==a)for(;o!==a;)r.push(o),vt.test(e.charAt(We))?(o=e.charAt(We),We++):(o=a,0===Ze&&en(bt));else r=a;r!==a?(93===e.charCodeAt(We)?(o=wt,We++):(o=a,0===Ze&&en(Pt)),o!==a?(Ke=t,n=kt(r),t=n):(We=t,t=a)):(We=t,t=a)}else We=t,t=a;return t}())===a&&(r=null),r!==a?(Ke=t,t=n=dt(n,r)):(We=t,t=a)):(We=t,t=a),t}function mn(){var t,e;return t=We,(e=fn())!==a&&Pn()!==a?(Ke=t,t=e=lt(e)):(We=t,t=a),t}function gn(){var t,e;return t=We,Pn()!==a&&(e=fn())!==a?(Ke=t,t=lt(e)):(We=t,t=a),t}function yn(){var t,n,r,o,i;if(t=We,n=We,K.test(e.charAt(We))?(r=e.charAt(We),We++):(r=a,0===Ze&&en(Q)),r!==a){for(o=[],ht.test(e.charAt(We))?(i=e.charAt(We),We++):(i=a,0===Ze&&en(ft));i!==a;)o.push(i),ht.test(e.charAt(We))?(i=e.charAt(We),We++):(i=a,0===Ze&&en(ft));o!==a?n=r=[r,o]:(We=n,n=a)}else We=n,n=a;return n!==a&&(Ke=t,n=mt(n)),t=n}function vn(){var t;return Ct.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(Et)),t}function bn(){var t,n,r;return t=We,xt.test(e.charAt(We))?(n=e.charAt(We),We++):(n=a,0===Ze&&en(At)),n!==a?(_t.test(e.charAt(We))?(r=e.charAt(We),We++):(r=a,0===Ze&&en(Ot)),r!==a?(Ke=t,t=n=It()):(We=t,t=a)):(We=t,t=a),t===a&&(St.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(Dt))),t}function wn(){var t,n;for(t=[],32===e.charCodeAt(We)?(n=Tt,We++):(n=a,0===Ze&&en(Nt));n!==a;)t.push(n),32===e.charCodeAt(We)?(n=Tt,We++):(n=a,0===Ze&&en(Nt));return t===a&&(t=null),t}function Pn(){var t,n;if(t=[],32===e.charCodeAt(We)?(n=Tt,We++):(n=a,0===Ze&&en(Nt)),n!==a)for(;n!==a;)t.push(n),32===e.charCodeAt(We)?(n=Tt,We++):(n=a,0===Ze&&en(Nt));else t=a;return t}function kn(){var t,n,r,o;return t=We,(n=Cn())!==a?(44===e.charCodeAt(We)?(r=N,We++):(r=a,0===Ze&&en(L)),r!==a&&(o=Cn())!==a?t=n=[n,r,o]:(We=t,t=a)):(We=t,t=a),t}function Cn(){var t,n;for(Ze++,t=[],Mt.test(e.charAt(We))?(n=e.charAt(We),We++):(n=a,0===Ze&&en(qt));n!==a;)t.push(n),Mt.test(e.charAt(We))?(n=e.charAt(We),We++):(n=a,0===Ze&&en(qt));return Ze--,t===a&&(n=a,0===Ze&&en(Ft)),t}function En(){var t;return(t=function(){var t,n;return t=We,e.substr(We,5)===Ut?(n=Ut,We+=5):(n=a,0===Ze&&en(zt)),n!==a&&(Ke=t,n=Ht()),t=n}())===a&&(t=function(){var t,n;return t=We,e.substr(We,4)===Jt?(n=Jt,We+=4):(n=a,0===Ze&&en(Yt)),n!==a&&(Ke=t,n=Wt()),t=n}())===a&&(t=function(){var t,n;return t=We,e.substr(We,4)===Kt?(n=Kt,We+=4):(n=a,0===Ze&&en(Qt)),n!==a&&(Ke=t,n=Xt()),t=n}())===a&&(t=function(){var t,n,r,o,i,s,u,c;if(t=We,(n=function(){var t,n,r,o;return t=We,(n=Cn())!==a?(123===e.charCodeAt(We)?(r=jt,We++):(r=a,0===Ze&&en(Rt)),r!==a&&(o=Cn())!==a?t=n=[n,r,o]:(We=t,t=a)):(We=t,t=a),t}())!==a){if(r=We,(o=xn())!==a){for(i=[],s=We,(u=kn())!==a&&(c=xn())!==a?(Ke=s,u=Vt(o,c),s=u):(We=s,s=a);s!==a;)i.push(s),s=We,(u=kn())!==a&&(c=xn())!==a?(Ke=s,u=Vt(o,c),s=u):(We=s,s=a);i!==a?(Ke=r,o=Zt(o,i),r=o):(We=r,r=a)}else We=r,r=a;r===a&&(r=null),r!==a&&(o=function(){var t,n,r,o;return t=We,(n=Cn())!==a?(125===e.charCodeAt(We)?(r=Bt,We++):(r=a,0===Ze&&en(Gt)),r!==a&&(o=Cn())!==a?t=n=[n,r,o]:(We=t,t=a)):(We=t,t=a),t}())!==a?(Ke=t,n=$t(r),t=n):(We=t,t=a)}else We=t,t=a;return t}())===a&&(t=function(){var t,n,r,o,i,s,u,c;if(t=We,(n=function(){var t,n,r,o;return t=We,(n=Cn())!==a?(91===e.charCodeAt(We)?(r=gt,We++):(r=a,0===Ze&&en(yt)),r!==a&&(o=Cn())!==a?t=n=[n,r,o]:(We=t,t=a)):(We=t,t=a),t}())!==a){if(r=We,(o=En())!==a){for(i=[],s=We,(u=kn())!==a&&(c=En())!==a?(Ke=s,u=ee(o,c),s=u):(We=s,s=a);s!==a;)i.push(s),s=We,(u=kn())!==a&&(c=En())!==a?(Ke=s,u=ee(o,c),s=u):(We=s,s=a);i!==a?(Ke=r,o=ne(o,i),r=o):(We=r,r=a)}else We=r,r=a;r===a&&(r=null),r!==a&&(o=function(){var t,n,r,o;return t=We,(n=Cn())!==a?(93===e.charCodeAt(We)?(r=wt,We++):(r=a,0===Ze&&en(Pt)),r!==a&&(o=Cn())!==a?t=n=[n,r,o]:(We=t,t=a)):(We=t,t=a),t}())!==a?(Ke=t,n=re(r),t=n):(We=t,t=a)}else We=t,t=a;return t}())===a&&(t=function(){var t,n,r,o;return Ze++,t=We,(n=An())===a&&(n=null),n!==a&&function(){var t,n,r,o;if((t=function(){var t;return 48===e.charCodeAt(We)?(t=fe,We++):(t=a,0===Ze&&en(me)),t}())===a)if(t=We,(n=function(){var t;return se.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(ae)),t}())!==a){for(r=[],o=Sn();o!==a;)r.push(o),o=Sn();r!==a?t=n=[n,r]:(We=t,t=a)}else We=t,t=a;return t}()!==a?((r=function(){var t,n,r,o;if(t=We,(n=function(){var t;return 46===e.charCodeAt(We)?(t=v,We++):(t=a,0===Ze&&en(b)),t}())!==a){if(r=[],(o=Sn())!==a)for(;o!==a;)r.push(o),o=Sn();else r=a;r!==a?t=n=[n,r]:(We=t,t=a)}else We=t,t=a;return t}())===a&&(r=null),r!==a?((o=function(){var t,n,r,o,i;if(t=We,(n=function(){var t;return ue.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(ce)),t}())!==a)if((r=An())===a&&(r=function(){var t;return 43===e.charCodeAt(We)?(t=le,We++):(t=a,0===Ze&&en(he)),t}()),r===a&&(r=null),r!==a){if(o=[],(i=Sn())!==a)for(;i!==a;)o.push(i),i=Sn();else o=a;o!==a?t=n=[n,r,o]:(We=t,t=a)}else We=t,t=a;else We=t,t=a;return t}())===a&&(o=null),o!==a?(Ke=t,n=ie(),t=n):(We=t,t=a)):(We=t,t=a)):(We=t,t=a),Ze--,t===a&&(n=a,0===Ze&&en(oe)),t}())===a&&(t=_n()),t}function xn(){var t,n,r;return t=We,(n=_n())!==a&&function(){var t,n,r,o;return t=We,(n=Cn())!==a?(58===e.charCodeAt(We)?(r=h,We++):(r=a,0===Ze&&en(f)),r!==a&&(o=Cn())!==a?t=n=[n,r,o]:(We=t,t=a)):(We=t,t=a),t}()!==a&&(r=En())!==a?(Ke=t,t=n=te(n,r)):(We=t,t=a),t}function An(){var t;return 45===e.charCodeAt(We)?(t=pe,We++):(t=a,0===Ze&&en(de)),t}function _n(){var t,e,n;if(Ze++,t=We,In()!==a){for(e=[],n=On();n!==a;)e.push(n),n=On();e!==a&&(n=In())!==a?(Ke=t,t=ye(e)):(We=t,t=a)}else We=t,t=a;return Ze--,t===a&&0===Ze&&en(ge),t}function On(){var t,n,r,o,i,s,u,c,p;return(t=function(){var t;return ze.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(He)),t}())===a&&(t=We,function(){var t;return 92===e.charCodeAt(We)?(t=we,We++):(t=a,0===Ze&&en(Pe)),t}()!==a?(34===e.charCodeAt(We)?(n=ve,We++):(n=a,0===Ze&&en(be)),n===a&&(92===e.charCodeAt(We)?(n=we,We++):(n=a,0===Ze&&en(Pe)),n===a&&(47===e.charCodeAt(We)?(n=ke,We++):(n=a,0===Ze&&en(Ce)),n===a&&(n=We,98===e.charCodeAt(We)?(r=Ee,We++):(r=a,0===Ze&&en(xe)),r!==a&&(Ke=n,r=Ae()),(n=r)===a&&(n=We,102===e.charCodeAt(We)?(r=_e,We++):(r=a,0===Ze&&en(Oe)),r!==a&&(Ke=n,r=Ie()),(n=r)===a&&(n=We,110===e.charCodeAt(We)?(r=Se,We++):(r=a,0===Ze&&en(De)),r!==a&&(Ke=n,r=Te()),(n=r)===a&&(n=We,114===e.charCodeAt(We)?(r=Ne,We++):(r=a,0===Ze&&en(Le)),r!==a&&(Ke=n,r=je()),(n=r)===a&&(n=We,116===e.charCodeAt(We)?(r=Re,We++):(r=a,0===Ze&&en(Be)),r!==a&&(Ke=n,r=Ge()),(n=r)===a&&(n=We,117===e.charCodeAt(We)?(r=Fe,We++):(r=a,0===Ze&&en(Me)),r!==a?(o=We,i=We,(s=Dn())!==a&&(u=Dn())!==a&&(c=Dn())!==a&&(p=Dn())!==a?i=s=[s,u,c,p]:(We=i,i=a),(o=i!==a?e.substring(o,We):i)!==a?(Ke=n,n=r=qe(o)):(We=n,n=a)):(We=n,n=a))))))))),n!==a?(Ke=t,t=Ue(n)):(We=t,t=a)):(We=t,t=a)),t}function In(){var t;return 34===e.charCodeAt(We)?(t=ve,We++):(t=a,0===Ze&&en(be)),t}function Sn(){var t;return vt.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(bt)),t}function Dn(){var t;return Je.test(e.charAt(We))?(t=e.charAt(We),We++):(t=a,0===Ze&&en(Ye)),t}var Tn="IN",Nn="OUT";delete(s=this).exports,delete s.inports,delete s.outports,s.edges=[],o={};var Ln=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};s.serialize=function(t){var e,n,r,o,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E;for(c in null==i&&(i={}),p=[],l="",r=function(t){return null!=a.processes[t].metadata&&(t=a.processes[t].metadata.label),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},n=function(t,e){return null!=e.process&&null!=a.processes[e.process].metadata?t=a.processes[e.process].metadata.label:null!=e.process&&(t=e.process),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},f=(a="string"==typeof t?JSON.parse(t):t).inports)h=n(c,s=f[c]),c=c.toUpperCase(),s.port=s.port.toUpperCase(),l+="INPORT="+h+"."+s.port+":"+c+"\n";for(c in m=a.outports)d=m[c],h=n(c,s),c=c.toUpperCase(),d.port=d.port.toUpperCase(),l+="OUTPORT="+h+"."+d.port+":"+c+"\n";for(l+="\n",o=0,u=(g=a.connections).length;o<u;o++)null!=(e=g[o]).data?(C=e.tgt.port.toUpperCase(),k=e.tgt.process,E=a.processes[k].component,P=r(k),Ln.call(p,E)<0&&(P+="("+E+")",p.push(E)),l+='"'+e.data+'" -> '+C+" "+P+"\n"):(b=e.src.port.toUpperCase(),v=e.src.process,w=a.processes[v].component,y=r(v),Ln.call(p,w)<0&&(y+="("+w+")",p.push(w)),C=e.tgt.port.toUpperCase(),k=e.tgt.process,E=a.processes[k].component,P=r(k),Ln.call(p,E)<0&&(P+="("+E+")",p.push(E)),l+=y+" "+b+" -> "+C+" "+P+"\n");return l},s.addNode=function(t,e){if(o[t]||(o[t]={}),e.comp&&(o[t].component=e.comp),e.meta){for(var n={},r=0;r<e.meta.length;r++){var i=e.meta[r].split("=");1===i.length&&(i=["routes",i[0]]);var s=i[0],a=i[1];"x"!==s&&"y"!==s||(a=parseFloat(a)),n[s]=a}o[t].metadata=n}};var jn={},Rn={};s.addAnonymousNode=function(t,e){if(!Rn[e]){var n=t.comp.replace(/[^a-zA-Z0-9]+/,"_");jn[n]=(jn[n]||0)+1,Rn[e]="_"+n+"_"+jn[n],this.addNode(Rn[e],t)}return Rn[e]},s.getResult=function(){var t={processes:o,connections:s.processEdges(),exports:s.exports,inports:s.inports,outports:s.outports},e=s.validateSchema;if(void 0!==i.validateSchema&&(e=i.validateSchema),e){if(void 0===r)var r=n(!function(){var t=new Error("Cannot find module 'tv4'");throw t.code="MODULE_NOT_FOUND",t}());var a=n(31),u=r.validateMultiple(t,a);if(!u.valid)throw new Error("fbp: Did not validate againt graph schema:\n"+JSON.stringify(u.errors,null,2))}return t.caseSensitive=i.caseSensitive,t};var Bn=function(t,e){for(var n=-1,r=t?t.length:0,o=[];++n<r;){var i=t[n];i instanceof Array?Array.prototype.push.apply(o,e?i:Bn(i)):o.push(i)}return o};function Gn(t){return t[0]+t[1].join("")}function Fn(t,e,n){i.caseSensitive||(n=n.toLowerCase());var r={process:t,port:e?e.port:n};return e&&null!=e.index&&(r.index=e.index),r}function Mn(t,e){return Fn(t,e,Tn)}function qn(t,e){return Fn(t,e,Nn)}if(s.registerExports=function(t,e){s.exports||(s.exports=[]),i.caseSensitive||(t=t.toLowerCase(),e=e.toLowerCase()),s.exports.push({private:t,public:e})},s.registerInports=function(t,e,n){s.inports||(s.inports={}),i.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),s.inports[n]={process:t,port:e}},s.registerOutports=function(t,e,n){s.outports||(s.outports={}),i.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),s.outports[n]={process:t,port:e}},s.registerEdges=function(t){Array.isArray(t)&&t.forEach(function(t,e){s.edges.push(t)})},s.processEdges=function(){var t,e;t=Bn(s.edges),e=[];for(var n=1;n<t.length;n+=1)("src"in t[n-1]||"data"in t[n-1])&&"tgt"in t[n]&&(t[n-1].tgt=t[n].tgt,e.push(t[n-1]),n++);return e},(r=c())!==a&&We===e.length)return r;throw r!==a&&We<e.length&&en({type:"end",description:"end of input"}),nn(null,Ve,Xe<e.length?e.charAt(Xe):null,Xe<e.length?tn(Xe,Xe+1):tn(Xe,Xe))}}}()},function(t){t.exports={$schema:"http://json-schema.org/draft-04/schema",id:"graph.json",title:"FBP graph",description:"A graph of FBP processes and connections between them.\nThis is the primary way of specifying FBP programs.\n",name:"graph",type:"object",additionalProperties:!1,properties:{properties:{type:"object",description:"User-defined properties attached to the graph.",additionalProperties:!0,properties:{name:{type:"string"}}},inports:{type:["object","undefined"],description:"Exported inports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",additionalProperties:!0}}}}},outports:{type:["object","undefined"],description:"Exported outports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",additionalProperties:!0}}}}},exports:{type:["array","undefined"],description:"Deprecated, use inports and outports instead"},groups:{type:"array",description:"List of groups of processes",items:{type:"object",additionalProperties:!1,properties:{name:{type:"string"},nodes:{type:"array",items:{type:"string"}},metadata:{additionalProperties:!0}}}},processes:{type:"object",description:"The processes of this graph.\nEach process is an instance of a component.\n",additionalProperties:!1,patternProperties:{"[a-zA-Z0-9_]+":{type:"object",properties:{component:{type:"string"},metadata:{type:"object",additionalProperties:!0}}}}},connections:{type:"array",description:"Connections of the graph.\nA connection either connects ports of two processes, or specifices an IIP as initial input packet to a port.\n",items:{type:"object",additionalProperties:!1,properties:{src:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},tgt:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},data:{},metadata:{type:"object",additionalProperties:!0}}}}}}},function(t,e,n){(function(){var t,r,o,i,s,a,u,c=function(t,e){for(var n in e)p.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p={}.hasOwnProperty,d=function(t,e){return function(){return t.apply(e,arguments)}};t=n(1).EventEmitter,a=n(13),u=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return e.id+"("+e.component+")";case"removeNode":return"DEL "+e.id+"("+e.component+")";case"renameNode":return"RENAME "+e.oldId+" "+e.newId;case"changeNode":return"META "+e.id;case"addEdge":return e.from.node+" "+e.from.port+" -> "+e.to.port+" "+e.to.node;case"removeEdge":return e.from.node+" "+e.from.port+" -X> "+e.to.port+" "+e.to.node;case"changeEdge":return"META "+e.from.node+" "+e.from.port+" -> "+e.to.port+" "+e.to.node;case"addInitial":return"'"+e.from.data+"' -> "+e.to.port+" "+e.to.node;case"removeInitial":return"'"+e.from.data+"' -X> "+e.to.port+" "+e.to.node;case"startTransaction":return">>> "+t.rev+": "+e.id;case"endTransaction":return"<<< "+t.rev+": "+e.id;case"changeProperties":return"PROPERTIES";case"addGroup":return"GROUP "+e.name;case"renameGroup":return"RENAME GROUP "+e.oldName+" "+e.newName;case"removeGroup":return"DEL GROUP "+e.name;case"changeGroup":return"META GROUP "+e.name;case"addInport":return"INPORT "+e.name;case"removeInport":return"DEL INPORT "+e.name;case"renameInport":return"RENAME INPORT "+e.oldId+" "+e.newId;case"changeInport":return"META INPORT "+e.name;case"addOutport":return"OUTPORT "+e.name;case"removeOutport":return"DEL OUTPORT "+e.name;case"renameOutport":return"RENAME OUTPORT "+e.oldId+" "+e.newId;case"changeOutport":return"META OUTPORT "+e.name;default:throw new Error("Unknown journal entry: "+t.cmd)}},s=function(t,e){var n,r,o;for(n in r={},t)o=t[n],r[n]=null;for(n in e)o=e[n],r[n]=o;return r},o=function(e){function n(t){this.graph=t,this.lastRevision=0}return c(n,t),n.prototype.lastRevision=0,n.prototype.putTransaction=function(t,e){return t>this.lastRevision&&(this.lastRevision=t),this.emit("transaction",t)},n.prototype.fetchTransaction=function(t,e){},n}(),i=function(t){function e(t){e.__super__.constructor.call(this,t),this.transactions=[]}return c(e,o),e.prototype.putTransaction=function(t,n){return e.__super__.putTransaction.call(this,t,n),this.transactions[t]=n},e.prototype.fetchTransaction=function(t){return this.transactions[t]},e}(),r=function(e){function r(t,e,n){var r,o,s,a,u,c,p,l,h,f,m,g,y,v,b,w,P,k,C,E,x;if(this.endTransaction=d(this.endTransaction,this),this.startTransaction=d(this.startTransaction,this),this.graph=t,this.entries=[],this.subscribed=!0,this.store=n||new i(this.graph),0===this.store.transactions.length){for(this.currentRevision=-1,this.startTransaction("initial",e),a=0,p=(v=this.graph.nodes).length;a<p;a++)y=v[a],this.appendCommand("addNode",y);for(c=0,l=(b=this.graph.edges).length;c<l;c++)r=b[c],this.appendCommand("addEdge",r);for(m=0,h=(w=this.graph.initializers).length;m<h;m++)s=w[m],this.appendCommand("addInitial",s);for(u in Object.keys(this.graph.properties).length>0&&this.appendCommand("changeProperties",this.graph.properties,{}),P=this.graph.inports)E=P[u],this.appendCommand("addInport",{name:u,port:E});for(u in k=this.graph.outports)E=k[u],this.appendCommand("addOutport",{name:u,port:E});for(g=0,f=(C=this.graph.groups).length;g<f;g++)o=C[g],this.appendCommand("addGroup",o);this.endTransaction("initial",e)}else this.currentRevision=this.store.lastRevision;this.graph.on("addNode",(x=this,function(t){return x.appendCommand("addNode",t)})),this.graph.on("removeNode",function(t){return function(e){return t.appendCommand("removeNode",e)}}(this)),this.graph.on("renameNode",function(t){return function(e,n){var r;return r={oldId:e,newId:n},t.appendCommand("renameNode",r)}}(this)),this.graph.on("changeNode",function(t){return function(e,n){return t.appendCommand("changeNode",{id:e.id,new:e.metadata,old:n})}}(this)),this.graph.on("addEdge",function(t){return function(e){return t.appendCommand("addEdge",e)}}(this)),this.graph.on("removeEdge",function(t){return function(e){return t.appendCommand("removeEdge",e)}}(this)),this.graph.on("changeEdge",function(t){return function(e,n){return t.appendCommand("changeEdge",{from:e.from,to:e.to,new:e.metadata,old:n})}}(this)),this.graph.on("addInitial",function(t){return function(e){return t.appendCommand("addInitial",e)}}(this)),this.graph.on("removeInitial",function(t){return function(e){return t.appendCommand("removeInitial",e)}}(this)),this.graph.on("changeProperties",function(t){return function(e,n){return t.appendCommand("changeProperties",{new:e,old:n})}}(this)),this.graph.on("addGroup",function(t){return function(e){return t.appendCommand("addGroup",e)}}(this)),this.graph.on("renameGroup",function(t){return function(e,n){return t.appendCommand("renameGroup",{oldName:e,newName:n})}}(this)),this.graph.on("removeGroup",function(t){return function(e){return t.appendCommand("removeGroup",e)}}(this)),this.graph.on("changeGroup",function(t){return function(e,n){return t.appendCommand("changeGroup",{name:e.name,new:e.metadata,old:n})}}(this)),this.graph.on("addExport",function(t){return function(e){return t.appendCommand("addExport",e)}}(this)),this.graph.on("removeExport",function(t){return function(e){return t.appendCommand("removeExport",e)}}(this)),this.graph.on("addInport",function(t){return function(e,n){return t.appendCommand("addInport",{name:e,port:n})}}(this)),this.graph.on("removeInport",function(t){return function(e,n){return t.appendCommand("removeInport",{name:e,port:n})}}(this)),this.graph.on("renameInport",function(t){return function(e,n){return t.appendCommand("renameInport",{oldId:e,newId:n})}}(this)),this.graph.on("changeInport",function(t){return function(e,n,r){return t.appendCommand("changeInport",{name:e,new:n.metadata,old:r})}}(this)),this.graph.on("addOutport",function(t){return function(e,n){return t.appendCommand("addOutport",{name:e,port:n})}}(this)),this.graph.on("removeOutport",function(t){return function(e,n){return t.appendCommand("removeOutport",{name:e,port:n})}}(this)),this.graph.on("renameOutport",function(t){return function(e,n){return t.appendCommand("renameOutport",{oldId:e,newId:n})}}(this)),this.graph.on("changeOutport",function(t){return function(e,n,r){return t.appendCommand("changeOutport",{name:e,new:n.metadata,old:r})}}(this)),this.graph.on("startTransaction",function(t){return function(e,n){return t.startTransaction(e,n)}}(this)),this.graph.on("endTransaction",function(t){return function(e,n){return t.endTransaction(e,n)}}(this))}return c(r,t),r.prototype.graph=null,r.prototype.entries=[],r.prototype.subscribed=!0,r.prototype.startTransaction=function(t,e){if(this.subscribed){if(this.entries.length>0)throw Error("Inconsistent @entries");return this.currentRevision++,this.appendCommand("startTransaction",{id:t,metadata:e},this.currentRevision)}},r.prototype.endTransaction=function(t,e){if(this.subscribed)return this.appendCommand("endTransaction",{id:t,metadata:e},this.currentRevision),this.store.putTransaction(this.currentRevision,this.entries),this.entries=[]},r.prototype.appendCommand=function(t,e,n){var r;if(this.subscribed)return r={cmd:t,args:a(e)},null!=n&&(r.rev=n),this.entries.push(r)},r.prototype.executeEntry=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.addNode(e.id,e.component);case"removeNode":return this.graph.removeNode(e.id);case"renameNode":return this.graph.renameNode(e.oldId,e.newId);case"changeNode":return this.graph.setNodeMetadata(e.id,s(e.old,e.new));case"addEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,s(e.old,e.new));case"addInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"removeInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.new);case"addGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"renameGroup":return this.graph.renameGroup(e.oldName,e.newName);case"removeGroup":return this.graph.removeGroup(e.name);case"changeGroup":return this.graph.setGroupMetadata(e.name,s(e.old,e.new));case"addInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"removeInport":return this.graph.removeInport(e.name);case"renameInport":return this.graph.renameInport(e.oldId,e.newId);case"changeInport":return this.graph.setInportMetadata(e.name,s(e.old,e.new));case"addOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata(e.name));case"removeOutport":return this.graph.removeOutport;case"renameOutport":return this.graph.renameOutport(e.oldId,e.newId);case"changeOutport":return this.graph.setOutportMetadata(e.name,s(e.old,e.new));default:throw new Error("Unknown journal entry: "+t.cmd)}},r.prototype.executeEntryInversed=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.removeNode(e.id);case"removeNode":return this.graph.addNode(e.id,e.component);case"renameNode":return this.graph.renameNode(e.newId,e.oldId);case"changeNode":return this.graph.setNodeMetadata(e.id,s(e.new,e.old));case"addEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,s(e.new,e.old));case"addInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"removeInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.old);case"addGroup":return this.graph.removeGroup(e.name);case"renameGroup":return this.graph.renameGroup(e.newName,e.oldName);case"removeGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"changeGroup":return this.graph.setGroupMetadata(e.name,s(e.new,e.old));case"addInport":return this.graph.removeInport(e.name);case"removeInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameInport":return this.graph.renameInport(e.newId,e.oldId);case"changeInport":return this.graph.setInportMetadata(e.name,s(e.new,e.old));case"addOutport":return this.graph.removeOutport(e.name);case"removeOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameOutport":return this.graph.renameOutport(e.newId,e.oldId);case"changeOutport":return this.graph.setOutportMetadata(e.name,s(e.new,e.old));default:throw new Error("Unknown journal entry: "+t.cmd)}},r.prototype.moveToRevision=function(t){var e,n,r,o,i,s,a,u,c,p,d,l,h;if(t!==this.currentRevision){if(this.subscribed=!1,t>this.currentRevision)for(c=o=p=this.currentRevision+1,d=t;p<=d?o<=d:o>=d;c=p<=d?++o:--o)for(i=0,s=(l=this.store.fetchTransaction(c)).length;i<s;i++)n=l[i],this.executeEntry(n);else for(c=a=this.currentRevision,h=t+1;a>=h;c=a+=-1)for(r=u=(e=this.store.fetchTransaction(c)).length-1;u>=0;r=u+=-1)this.executeEntryInversed(e[r]);return this.currentRevision=t,this.subscribed=!0}},r.prototype.undo=function(){if(this.canUndo())return this.moveToRevision(this.currentRevision-1)},r.prototype.canUndo=function(){return this.currentRevision>0},r.prototype.redo=function(){if(this.canRedo())return this.moveToRevision(this.currentRevision+1)},r.prototype.canRedo=function(){return this.currentRevision<this.store.lastRevision},r.prototype.toPrettyString=function(t,e){var n,r,o,i,s,a,c,p,d;for(a=[],c=o=p=t|=0,d=e|=this.store.lastRevision;p<=d?o<d:o>d;c=p<=d?++o:--o)for(i=0,s=(n=this.store.fetchTransaction(c)).length;i<s;i++)r=n[i],a.push(u(r));return a.join("\n")},r.prototype.toJSON=function(t,e){var n,r,o,i,s,a,c,p;for(n=[],a=o=t|=0,c=e|=this.store.lastRevision;o<c;a=o+=1)for(i=0,s=(p=this.store.fetchTransaction(a)).length;i<s;i++)r=p[i],n.push(u(r));return n},r.prototype.save=function(t,e){var r;return r=JSON.stringify(this.toJSON(),null,4),n(8).writeFile(t+".json",r,"utf-8",function(n,r){if(n)throw n;return e(t)})},r}(),e.Journal=r,e.JournalStore=o,e.MemoryJournalStore=i}).call(this)},function(t,e,n){var r=n(34),o={"browser-app/DoSomething":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n\n  # Define a meaningful icon for component from http://fontawesome.io/icons/\n  c.icon = 'cog'\n\n  # Provide a description on component usage\n  c.description = 'do X'\n\n  # Add input ports\n  c.inPorts.add 'in',\n    datatype: 'string'\n\n  # Add output ports\n  c.outPorts.add 'out',\n    datatype: 'string'\n\n  # What to do when port receives a packet\n  c.process (input, output) ->\n    # Check that input has received data packet\n    return unless input.hasData 'in'\n    # Read the contents of the data packet\n    data = input.getData 'in'\n    # Send the contents to output port\n    output.send\n      out: data\n    # Finish processing\n    output.done()\n"},Graph:{language:"javascript",source:"(function() {\n  var Graph, noflo,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  noflo = require(\"../lib/NoFlo\");\n\n  Graph = (function(superClass) {\n    extend(Graph, superClass);\n\n    function Graph(metadata1) {\n      this.metadata = metadata1;\n      this.network = null;\n      this.ready = true;\n      this.started = false;\n      this.starting = false;\n      this.baseDir = null;\n      this.loader = null;\n      this.load = 0;\n      this.inPorts = new noflo.InPorts({\n        graph: {\n          datatype: 'all',\n          description: 'NoFlo graph definition to be used with the subgraph component',\n          required: true\n        }\n      });\n      this.outPorts = new noflo.OutPorts;\n      this.inPorts.graph.on('ip', (function(_this) {\n        return function(packet) {\n          if (packet.type !== 'data') {\n            return;\n          }\n          return _this.setGraph(packet.data, function(err) {\n            if (err) {\n              return _this.error(err);\n            }\n          });\n        };\n      })(this));\n    }\n\n    Graph.prototype.setGraph = function(graph, callback) {\n      this.ready = false;\n      if (typeof graph === 'object') {\n        if (typeof graph.addNode === 'function') {\n          this.createNetwork(graph, callback);\n          return;\n        }\n        noflo.graph.loadJSON(graph, (function(_this) {\n          return function(err, instance) {\n            if (err) {\n              return callback(err);\n            }\n            instance.baseDir = _this.baseDir;\n            return _this.createNetwork(instance, callback);\n          };\n        })(this));\n        return;\n      }\n      if (graph.substr(0, 1) !== \"/\" && graph.substr(1, 1) !== \":\" && process && process.cwd) {\n        graph = (process.cwd()) + \"/\" + graph;\n      }\n      return noflo.graph.loadFile(graph, (function(_this) {\n        return function(err, instance) {\n          if (err) {\n            return callback(err);\n          }\n          instance.baseDir = _this.baseDir;\n          return _this.createNetwork(instance, callback);\n        };\n      })(this));\n    };\n\n    Graph.prototype.createNetwork = function(graph, callback) {\n      this.description = graph.properties.description || '';\n      this.icon = graph.properties.icon || this.icon;\n      if (!graph.name) {\n        graph.name = this.nodeId;\n      }\n      graph.componentLoader = this.loader;\n      return noflo.createNetwork(graph, (function(_this) {\n        return function(err, network1) {\n          _this.network = network1;\n          if (err) {\n            return callback(err);\n          }\n          _this.emit('network', _this.network);\n          _this.subscribeNetwork(_this.network);\n          return _this.network.connect(function(err) {\n            var name, node, ref;\n            if (err) {\n              return callback(err);\n            }\n            ref = _this.network.processes;\n            for (name in ref) {\n              node = ref[name];\n              _this.findEdgePorts(name, node);\n            }\n            _this.setToReady();\n            return callback();\n          });\n        };\n      })(this), true);\n    };\n\n    Graph.prototype.subscribeNetwork = function(network) {\n      var contexts;\n      contexts = [];\n      this.network.on('start', (function(_this) {\n        return function() {\n          var ctx;\n          ctx = {};\n          contexts.push(ctx);\n          return _this.activate(ctx);\n        };\n      })(this));\n      return this.network.on('end', (function(_this) {\n        return function() {\n          var ctx;\n          ctx = contexts.pop();\n          if (!ctx) {\n            return;\n          }\n          return _this.deactivate(ctx);\n        };\n      })(this));\n    };\n\n    Graph.prototype.isExportedInport = function(port, nodeName, portName) {\n      var exported, i, len, priv, pub, ref, ref1;\n      ref = this.network.graph.inports;\n      for (pub in ref) {\n        priv = ref[pub];\n        if (!(priv.process === nodeName && priv.port === portName)) {\n          continue;\n        }\n        return pub;\n      }\n      ref1 = this.network.graph.exports;\n      for (i = 0, len = ref1.length; i < len; i++) {\n        exported = ref1[i];\n        if (!(exported.process === nodeName && exported.port === portName)) {\n          continue;\n        }\n        this.network.graph.checkTransactionStart();\n        this.network.graph.removeExport(exported[\"public\"]);\n        this.network.graph.addInport(exported[\"public\"], exported.process, exported.port, exported.metadata);\n        this.network.graph.checkTransactionEnd();\n        return exported[\"public\"];\n      }\n      return false;\n    };\n\n    Graph.prototype.isExportedOutport = function(port, nodeName, portName) {\n      var exported, i, len, priv, pub, ref, ref1;\n      ref = this.network.graph.outports;\n      for (pub in ref) {\n        priv = ref[pub];\n        if (!(priv.process === nodeName && priv.port === portName)) {\n          continue;\n        }\n        return pub;\n      }\n      ref1 = this.network.graph.exports;\n      for (i = 0, len = ref1.length; i < len; i++) {\n        exported = ref1[i];\n        if (!(exported.process === nodeName && exported.port === portName)) {\n          continue;\n        }\n        this.network.graph.checkTransactionStart();\n        this.network.graph.removeExport(exported[\"public\"]);\n        this.network.graph.addOutport(exported[\"public\"], exported.process, exported.port, exported.metadata);\n        this.network.graph.checkTransactionEnd();\n        return exported[\"public\"];\n      }\n      return false;\n    };\n\n    Graph.prototype.setToReady = function() {\n      if (typeof process !== 'undefined' && process.execPath && process.execPath.indexOf('node') !== -1) {\n        return process.nextTick((function(_this) {\n          return function() {\n            _this.ready = true;\n            return _this.emit('ready');\n          };\n        })(this));\n      } else {\n        return setTimeout((function(_this) {\n          return function() {\n            _this.ready = true;\n            return _this.emit('ready');\n          };\n        })(this), 0);\n      }\n    };\n\n    Graph.prototype.findEdgePorts = function(name, process) {\n      var inPorts, outPorts, port, portName, targetPortName;\n      inPorts = process.component.inPorts.ports || process.component.inPorts;\n      outPorts = process.component.outPorts.ports || process.component.outPorts;\n      for (portName in inPorts) {\n        port = inPorts[portName];\n        targetPortName = this.isExportedInport(port, name, portName);\n        if (targetPortName === false) {\n          continue;\n        }\n        this.inPorts.add(targetPortName, port);\n        this.inPorts[targetPortName].once('connect', (function(_this) {\n          return function() {\n            if (_this.starting) {\n              return;\n            }\n            if (_this.isStarted()) {\n              return;\n            }\n            return _this.start(function() {});\n          };\n        })(this));\n      }\n      for (portName in outPorts) {\n        port = outPorts[portName];\n        targetPortName = this.isExportedOutport(port, name, portName);\n        if (targetPortName === false) {\n          continue;\n        }\n        this.outPorts.add(targetPortName, port);\n      }\n      return true;\n    };\n\n    Graph.prototype.isReady = function() {\n      return this.ready;\n    };\n\n    Graph.prototype.isSubgraph = function() {\n      return true;\n    };\n\n    Graph.prototype.setUp = function(callback) {\n      this.starting = true;\n      if (!this.isReady()) {\n        this.once('ready', (function(_this) {\n          return function() {\n            return _this.setUp(callback);\n          };\n        })(this));\n        return;\n      }\n      if (!this.network) {\n        return callback(null);\n      }\n      return this.network.start(function(err) {\n        if (err) {\n          return callback(err);\n        }\n        this.starting = false;\n        return callback();\n      });\n    };\n\n    Graph.prototype.tearDown = function(callback) {\n      this.starting = false;\n      if (!this.network) {\n        return callback(null);\n      }\n      return this.network.stop(function(err) {\n        if (err) {\n          return callback(err);\n        }\n        return callback();\n      });\n    };\n\n    return Graph;\n\n  })(noflo.Component);\n\n  exports.getComponent = function(metadata) {\n    return new Graph(metadata);\n  };\n\n}).call(this);\n"},"core/Callback":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component calls a given callback function for each\n  IP it receives.  The Callback component is typically used to connect\n  NoFlo with external Node.js code.'\n  c.icon = 'sign-out'\n\n  c.inPorts.add 'in',\n    description: 'Object passed as argument of the callback'\n    datatype: 'all'\n  c.inPorts.add 'callback',\n    description: 'Callback to invoke'\n    datatype: 'function'\n    control: true\n    required: true\n  c.outPorts.add 'error',\n    datatype: 'object'\n\n  c.process (input, output) ->\n    return unless input.hasData 'callback', 'in'\n    [callback, data] = input.getData 'callback', 'in'\n    unless typeof callback is 'function'\n      output.done new Error 'The provided callback must be a function'\n      return\n\n    # Call the callback when receiving data\n    try\n      callback data\n    catch e\n      return output.done e\n    output.done()\n"},"core/Copy":{language:"coffeescript",source:"noflo = require 'noflo'\nowl = require 'owl-deepcopy'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'deep (i.e. recursively) copy an object'\n  c.icon = 'copy'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be copied'\n  c.outPorts.add 'out',\n    datatype: 'all'\n    description: 'Copy of the original packet'\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    data = input.getData 'in'\n\n    copy = owl.deepCopy data\n    output.sendDone\n      out: copy\n    return\n"},"core/DisconnectAfterPacket":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Makes each data packet a stream of its own'\n  c.icon = 'pause'\n  c.forwardBrackets = {}\n  c.autoOrdering = false\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forward with disconnection'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  brackets = {}\n  c.tearDown = (callback) ->\n    brackets = {}\n  c.process (input, output) ->\n    # Force auto-ordering to be off for this one\n    c.autoOrdering = false\n\n    data = input.get 'in'\n    brackets[input.scope] = [] unless brackets[input.scope]\n    if data.type is 'openBracket'\n      brackets[input.scope].push data.data\n      output.done()\n      return\n    if data.type is 'closeBracket'\n      brackets[input.scope].pop()\n      output.done()\n      return\n\n    return unless data.type is 'data'\n\n    for bracket in brackets[input.scope]\n      output.sendIP 'out', new noflo.IP 'openBracket', bracket\n    output.sendIP 'out', data\n    closes = brackets[input.scope].slice 0\n    closes.reverse()\n    for bracket in closes\n      output.sendIP 'out', new noflo.IP 'closeBracket', bracket\n\n    output.done()\n"},"core/Drop":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component drops every packet it receives with no\n  action'\n  c.icon = 'trash-o'\n\n  c.inPorts.add 'in',\n    datatypes: 'all'\n    description: 'Packet to be dropped'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    data.drop()\n    output.done()\n    return\n"},"core/Kick":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component generates a single packet and sends it to\n  the output port. Mostly usable for debugging, but can also be useful\n  for starting up networks.'\n  c.icon = 'share'\n\n  c.inPorts.add 'in',\n    datatype: 'bang'\n    description: 'Signal to send the data packet'\n  c.inPorts.add 'data',\n    datatype: 'all'\n    description: 'Packet to be sent'\n    control: true\n    default: null\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    return unless input.hasStream 'in'\n    return if input.attached('data').length and not input.hasData 'data'\n    bang = input.getData 'in'\n    data = input.getData 'data'\n    output.send\n      out: data\n    output.done()\n"},"core/MakeFunction":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Evaluates a function each time data hits the \"in\" port\n  and sends the return value to \"out\". Within the function \"x\" will\n  be the variable from the in port. For example, to make a ^2 function\n  input \"return x*x;\" to the function port.'\n  c.icon = 'code'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be processed'\n  c.inPorts.add 'function',\n    datatype: 'string'\n    description: 'Function to evaluate'\n    control: true\n  c.outPorts.add 'out',\n    datatype: 'all'\n  c.outPorts.add 'function',\n    datatype: 'function'\n  c.outPorts.add 'error',\n    datatype: 'object'\n\n  prepareFunction = (func, callback) ->\n    if typeof func is 'function'\n      callback null, func\n      return\n    try\n      newFunc = Function 'x', func\n    catch e\n      callback e\n      return\n    callback null, newFunc\n\n  c.process (input, output) ->\n    return if input.attached('in').length and not input.hasData 'in'\n    if input.hasData 'function', 'in'\n      # Both function and input data\n      prepareFunction input.getData('function'), (err, func) ->\n        if err\n          output.done e\n          return\n        data = input.getData 'in'\n        try\n          result = func data\n        catch e\n          output.done e\n          return\n        output.sendDone\n          function: func\n          out: result\n        return\n      return\n    return unless input.hasData 'function'\n    prepareFunction input.getData('function'), (err, func) ->\n      if err\n        output.done e\n        return\n      output.sendDone\n        function: func\n      return\n    return\n"},"core/Merge":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component receives data on multiple input ports and\n    sends the same data out to the connected output port'\n  c.icon = 'compress'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"core/Output":{language:"coffeescript",source:"noflo = require 'noflo'\n\nunless noflo.isBrowser()\n  util = require 'util'\nelse\n  util =\n    inspect: (data) -> data\n\nlog = (options, data) ->\n  if options?\n    console.log util.inspect data,\n      options.showHidden, options.depth, options.colors\n  else\n    console.log data\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends the data items to console.log'\n  c.icon = 'bug'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be printed through console.log'\n  c.inPorts.add 'options',\n    datatype: 'object'\n    description: 'Options to be passed to console.log'\n    control: true\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    return if input.attached('options').length and not input.hasData 'options'\n\n    options = null\n    if input.has 'options'\n      options = input.getData 'options'\n\n    data = input.getData 'in'\n    log options, data\n    output.sendDone\n      out: data\n"},"core/ReadGlobal":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Returns the value of a global variable.'\n  c.icon = 'usd'\n\n  # inPorts\n  c.inPorts.add 'name',\n    description: 'The name of the global variable.'\n\n  # outPorts\n  c.outPorts.add 'value',\n    description: 'The value of the variable.'\n\n  c.outPorts.add 'error',\n    description: 'Any errors that occured reading the variables value.'\n\n  c.forwardBrackets =\n    name: ['value', 'error']\n\n  c.process (input, output) ->\n    return unless input.hasData 'name'\n    data = input.getData 'name'\n\n    value = unless noflo.isBrowser() then global[data] else window[data]\n\n    if typeof value is 'undefined'\n      err = new Error \"\\\"#{data}\\\" is undefined on the global object.\"\n      output.sendDone err\n      return\n    output.sendDone\n      value: value\n"},"core/Repeat":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Forwards packets and metadata in the same way\n  it receives them'\n  c.icon = 'forward'\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to forward'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"core/RepeatAsync":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Like 'Repeat', except repeat on next tick\"\n  c.icon = 'step-forward'\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to forward'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    setTimeout ->\n      output.sendDone\n        out: data\n    , 0\n"},"core/RepeatDelayed":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Forward packet after a set delay'\n  c.icon = 'clock-o'\n\n  c.timers = []\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded with a delay'\n  c.inPorts.add 'delay',\n    datatype: 'number'\n    description: 'How much to delay'\n    default: 500\n    control: true\n\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.tearDown = (callback) ->\n    clearTimeout timer for timer in c.timers\n    c.timers = []\n    callback()\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    return if input.attached('delay').length and not input.hasData 'delay'\n\n    delay = 500\n    if input.hasData 'delay'\n      delay = input.getData 'delay'\n    payload = input.get 'in'\n\n    timer = setTimeout ->\n      c.timers.splice c.timers.indexOf(timer), 1\n      output.sendDone\n        out: payload\n    , delay\n    c.timers.push timer\n"},"core/RunInterval":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Send a packet at the given interval'\n  c.icon = 'clock-o'\n  c.inPorts.add 'interval',\n    datatype: 'number'\n    description: 'Interval at which output packets are emitted (ms)'\n    required: true\n    control: true\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start the emission'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop the emission'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.timers = {}\n\n  cleanUp = (scope) ->\n    return unless c.timers[scope]\n    clearInterval c.timers[scope].interval\n    c.timers[scope].deactivate()\n    c.timers[scope] = null\n\n  c.tearDown = (callback) ->\n    for scope, context of c.timers\n      cleanUp scope\n    c.timers = {}\n    callback()\n\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      return unless input.hasData 'interval'\n      start = input.get 'start'\n      return unless start.type is 'data'\n      interval = parseInt input.getData 'interval'\n      # Ensure we deactivate previous interval in this scope, if any\n      cleanUp start.scope\n\n      # Set up interval\n      context.interval = setInterval ->\n        bang = new noflo.IP 'data', true\n        bang.scope = start.scope\n        c.outPorts.out.sendIP bang\n      , interval\n\n      # Register scope, we keep it active until stopped\n      c.timers[start.scope] = context\n      return\n\n    if input.hasData 'stop'\n      stop = input.get 'stop'\n      return unless stop.type is 'data'\n      # Deactivate interval in this scope\n      cleanUp stop.scope\n      return\n"},"core/RunTimeout":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Send a packet after the given time in ms'\n  c.icon = 'clock-o'\n\n  c.timer = {}\n\n  c.inPorts.add 'time',\n    datatype: 'number'\n    description: 'Time after which a packet will be sent'\n    required: true\n    control: true\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start the timeout before sending a packet'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.forwardBrackets =\n    start: ['out']\n\n  c.stopTimer = (scope) ->\n    return unless c.timer[scope]\n    clearTimeout c.timer[scope].timeout\n    c.timer[scope].deactivate()\n    delete c.timer[scope]\n\n  c.tearDown = (callback) ->\n    for scope, timer of c.timer\n      c.stopTimer scope\n    callback()\n\n  c.process (input, output, context) ->\n    return unless input.hasData 'time', 'start'\n    time = input.getData 'time'\n    bang = input.getData 'start'\n    # Ensure we deactivate previous timeout, if any\n    c.stopTimer input.scope\n    # Set up new timer\n    context.timeout = setTimeout ->\n      c.timer = null\n      output.sendDone\n        out: true\n    , time\n    c.timer[input.scope] = context\n    return\n"},"core/SendNext":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends next packet in buffer when receiving a bang'\n  c.icon = 'forward'\n\n  c.inPorts.add 'data',\n    datatype: 'all'\n  c.inPorts.add 'in',\n    datatype: 'bang'\n  c.outPorts.add 'out',\n    datatype: 'all'\n  c.outPorts.add 'empty',\n    datatype: 'bang'\n    required: false\n\n  c.forwardBrackets = {}\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    bang = input.getData 'in'\n\n    unless input.hasData 'data'\n      # No data packets in the buffer, send \"empty\"\n      output.sendDone\n        empty: true\n      return\n\n    sent = false\n    # Loop until we've either drained the buffer completely, or until\n    # we hit the next data packet\n    while input.has 'data'\n      if sent\n        # If we already sent data, we look ahead to see if next packet is data and bail out\n        buf = c.inPorts.data.getBuffer bang.scope\n        break if buf[0].type is 'data'\n\n      packet = input.get 'data'\n      output.send\n        out: packet\n      sent = true if packet.type is 'data'\n    # After the loop we can deactivate\n    output.done()\n"},"core/Split":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'expand'\n  c.description = 'This component receives data on a single input port and\n    sends the same data out to all connected output ports'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded'\n\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"dom/AddClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass AddClass extends noflo.Component\n  description: 'Add a class to an element'\n  constructor: ->\n    @element = null\n    @class = null\n    @inPorts =\n      element: new noflo.Port 'object'\n      class: new noflo.Port 'string'\n    @outPorts = {}\n\n    @inPorts.element.on 'data', (data) =>\n      @element = data\n      do @addClass if @class\n    @inPorts.class.on 'data', (data) =>\n      @class = data\n      do @addClass if @element\n\n  addClass: ->\n    @element.classList.add @class\n\nexports.getComponent = -> new AddClass\n"},"dom/AppendChild":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass AppendChild extends noflo.Component\n  description: 'Append elements as children of a parent element'\n  constructor: ->\n    @parent = null\n    @children = []\n    @inPorts =\n      parent: new noflo.Port 'object'\n      child: new noflo.Port 'object'\n    @outPorts = {}\n\n    @inPorts.parent.on 'data', (data) =>\n      @parent = data\n      do @append if @children.length\n\n    @inPorts.child.on 'data', (data) =>\n      unless @parent\n        @children.push data\n        return\n      @parent.appendChild data\n\n  append: ->\n    for child in @children\n      @parent.appendChild child\n    @children = []\n\nexports.getComponent = -> new AppendChild\n"},"dom/CreateElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass CreateElement extends noflo.Component\n  description: 'Create a new DOM Element'\n  constructor: ->\n    @tagName = null\n    @container = null\n    @inPorts =\n      tagname: new noflo.Port 'string'\n      container: new noflo.Port 'object'\n    @outPorts =\n      element: new noflo.Port 'object'\n\n    @inPorts.tagname.on 'data', (@tagName) =>\n      do @createElement\n    @inPorts.tagname.on 'disconnect', =>\n      unless @inPorts.container.isAttached()\n        @outPorts.element.disconnect()\n    @inPorts.container.on 'data', (@container) =>\n      do @createElement\n    @inPorts.container.on 'disconnect', =>\n      @outPorts.element.disconnect()\n\n  createElement: ->\n    return unless @tagName\n    if @inPorts.container.isAttached()\n      return unless @container\n    el = document.createElement @tagName\n    if @container\n      @container.appendChild el\n    @outPorts.element.send el\n\nexports.getComponent = -> new CreateElement\n"},"dom/CreateFragment":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass CreateFragment extends noflo.Component\n  description: 'Create a new DOM DocumentFragment'\n  constructor: ->\n    @inPorts =\n      in: new noflo.Port 'bang'\n    @outPorts =\n      fragment: new noflo.Port 'object'\n\n    @inPorts.in.on 'data', =>\n      @outPorts.fragment.send document.createDocumentFragment()\n    @inPorts.in.on 'disconnect', =>\n      @outPorts.fragment.disconnect()\n\nexports.getComponent = -> new CreateFragment\n"},"dom/GetAttribute":{language:"coffeescript",source:"'use strict'\n\nnoflo = require 'noflo'\n\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Reads the given attribute from the DOM element on the in\n    port.\"\n\n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element from which to read the attribute from.'\n    required: true\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is read from the DOM element.'\n    required: true\n\n  # Define out ports.\n  c.outPorts.add 'out',\n    datatype: 'string'\n    description: 'Value of the attribute being read.'\n\n  # On data flow.\n  noflo.helpers.WirePattern c,\n    in: ['element']\n    out: ['out']\n    params: ['attribute']\n    forwardGroups: true\n  ,\n    (data, groups, out) ->\n      attr = c.params.attribute\n      value = data.getAttribute attr\n\n      out.send value\n"},"dom/GetElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass GetElement extends noflo.Component\n  description: 'Get a DOM element matching a query'\n  constructor: ->\n    @container = null\n\n    @inPorts =\n      in: new noflo.Port 'object'\n      selector: new noflo.Port 'string'\n    @outPorts =\n      element: new noflo.Port 'object'\n      error: new noflo.Port 'object'\n\n    @inPorts.in.on 'data', (data) =>\n      unless typeof data.querySelector is 'function'\n        @error 'Given container doesn\\'t support querySelectors'\n        return\n      @container = data\n\n    @inPorts.selector.on 'data', (data) =>\n      @select data\n\n  select: (selector) ->\n    if @container\n      el = @container.querySelectorAll selector\n    else\n      el = document.querySelectorAll selector\n    unless el.length\n      @error \"No element matching '#{selector}' found\"\n      return\n    @outPorts.element.send element for element in el\n    @outPorts.element.disconnect()\n\n  error: (msg) ->\n    if @outPorts.error.isAttached()\n      @outPorts.error.send new Error msg\n      @outPorts.error.disconnect()\n      return\n    throw new Error msg\n\nexports.getComponent = -> new GetElement\n"},"dom/HasClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass HasClass extends noflo.Component\n  description: 'Check if an element has a given class'\n  constructor: ->\n    @element = null\n    @class = null\n    @inPorts =\n      element: new noflo.Port 'object'\n      class: new noflo.Port 'string'\n    @outPorts =\n      element: new noflo.Port 'object'\n      missed: new noflo.Port 'object'\n\n    @inPorts.element.on 'data', (data) =>\n      @element = data\n      do @checkClass if @class\n    @inPorts.element.on 'disconnect', =>\n      @outPorts.element.disconnect()\n      return unless @outPorts.missed.isAttached()\n      @outPorts.missed.disconnect()\n    @inPorts.class.on 'data', (data) =>\n      @class = data\n      do @checkClass if @element\n\n  checkClass: ->\n    if @element.classList.contains @class\n      @outPorts.element.send @element\n      return\n    return unless @outPorts.missed.isAttached()\n    @outPorts.missed.send @element\n\nexports.getComponent = -> new HasClass\n"},"dom/Listen":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass Listen extends noflo.Component\n  description: 'addEventListener for specified event type'\n  icon: 'stethoscope'\n\n  constructor: ->\n    @element = null\n    @type = null\n    @preventDefault = false\n\n    @inPorts =\n      element: new noflo.Port 'object'\n      type: new noflo.Port 'string'\n      preventdefault: new noflo.Port 'boolean'\n    @outPorts =\n      element: new noflo.Port 'object'\n      event: new noflo.Port 'object'\n\n    @inPorts.element.on 'data', (data) =>\n      if @element and @type\n        @unsubscribe @element, @type\n\n      @element = data\n\n      if @type\n        @subscribe @element, @type\n\n    @inPorts.type.on 'data', (data) =>\n      if @element and @type\n        @unsubscribe @element, @type\n\n      @type = data\n\n      if @element\n        @subscribe @element, @type\n\n    @inPorts.preventdefault.on 'data', (data) =>\n      @preventDefault = data\n\n  unsubscribe: (element, type) ->\n    element.removeEventListener type, @change\n\n  subscribe: (element, type) ->\n    element.addEventListener type, @change\n\n  change: (event) =>\n    if @preventDefault\n      event.preventDefault()\n    if @outPorts.element.isAttached()\n      @outPorts.element.send @element\n    if @outPorts.event.isAttached()\n      @outPorts.event.send event\n\nexports.getComponent = -> new Listen\n"},"dom/ReadHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass ReadHtml extends noflo.Component\n  description: 'Read HTML from an existing element'\n  constructor: ->\n    @inPorts =\n      container: new noflo.Port 'object'\n    @outPorts =\n      html: new noflo.Port 'string'\n\n    @inPorts.container.on 'data', (data) =>\n      @outPorts.html.send data.innerHTML\n      @outPorts.html.disconnect()\n\nexports.getComponent = -> new ReadHtml\n"},"dom/RemoveClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass RemoveClass extends noflo.Component\n  description: 'Remove a class from an element'\n  constructor: ->\n    @element = null\n    @class = null\n    @inPorts =\n      element: new noflo.Port 'object'\n      class: new noflo.Port 'string'\n    @outPorts = {}\n\n    @inPorts.element.on 'data', (data) =>\n      @element = data\n      do @removeClass if @class\n    @inPorts.class.on 'data', (data) =>\n      @class = data\n      do @removeClass if @element\n\n  removeClass: ->\n    @element.classList.remove @class\n\nexports.getComponent = -> new RemoveClass\n"},"dom/RemoveElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass RemoveElement extends noflo.Component\n  description: 'Remove an element from DOM'\n  constructor: ->\n    @inPorts =\n      element: new noflo.Port 'object'\n    @inPorts.element.on 'data', (element) ->\n      return unless element.parentNode\n      element.parentNode.removeChild element\n\nexports.getComponent = -> new RemoveElement\n"},"dom/RequestAnimationFrame":{language:"coffeescript",source:"noflo = require 'noflo'\n\nrequestAnimationFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  (callback, element) ->\n    window.setTimeout( ->\n      callback(+new Date())\n    , 1000 / 60)\n\nclass RequestAnimationFrame extends noflo.Component\n  description: 'Sends bangs that correspond with screen refresh rate.'\n  icon: 'film'\n\n  constructor: ->\n    @running = false\n\n    @inPorts =\n      start: new noflo.Port 'bang'\n      stop: new noflo.Port 'bang'\n    @outPorts =\n      out: new noflo.Port 'bang'\n\n    @inPorts.start.on 'data', (data) =>\n      @running = true\n      @animate()\n\n    @inPorts.stop.on 'data', (data) =>\n      @running = false\n\n  animate: ->\n    if @running\n      requestAnimationFrame @animate.bind(@)\n      @outPorts.out.send true\n\n  shutdown: ->\n    @running = false\n\nexports.getComponent = -> new RequestAnimationFrame\n"},"dom/SetAttribute":{language:"coffeescript",source:"'use strict'\n\nnoflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Set the given attribute on the DOM element to the received\n    value.\"\n    \n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element on which to set the attribute.'\n    required: true\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is set on the DOM element.'\n    required: true\n\n  c.inPorts.add 'value',\n    datatype: 'string'\n    description: 'Value of the attribute being set.'\n  \n  # Define out ports.\n  c.outPorts.add 'element',\n    datatype: 'object'\n    description: 'The element that was updated.'\n\n  # On data flow.\n  noflo.helpers.WirePattern c,\n    in: ['element', 'value']\n    out: ['element']\n    params: ['attribute']\n    forwardGroups: true\n  ,\n    (data, groups, out) ->\n      attr = c.params.attribute\n      value = data.value\n      if typeof value is 'object'\n        if toString.call(value) is '[object Array]'\n          value = value.join ' '\n        else\n          newVal = []\n          newVal.push val for key, val of value\n          value = newVal.join ' '\n      if attr == \"value\"\n        data.element.value = value\n      else\n        data.element.setAttribute attr, value\n\n      out.send data.element\n  \n"},"dom/WriteHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\nclass WriteHtml extends noflo.Component\n  description: 'Write HTML inside an existing element'\n  constructor: ->\n    @container = null\n    @html = null\n\n    @inPorts =\n      html: new noflo.Port 'string'\n      container: new noflo.Port 'object'\n    @outPorts =\n      container: new noflo.Port 'object'\n\n    @inPorts.html.on 'data', (data) =>\n      @html = data\n      do @writeHtml if @container\n    @inPorts.container.on 'data', (data) =>\n      @container = data\n      do @writeHtml unless @html is null\n\n  writeHtml: ->\n    @container.innerHTML = @html\n    @html = null\n\n    if @outPorts.container.isAttached()\n      @outPorts.container.send @container\n      @outPorts.container.disconnect()\n\nexports.getComponent = -> new WriteHtml\n"},"interaction/Focus":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass Focus extends noflo.Component\n  description: 'focus element'\n  element: null\n  constructor: ->\n    super\n\n    @inPorts.add 'element',\n      datatype: 'all'\n      description: 'element to be focused'\n    , (event, payload) =>\n      if event is 'data'\n        @element = payload\n\n    @inPorts.add 'trigger',\n      datatype: 'bang'\n      description: 'trigger focus'\n    , (event, payload) =>\n      if event is 'data'\n        window.setTimeout =>\n          @element.focus()\n          @outPorts.out.send payload\n        , 0\n\n    @outPorts.add 'out'\n\nexports.getComponent = -> new Focus\n\n"},"interaction/ListenChange":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenChange extends noflo.Component\n  description: 'Listen to mouse events on a DOM element'\n  constructor: ->\n    @elements = []\n    @inPorts =\n      element: new noflo.Port 'object'\n    @outPorts =\n      value: new noflo.ArrayPort 'all'\n\n    @inPorts.element.on 'data', (element) =>\n      @subscribe element\n\n  subscribe: (element) ->\n    element.addEventListener 'change', @change, false\n    @elements.push element\n\n  unsubscribe: ->\n    for element in @elements\n      element.removeEventListener 'change', @change, false\n    @elements = []\n\n  change: (event) =>\n    return unless @outPorts.value.sockets.length\n    event.preventDefault()\n    event.stopPropagation()\n\n    @outPorts.value.send event.target.value\n    @outPorts.value.disconnect()\n\n  shutdown: ->\n    @unsubscribe()\n\nexports.getComponent = -> new ListenChange\n"},"interaction/ListenDrag":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenDrag extends noflo.Component\n  description: 'Listen to drag events on a DOM element'\n  icon: 'arrows'\n  constructor: ->\n    @inPorts =\n      element: new noflo.Port 'object'\n    @outPorts =\n      start: new noflo.ArrayPort 'object'\n      movex: new noflo.ArrayPort 'number'\n      movey: new noflo.ArrayPort 'number'\n      end: new noflo.ArrayPort 'object'\n\n    @inPorts.element.on 'data', (element) =>\n      @subscribe element\n\n  subscribe: (element) ->\n    element.addEventListener 'dragstart', @dragstart, false\n    element.addEventListener 'drag', @dragmove, false\n    element.addEventListener 'dragend', @dragend, false\n\n  dragstart: (event) =>\n    event.preventDefault()\n    event.stopPropagation()\n\n    @outPorts.start.send event\n    @outPorts.start.disconnect()\n\n  dragmove: (event) =>\n    event.preventDefault()\n    event.stopPropagation()\n    @outPorts.movex.send event.clientX\n    @outPorts.movey.send event.clientY\n\n  dragend: (event) =>\n    event.preventDefault()\n    event.stopPropagation()\n\n    @outPorts.movex.disconnect() if @outPorts.movex.isConnected()\n    @outPorts.movey.disconnect() if @outPorts.movey.isConnected()\n\n    @outPorts.end.send event\n    @outPorts.end.disconnect()\n\nexports.getComponent = -> new ListenDrag\n"},"interaction/ListenHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenHash extends noflo.Component\n  description: 'Listen for hash changes in browser\\'s URL bar'\n  icon: 'slack'\n  constructor: ->\n    @current = null\n    @inPorts = new noflo.InPorts\n      start:\n        datatype: 'bang'\n        description: 'Start listening for hash changes'\n      stop:\n        datatype: 'bang'\n        description: 'Stop listening for hash changes'\n    @outPorts = new noflo.OutPorts\n      initial:\n        datatype: 'string'\n        required: false\n      change:\n        datatype: 'string'\n        required: false\n\n    @inPorts.start.on 'data', =>\n      @subscribe()\n\n    @inPorts.stop.on 'data', =>\n      @unsubscribe()\n\n  subscribe: ->\n    @current = @getHash()\n    window.addEventListener 'hashchange', @hashChange, false\n    @outPorts.initial.send @current\n    @outPorts.initial.disconnect()\n\n  unsubscribe: ->\n    window.removeEventListener 'hashchange', @hashChange, false\n    @outPorts.change.disconnect()\n\n  hashChange: (event) =>\n    oldHash = @current\n    @current = @getHash()\n    @outPorts.change.beginGroup oldHash if oldHash\n    @outPorts.change.send @current\n    @outPorts.change.endGroup oldHash if oldHash\n\n  getHash: ->\n    window.location.href.split('#')[1] or ''\n\n  shutdown: ->\n    @unsubscribe()\n\nexports.getComponent = -> new ListenHash\n"},"interaction/ListenKeyboard":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenKeyboard extends noflo.Component\n  description: 'Listen for key presses on a given DOM element'\n  icon: 'keyboard-o'\n  constructor: ->\n    @elements = []\n    @inPorts =\n      element: new noflo.Port 'object'\n      stop: new noflo.Port 'object'\n    @outPorts =\n      keypress: new noflo.Port 'int'\n\n    @inPorts.element.on 'data', (element) =>\n      @subscribe element\n\n    @inPorts.stop.on 'data', (element) =>\n      @unsubscribe element\n\n  subscribe: (element) ->\n    element.addEventListener 'keypress', @keypress, false\n    @elements.push element\n\n  unsubscribe: (element) ->\n    if -1 is @elements.indexOf element\n      return\n    element.removeEventListener 'keypress', @keypress, false\n    @elements.splice @elements.indexOf(element), 1\n\n  keypress: (event) =>\n    return unless @outPorts.keypress.isAttached()\n\n    @outPorts.keypress.send event.keyCode\n    @outPorts.keypress.disconnect()\n\n  shutdown: ->\n    for element in @elements\n      @unsubscribe element\n\nexports.getComponent = -> new ListenKeyboard\n"},"interaction/ListenKeyboardShortcuts":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenKeyboardShortcuts extends noflo.Component\n  description: 'Listen for keyboard shortcuts and route them'\n  icon: 'keyboard-o'\n  constructor: ->\n    @keys = []\n    @ignoreInput = true\n    @inPorts =\n      keys: new noflo.Port 'string'\n      ignoreinput: new noflo.Port 'boolean'\n      stop: new noflo.Port 'bang'\n    @outPorts =\n      shortcut: new noflo.ArrayPort 'bang'\n      missed: new noflo.Port 'int'\n\n    @inPorts.keys.on 'data', (data) =>\n      @keys = @normalizeKeys data\n      do @subscribe\n\n    @inPorts.ignoreinput.on 'data', (data) =>\n      @ignoreInput = String(data) is 'true'\n\n    @inPorts.stop.on 'data', =>\n      do @unsubscribe\n\n  subscribe: ->\n    document.addEventListener 'keydown', @keypress, false\n\n  unsubscribe: ->\n    document.removeEventListener 'keydown', @keypress, false\n\n  normalizeKeys: (data) ->\n    keys = data.split ','\n    \n    # We allow some common keyboard shortcuts to be passed as strings\n    for key, index in keys\n      switch key\n        when '-' then keys[index] = 189\n        when '=' then keys[index] = 187\n        when '0' then keys[index] = 48\n        when 'a' then keys[index] = 65\n        when 'x' then keys[index] = 88\n        when 'c' then keys[index] = 67\n        when 'v' then keys[index] = 86\n        when 'z' then keys[index] = 90\n        when 'r' then keys[index] = 82\n        when 's' then keys[index] = 83\n    keys\n\n  validateTarget: (event) ->\n    return true unless @ignoreInput\n    return false if event.target.tagName is 'TEXTAREA'\n    return false if event.target.tagName is 'INPUT'\n    return false if String(event.target.contentEditable) is 'true'\n    true\n\n  keypress: (event) =>\n    return unless event.ctrlKey or event.metaKey\n    return unless @validateTarget event\n\n    route = @keys.indexOf event.keyCode\n    if route is -1\n      if @outPorts.missed.isAttached()\n        @outPorts.missed.send event.keyCode\n        @outPorts.missed.disconnect()\n      return\n\n    event.preventDefault()\n    event.stopPropagation()\n    @outPorts.shortcut.send event.keyCode, route\n    @outPorts.shortcut.disconnect()\n\n  shutdown: ->\n    do @unsubscribe\n\nexports.getComponent = -> new ListenKeyboardShortcuts\n"},"interaction/ListenMouse":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenMouse extends noflo.Component\n  description: 'Listen to mouse events on a DOM element'\n  constructor: ->\n    @elements = []\n    @inPorts =\n      element: new noflo.Port 'object'\n    @outPorts =\n      click: new noflo.ArrayPort 'object'\n      dblclick: new noflo.ArrayPort 'object'\n\n    @inPorts.element.on 'data', (element) =>\n      @subscribe element\n\n  subscribe: (element) ->\n    element.addEventListener 'click', @click, false\n    element.addEventListener 'dblclick', @dblclick, false\n    @elements.push element\n\n  unsubscribe: ->\n    for element in @elements\n      element.removeEventListener 'click', @click, false\n      element.removeEventListener 'dblclick', @dblclick, false\n    @elements = []\n\n  click: (event) =>\n    return unless @outPorts.click.sockets.length\n    event.preventDefault()\n    event.stopPropagation()\n\n    @outPorts.click.send event\n    @outPorts.click.disconnect()\n    do @updateIcon\n\n  dblclick: (event) =>\n    return unless @outPorts.dblclick.sockets.length\n    event.preventDefault()\n    event.stopPropagation()\n\n    @outPorts.dblclick.send event\n    @outPorts.dblclick.disconnect()\n    do @updateIcon\n\n  updateIcon: ->\n    return unless @setIcon\n    return if @timeout\n    @originalIcon = @getIcon()\n    @setIcon 'exclamation-circle'\n    @timeout = setTimeout =>\n      @setIcon @originalIcon\n      @timeout = null\n    , 200\n\n  shutdown: ->\n    @unsubscribe()\n\nexports.getComponent = -> new ListenMouse\n"},"interaction/ListenPointer":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenPointer extends noflo.Component\n  description: 'Listen to pointer events on a DOM element'\n  constructor: ->\n    @action = 'none'\n    @capture = false\n    @propagate = false\n    @elements = []\n\n    @inPorts =\n      element: new noflo.Port 'object'\n      action: new noflo.Port 'string'\n      capture: new noflo.Port 'boolean'\n      propagate: new noflo.Port 'boolean'\n    @outPorts =\n      down: new noflo.Port 'object'\n      up: new noflo.Port 'object'\n      cancel: new noflo.Port 'object'\n      move: new noflo.Port 'object'\n      over: new noflo.Port 'object'\n      out: new noflo.Port 'object'\n      enter: new noflo.Port 'object'\n      leave: new noflo.Port 'object'\n\n    @inPorts.element.on 'data', (element) =>\n      @subscribe element\n\n    @inPorts.action.on 'data', (@action) =>\n    @inPorts.capture.on 'data', (@capture) =>\n    @inPorts.propagate.on 'data', (@propagate) =>\n\n  subscribe: (element) ->\n    if element.setAttribute\n      element.setAttribute 'touch-action', @action\n\n    element.addEventListener 'pointerdown', @pointerDown, @capture\n    element.addEventListener 'pointerup', @pointerUp, @capture\n    element.addEventListener 'pointercancel', @pointerCancel, @capture\n    element.addEventListener 'pointermove', @pointerMove, @capture\n    element.addEventListener 'pointerover', @pointerOver, @capture\n    element.addEventListener 'pointerout', @pointerOut, @capture\n    element.addEventListener 'pointerenter', @pointerEnter, @capture\n    element.addEventListener 'pointerleave', @pointerLeave, @capture\n    @elements.push element\n\n  unsubscribe: (element) ->\n    if element.removeAttribute\n      element.removeAttribute 'touch-action'\n\n    element.removeEventListener 'pointerdown', @pointerDown, @capture\n    element.removeEventListener 'pointerup', @pointerUp, @capture\n    element.removeEventListener 'pointercancel', @pointerCancel, @capture\n    element.removeEventListener 'pointermove', @pointerMove, @capture\n    element.removeEventListener 'pointerover', @pointerOver, @capture\n    element.removeEventListener 'pointerout', @pointerOut, @capture\n    element.removeEventListener 'pointerenter', @pointerEnter, @capture\n    element.removeEventListener 'pointerleave', @pointerLeave, @capture\n\n    for name, port of @outPorts\n      continue unless port.isAttached()\n      port.disconnect()\n\n  shutdown: ->\n    @unsubscribe element for element in @elements\n    @elements = []\n\n  pointerDown: (event) =>\n    @handle event, 'down'\n  pointerUp: (event) =>\n    @handle event, 'up'\n  pointerCancel: (event) =>\n    @handle event, 'cancel'\n  pointerMove: (event) =>\n    @handle event, 'move'\n  pointerOver: (event) =>\n    @handle event, 'over'\n  pointerOut: (event) =>\n    @handle event, 'out'\n  pointerEnter: (event) =>\n    @handle event, 'enter'\n  pointerLeave: (event) =>\n    @handle event, 'leave'\n\n  handle: (event, type) ->\n    event.preventDefault()\n    event.stopPropagation() unless @propagate\n\n    unless @outPorts[type].isAttached()\n      return\n    @outPorts[type].beginGroup event.pointerId\n    @outPorts[type].send event\n    @outPorts[type].endGroup()\n\n    # End of interaction, send EOTs\n    if type is 'up' or type is 'cancel' or type is 'leave'\n      for name, port of @outPorts\n        continue unless port.isAttached()\n        port.disconnect()\n\nexports.getComponent = -> new ListenPointer\n"},"interaction/ListenResize":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenResize extends noflo.Component\n  description: 'Listen to window resize events'\n  icon: 'desktop'\n\n  constructor: ->\n    @inPorts =\n      start: new noflo.Port 'bang'\n      stop: new noflo.Port 'bang'\n    @outPorts =\n      width: new noflo.Port 'number'\n      height: new noflo.Port 'number'\n\n    @inPorts.start.on 'data', =>\n      @sendSize()\n      @subscribe()\n\n    @inPorts.stop.on 'data', =>\n      @unsubscribe()\n\n  subscribe: ->\n    window.addEventListener 'resize', @sendSize, false\n  unsubscribe: ->\n    window.removeEventListener 'resize', @sendSize, false\n\n  sendSize: =>\n    if @outPorts.width.isAttached()\n      @outPorts.width.send window.innerWidth\n      @outPorts.width.disconnect()\n    if @outPorts.height.isAttached()\n      @outPorts.height.send window.innerHeight\n      @outPorts.height.disconnect()\n\n  shutdown: ->\n    @unsubscribe()\n\nexports.getComponent = -> new ListenResize\n"},"interaction/ListenScroll":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenScroll extends noflo.Component\n  description: 'Listen to scroll events on the browser window'\n  icon: 'arrows-v'\n  constructor: ->\n    @inPorts =\n      start: new noflo.Port 'bang'\n      stop: new noflo.Port 'bang'\n    @outPorts =\n      top: new noflo.Port 'number'\n      bottom: new noflo.Port 'number'\n      left: new noflo.Port 'number'\n      right: new noflo.Port 'number'\n\n    @inPorts.start.on 'data', =>\n      @subscribe()\n\n    @inPorts.stop.on 'data', =>\n      @unsubscribe()\n\n  subscribe: ->\n    window.addEventListener 'scroll', @scroll, false\n\n  unsubscribe: ->\n    window.removeEventListener 'scroll', @scroll, false\n\n  scroll: (event) =>\n    top = window.scrollY\n    left = window.scrollX\n    if @outPorts.top.isAttached()\n      @outPorts.top.send top\n      @outPorts.top.disconnect()\n    if @outPorts.bottom.isAttached()\n      bottom = top + window.innerHeight\n      @outPorts.bottom.send bottom\n      @outPorts.bottom.disconnect()\n    if @outPorts.left.isAttached()\n      @outPorts.left.send left\n      @outPorts.left.disconnect()\n    if @outPorts.right.isAttached()\n      right = left + window.innerWidth\n      @outPorts.right.send right\n      @outPorts.right.disconnect()\n\n  shutdown: ->\n    @unsubscribe()\n\nexports.getComponent = -> new ListenScroll\n"},"interaction/ListenSpeech":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenSpeech extends noflo.Component\n  description: 'Listen for user\\'s microphone and recognize phrases'\n  icon: 'microphone'\n  constructor: ->\n    @recognition = false\n    @sent = []\n    @inPorts =\n      start: new noflo.Port 'bang'\n      stop: new noflo.Port 'bang'\n    @outPorts =\n      result: new noflo.Port 'string'\n      error: new noflo.Port 'object'\n\n    @inPorts.start.on 'data', =>\n      @startListening()\n    @inPorts.stop.on 'data', =>\n      @stopListening()\n\n  startListening: ->\n    unless window.webkitSpeechRecognition\n      @handleError new Error 'Speech recognition support not available'\n    @recognition = new window.webkitSpeechRecognition\n    @recognition.continuous = true\n    @recognition.start()\n    @outPorts.result.connect()\n    @recognition.onresult = @handleResult\n    @recognition.onerror = @handleError\n\n  handleResult: (event) =>\n    for result, idx in event.results\n      continue unless result.isFinal\n      if @sent.indexOf(idx) isnt -1\n        continue\n      @outPorts.result.send result[0].transcript\n      @sent.push idx\n\n  handleError: (error) =>\n    if @outPorts.error.isAttached()\n      @outPorts.error.send error\n      @outPorts.error.disconnect()\n      return\n    throw error\n\n  stopListening: ->\n    return unless @recognition\n    @outPorts.result.disconnect()\n    @recognition.stop()\n    @recognition = null\n    @sent = []\n\n  shutdown: ->\n    @stopListening()\n\nexports.getComponent = -> new ListenSpeech\n"},"interaction/ListenTouch":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ListenTouch extends noflo.Component\n  description: 'Listen to touch events on a DOM element'\n  icon: 'hand-o-up'\n  constructor: ->\n    @elements = []\n    @inPorts =\n      element: new noflo.Port 'object'\n    @outPorts =\n      start: new noflo.ArrayPort 'object'\n      movex: new noflo.ArrayPort 'number'\n      movey: new noflo.ArrayPort 'number'\n      end: new noflo.ArrayPort 'object'\n\n    @inPorts.element.on 'data', (element) =>\n      @subscribe element\n\n  subscribe: (element) ->\n    element.addEventListener 'touchstart', @touchstart, false\n    element.addEventListener 'touchmove', @touchmove, false\n    element.addEventListener 'touchend', @touchend, false\n    @elements.push element\n\n  unsubscribe: ->\n    for element in @elements\n      element.removeEventListener 'touchstart', @touchstart, false\n      element.removeEventListener 'touchmove', @touchmove, false\n      element.removeEventListener 'touchend', @touchend, false\n    @elements = []\n\n  touchstart: (event) =>\n    event.preventDefault()\n    event.stopPropagation()\n\n    return unless event.changedTouches\n    return unless event.changedTouches.length\n\n    for touch, idx in event.changedTouches\n      @outPorts.start.beginGroup idx\n      @outPorts.start.send event\n      @outPorts.start.endGroup()\n\n    @outPorts.start.disconnect()\n\n  touchmove: (event) =>\n    event.preventDefault()\n    event.stopPropagation()\n\n    return unless event.changedTouches\n    return unless event.changedTouches.length\n\n    for touch, idx in event.changedTouches\n      @outPorts.movex.beginGroup idx\n      @outPorts.movex.send touch.pageX\n      @outPorts.movex.endGroup()\n      @outPorts.movey.beginGroup idx\n      @outPorts.movey.send touch.pageY\n      @outPorts.movey.endGroup()\n\n  touchend: (event) =>\n    event.preventDefault()\n    event.stopPropagation()\n\n    return unless event.changedTouches\n    return unless event.changedTouches.length\n\n    @outPorts.movex.disconnect() if @outPorts.movex.isConnected()\n    @outPorts.movey.disconnect() if @outPorts.movey.isConnected()\n\n    for touch, idx in event.changedTouches\n      @outPorts.end.beginGroup idx\n      @outPorts.end.send event\n      @outPorts.end.endGroup()\n\n    @outPorts.end.disconnect()\n\n  shutdown: ->\n    @unsubscribe()\n\nexports.getComponent = -> new ListenTouch\n"},"interaction/ReadCoordinates":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ReadCoordinates extends noflo.Component\n  description: 'Read the coordinates from a DOM event'\n  constructor: ->\n    @inPorts =\n      event: new noflo.Port 'object'\n    @outPorts =\n      screen: new noflo.Port 'object'\n      client: new noflo.Port 'object'\n      page: new noflo.Port 'object'\n\n    @inPorts.event.on 'begingroup', (group) =>\n      @outPorts.screen.beginGroup group if @outPorts.screen.isAttached()\n      @outPorts.client.beginGroup group if @outPorts.client.isAttached()\n      @outPorts.page.beginGroup group if @outPorts.page.isAttached()\n    @inPorts.event.on 'data', (data) =>\n      @read data\n    @inPorts.event.on 'endgroup', =>\n      @outPorts.screen.endGroup() if @outPorts.screen.isAttached()\n      @outPorts.client.endGroup() if @outPorts.client.isAttached()\n      @outPorts.page.endGroup() if @outPorts.page.isAttached()\n    @inPorts.event.on 'disconnect', =>\n      @outPorts.screen.disconnect() if @outPorts.screen.isAttached()\n      @outPorts.client.disconnect() if @outPorts.client.isAttached()\n      @outPorts.page.disconnect() if @outPorts.page.isAttached()\n\n  read: (event) ->\n    return unless event\n    if @outPorts.screen.isAttached() and event.screenX isnt undefined\n      @outPorts.screen.send\n        x: event.screenX\n        y: event.screenY\n    if @outPorts.client.isAttached() and event.clientX isnt undefined\n      @outPorts.client.send\n        x: event.clientX\n        y: event.clientY\n    if @outPorts.page.isAttached() and event.pageX isnt undefined\n      @outPorts.page.send\n        x: event.pageX\n        y: event.pageY\n\nexports.getComponent = -> new ReadCoordinates\n"},"interaction/ReadGamepad":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass ReadGamepad extends noflo.Component\n  description: 'Read the state of a gamepad'\n  icon: 'gamepad'\n  constructor: ->\n    @lastTimestamp\n    @inPorts =\n      gamepad: new noflo.Port 'int'\n    @outPorts =\n      out: new noflo.Port 'object'\n      error: new noflo.Port 'string'\n\n    @inPorts.gamepad.on 'data', (number) =>\n      @readGamepad number\n\n  readGamepad: (number) ->\n    if !navigator.webkitGetGamepads\n      msg = \"no webkit gamepad api available\"\n      if @outPorts.error.isAttached()\n        @outPorts.error.send msg\n        @outPorts.error.disconnect()\n        return\n      else\n        throw new Error msg\n\n    gamepadState = navigator.webkitGetGamepads()[number]\n    if !gamepadState\n      msg = \"state for gamepad '#{number}' could not been read\"\n      if @outPorts.error.isAttached()\n        @outPorts.error.send msg\n        @outPorts.error.disconnect()\n        return\n      else\n        throw new Error msg\n\n    if @lastTimestamp != gamepadState.timestamp\n      @lastTimestamp = gamepadState.timestamp\n      @outPorts.out.send gamepadState\n\nexports.getComponent = -> new ReadGamepad\n"},"interaction/SetHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nclass SetHash extends noflo.Component\n  description: 'Set the hash in browser\\'s URL bar'\n  icon: 'slack'\n  constructor: ->\n    @inPorts =\n      hash: new noflo.ArrayPort 'string'\n    @outPorts =\n      out: new noflo.Port 'string'\n\n    @inPorts.hash.on 'data', (data) =>\n      window.location.hash = \"##{data}\"\n      @outPorts.out.send data if @outPorts.out.isAttached()\n\n    @inPorts.hash.on 'disconnect', =>\n      @outPorts.out.disconnect() if @outPorts.out.isAttached()\n\nexports.getComponent = -> new SetHash\n"}};e.setSource=function(t,e,n,i,s,a){r.setSource(o,t,e,n,i,s,a)},e.getSource=function(t,e,n){r.getSource(o,t,e,n)},e.register=function(t,e){t.setLibraryIcon("dom","html5"),t.registerComponent("browser-app","DoSomething",n(35)),t.registerComponent("browser-app","main",n(36)),t.registerComponent(null,"Graph",n(37)),t.registerComponent("core","Callback",n(38)),t.registerComponent("core","Copy",n(39)),t.registerComponent("core","DisconnectAfterPacket",n(41)),t.registerComponent("core","Drop",n(42)),t.registerComponent("core","Kick",n(43)),t.registerComponent("core","MakeFunction",n(44)),t.registerComponent("core","Merge",n(45)),t.registerComponent("core","Output",n(46)),t.registerComponent("core","ReadGlobal",n(50)),t.registerComponent("core","Repeat",n(51)),t.registerComponent("core","RepeatAsync",n(52)),t.registerComponent("core","RepeatDelayed",n(53)),t.registerComponent("core","RunInterval",n(54)),t.registerComponent("core","RunTimeout",n(55)),t.registerComponent("core","SendNext",n(56)),t.registerComponent("core","Split",n(57)),t.registerComponent("dom","AddClass",n(58)),t.registerComponent("dom","AppendChild",n(59)),t.registerComponent("dom","CreateElement",n(60)),t.registerComponent("dom","CreateFragment",n(61)),t.registerComponent("dom","GetAttribute",n(62)),t.registerComponent("dom","GetElement",n(63)),t.registerComponent("dom","HasClass",n(64)),t.registerComponent("dom","Listen",n(65)),t.registerComponent("dom","ReadHtml",n(66)),t.registerComponent("dom","RemoveClass",n(67)),t.registerComponent("dom","RemoveElement",n(68)),t.registerComponent("dom","RequestAnimationFrame",n(69)),t.registerComponent("dom","SetAttribute",n(70)),t.registerComponent("dom","WriteHtml",n(71)),t.registerComponent("interaction","Focus",n(72)),t.registerComponent("interaction","ListenChange",n(73)),t.registerComponent("interaction","ListenDrag",n(74)),t.registerComponent("interaction","ListenHash",n(75)),t.registerComponent("interaction","ListenKeyboard",n(76)),t.registerComponent("interaction","ListenKeyboardShortcuts",n(77)),t.registerComponent("interaction","ListenMouse",n(78)),t.registerComponent("interaction","ListenPointer",n(79)),t.registerComponent("interaction","ListenResize",n(80)),t.registerComponent("interaction","ListenScroll",n(81)),t.registerComponent("interaction","ListenSpeech",n(82)),t.registerComponent("interaction","ListenTouch",n(83)),t.registerComponent("interaction","ReadCoordinates",n(84)),t.registerComponent("interaction","ReadGamepad",n(85)),t.registerComponent("interaction","SetHash",n(86));r.registerCustomLoaders(t,[],e)}},function(module,exports){exports.registerCustomLoaders=function(t,e,n){if(!e.length)return n();var r=e.shift();t.registerLoader(r,function(r){if(r)return n(r);exports.registerCustomLoaders(t,e,n)})},exports.setSource=function(sources,loader,packageId,name,source,language,callback){var implementation,originalSource=source;if("coffeescript"===language){if("undefined"!=typeof window&&!window.CoffeeScript)return callback(new Error("CoffeeScript compiler needed for "+packageId+"/"+name+" not available"));try{source=window.CoffeeScript.compile(source,{bare:!0})}catch(t){return callback(t)}}if(("es6"===language||"es2015"===language)&&"undefined"!=typeof window&&window.babel)try{source=window.babel.transform(source).code}catch(t){return callback(t)}try{var withExports="(function () { var exports = {}; "+source+"; return exports; })();";implementation=eval(withExports)}catch(t){return callback(t)}if("function"!=typeof implementation&&(!implementation.getComponent||"function"!=typeof implementation.getComponent))return callback(new Error("Provided source for "+packageId+"/"+name+" failed to create a runnable component"));var fullName=packageId+"/"+name;sources[fullName]={language:language,source:originalSource},loader.registerComponent(packageId,name,implementation,callback)},exports.getSource=function(t,e,n,r){if(!e.components[n])return r(new Error("Component "+n+" not available"));var o=e.components[n];if(-1!==n.indexOf("/"))var i=n.split("/"),s={name:i[1],library:i[0]};else s={name:n,library:""};return e.isGraph(o)?(s.code=JSON.stringify(o,null,2),s.language="json",r(null,s)):t[n]?(s.code=t[n].source,s.language=t[n].language,r(null,s)):"function"==typeof o?(s.code=o.toString(),s.language="javascript",r(null,s)):"function"==typeof o.getComponent?(s.code=o.getComponent.toString(),s.language="javascript",r(null,s)):r(new Error("Unable to get sources for "+n))}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="cog",t.description="do X",t.inPorts.add("in",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process(function(t,e){var n;if(t.hasData("in"))return n=t.getData("in"),e.send({out:n}),e.done()})}},function(t){t.exports={caseSensitive:!1,properties:{name:"main",environment:{type:"noflo-browser",content:"<button id='button'>Go!</button>\n<p id='message'></p>"},icon:""},inports:{},outports:{},groups:[],processes:{"dom/GetElement_7amk2":{component:"dom/GetElement",metadata:{label:"dom/GetElement",x:216,y:144,width:72,height:72}},"core/Output_cg49":{component:"core/Output",metadata:{label:"core/Output",x:432,y:360,width:72,height:72}},"dom/WriteHtml_fpz6j":{component:"dom/WriteHtml",metadata:{label:"dom/WriteHtml",x:684,y:288,width:72,height:72}},"dom/GetElement_xvz54":{component:"dom/GetElement",metadata:{label:"dom/GetElement",x:252,y:288,width:72,height:72}},"interaction/ListenMouse_1l373":{component:"interaction/ListenMouse",metadata:{label:"interaction/ListenMouse",x:396,y:144,width:72,height:72}},"core/Kick_ey1nh":{component:"core/Kick",metadata:{label:"core/Kick",x:576,y:180,width:72,height:72}}},connections:[{src:{process:"dom/GetElement_xvz54",port:"element"},tgt:{process:"dom/WriteHtml_fpz6j",port:"container"}},{src:{process:"dom/GetElement_7amk2",port:"element"},tgt:{process:"interaction/ListenMouse_1l373",port:"element"},metadata:{route:0}},{src:{process:"dom/GetElement_7amk2",port:"error"},tgt:{process:"core/Output_cg49",port:"in"},metadata:{route:1}},{src:{process:"dom/GetElement_xvz54",port:"error"},tgt:{process:"core/Output_cg49",port:"in"},metadata:{route:1}},{src:{process:"interaction/ListenMouse_1l373",port:"click"},tgt:{process:"core/Kick_ey1nh",port:"in"}},{src:{process:"core/Kick_ey1nh",port:"out"},tgt:{process:"dom/WriteHtml_fpz6j",port:"html"}},{data:"#button",tgt:{process:"dom/GetElement_7amk2",port:"selector"}},{data:"#message",tgt:{process:"dom/GetElement_xvz54",port:"selector"}},{data:"Hallo Menno!",tgt:{process:"core/Kick_ey1nh",port:"data"}}]}},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var o,i,s={}.hasOwnProperty;i=n(0),o=function(e){function n(t){var e;this.metadata=t,this.network=null,this.ready=!0,this.started=!1,this.starting=!1,this.baseDir=null,this.loader=null,this.load=0,this.inPorts=new i.InPorts({graph:{datatype:"all",description:"NoFlo graph definition to be used with the subgraph component",required:!0}}),this.outPorts=new i.OutPorts,this.inPorts.graph.on("ip",(e=this,function(t){if("data"===t.type)return e.setGraph(t.data,function(t){if(t)return e.error(t)})}))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,i.Component),n.prototype.setGraph=function(e,n){return this.ready=!1,"object"===r(e)?"function"==typeof e.addNode?void this.createNetwork(e,n):void i.graph.loadJSON(e,(o=this,function(t,e){return t?n(t):(e.baseDir=o.baseDir,o.createNetwork(e,n))})):("/"!==e.substr(0,1)&&":"!==e.substr(1,1)&&t&&t.cwd&&(e=t.cwd()+"/"+e),i.graph.loadFile(e,function(t){return function(e,r){return e?n(e):(r.baseDir=t.baseDir,t.createNetwork(r,n))}}(this)));var o},n.prototype.createNetwork=function(t,e){return this.description=t.properties.description||"",this.icon=t.properties.icon||this.icon,t.name||(t.name=this.nodeId),t.componentLoader=this.loader,i.createNetwork(t,(n=this,function(t,r){return n.network=r,t?e(t):(n.emit("network",n.network),n.subscribeNetwork(n.network),n.network.connect(function(t){var r,o,i;if(t)return e(t);for(r in i=n.network.processes)o=i[r],n.findEdgePorts(r,o);return n.setToReady(),e()}))}),!0);var n},n.prototype.subscribeNetwork=function(t){var e,n;return e=[],this.network.on("start",(n=this,function(){var t;return t={},e.push(t),n.activate(t)})),this.network.on("end",function(t){return function(){var n;if(n=e.pop())return t.deactivate(n)}}(this))},n.prototype.isExportedInport=function(t,e,n){var r,o,i,s,a,u,c;for(a in u=this.network.graph.inports)if((s=u[a]).process===e&&s.port===n)return a;for(o=0,i=(c=this.network.graph.exports).length;o<i;o++)if((r=c[o]).process===e&&r.port===n)return this.network.graph.checkTransactionStart(),this.network.graph.removeExport(r.public),this.network.graph.addInport(r.public,r.process,r.port,r.metadata),this.network.graph.checkTransactionEnd(),r.public;return!1},n.prototype.isExportedOutport=function(t,e,n){var r,o,i,s,a,u,c;for(a in u=this.network.graph.outports)if((s=u[a]).process===e&&s.port===n)return a;for(o=0,i=(c=this.network.graph.exports).length;o<i;o++)if((r=c[o]).process===e&&r.port===n)return this.network.graph.checkTransactionStart(),this.network.graph.removeExport(r.public),this.network.graph.addOutport(r.public,r.process,r.port,r.metadata),this.network.graph.checkTransactionEnd(),r.public;return!1},n.prototype.setToReady=function(){return void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick((e=this,function(){return e.ready=!0,e.emit("ready")})):setTimeout(function(t){return function(){return t.ready=!0,t.emit("ready")}}(this),0);var e},n.prototype.findEdgePorts=function(t,e){var n,r,o,i,s;for(i in n=e.component.inPorts.ports||e.component.inPorts,r=e.component.outPorts.ports||e.component.outPorts,n)o=n[i],!1!==(s=this.isExportedInport(o,t,i))&&(this.inPorts.add(s,o),this.inPorts[s].once("connect",function(t){return function(){if(!t.starting&&!t.isStarted())return t.start(function(){})}}(this)));for(i in r)o=r[i],!1!==(s=this.isExportedOutport(o,t,i))&&this.outPorts.add(s,o);return!0},n.prototype.isReady=function(){return this.ready},n.prototype.isSubgraph=function(){return!0},n.prototype.setUp=function(t){var e;if(this.starting=!0,this.isReady())return this.network?this.network.start(function(e){return e?t(e):(this.starting=!1,t())}):t(null);this.once("ready",(e=this,function(){return e.setUp(t)}))},n.prototype.tearDown=function(t){return this.starting=!1,this.network?this.network.stop(function(e){return e?t(e):t()}):t(null)},n}(),e.getComponent=function(t){return new o(t)}}).call(this)}).call(this,n(2))},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component calls a given callback function for each IP it receives.  The Callback component is typically used to connect NoFlo with external Node.js code.",t.icon="sign-out",t.inPorts.add("in",{description:"Object passed as argument of the callback",datatype:"all"}),t.inPorts.add("callback",{description:"Callback to invoke",datatype:"function",control:!0,required:!0}),t.outPorts.add("error",{datatype:"object"}),t.process(function(t,e){var n,r,o,i;if(t.hasData("callback","in")){if(n=(i=t.getData("callback","in"))[0],r=i[1],"function"==typeof n){try{n(r)}catch(t){return o=t,e.done(o)}return e.done()}e.done(new Error("The provided callback must be a function"))}})}},function(t,e,n){var r,o;r=n(0),o=n(40),e.getComponent=function(){var t;return(t=new r.Component).description="deep (i.e. recursively) copy an object",t.icon="copy",t.inPorts.add("in",{datatype:"all",description:"Packet to be copied"}),t.outPorts.add("out",{datatype:"all",description:"Copy of the original packet"}),t.process(function(t,e){var n,r;t.hasData("in")&&(r=t.getData("in"),n=o.deepCopy(r),e.sendDone({out:n}))})}},function(t,e,n){function r(){}function o(t){return"object"==typeof t?(r.prototype=t,new r):t}var i=[];function s(t){for(var e in t)this[e]=t[e]}function a(){this.copiedObjects=[];var t=this;this.recursiveDeepCopy=function(e){return t.deepCopy(e)},this.depth=0}function u(t,e){var n=new a;return e&&(n.maxDepth=e),n.deepCopy(t)}s.prototype={constructor:s,canCopy:function(t){return!1},create:function(t){},populate:function(t,e,n){}},a.prototype={constructor:a,maxDepth:256,cacheResult:function(t,e){this.copiedObjects.push([t,e])},getCachedResult:function(t){for(var e=this.copiedObjects,n=e.length,r=0;r<n;r++)if(e[r][0]===t)return e[r][1]},deepCopy:function(t){if(null===t)return null;if("object"!=typeof t)return t;var e=this.getCachedResult(t);if(e)return e;for(var n=0;n<i.length;n++){var r=i[n];if(r.canCopy(t))return this.applyDeepCopier(r,t)}throw new Error("no DeepCopier is able to copy "+t)},applyDeepCopier:function(t,e){var n=t.create(e);if(this.cacheResult(e,n),this.depth++,this.depth>this.maxDepth)throw new Error("Exceeded max recursion depth in deep copy.");return t.populate(this.recursiveDeepCopy,e,n),this.depth--,n}},u.DeepCopier=s,u.deepCopiers=i,u.register=function(t){t instanceof s||(t=new s(t)),i.unshift(t)},u.register({canCopy:function(t){return!0},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}}),u.register({canCopy:function(t){return t instanceof Array},create:function(t){return new t.constructor},populate:function(t,e,n){for(var r=0;r<e.length;r++)n.push(t(e[r]));return n}}),u.register({canCopy:function(t){return t instanceof Date},create:function(t){return new Date(t)}});var c=n(1).EventEmitter;u.register({canCopy:function(t){return t instanceof c},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&!e.hasOwnProperty(r)||(n[r]=t(e[r]));return n}}),u.register({canCopy:function(t){return!1},create:function(t){return t===document?document:t.cloneNode(!1)},populate:function(t,e,n){if(e===document)return document;if(e.childNodes&&e.childNodes.length)for(var r=0;r<e.childNodes.length;r++){var o=t(e.childNodes[r]);n.appendChild(o)}}}),e.DeepCopyAlgorithm=a,e.copy=function(t){if("object"!=typeof t)return t;var e=t.valueOf();if(t!=e)return new t.constructor(e);if(t instanceof t.constructor&&t.constructor!==Object){var n=o(t.constructor.prototype);for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}else for(var r in n={},t)n[r]=t[r];return n},e.clone=o,e.deepCopy=u},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return(e=new r.Component).description="Makes each data packet a stream of its own",e.icon="pause",e.forwardBrackets={},e.autoOrdering=!1,e.inPorts.add("in",{datatype:"all",description:"Packet to be forward with disconnection"}),e.outPorts.add("out",{datatype:"all"}),t={},e.tearDown=function(e){return t={}},e.process(function(n,o){var i,s,a,u,c,p,d,l;if(e.autoOrdering=!1,a=n.get("in"),t[n.scope]||(t[n.scope]=[]),"openBracket"===a.type)return t[n.scope].push(a.data),void o.done();if("closeBracket"===a.type)return t[n.scope].pop(),void o.done();if("data"===a.type){for(u=0,p=(l=t[n.scope]).length;u<p;u++)i=l[u],o.sendIP("out",new r.IP("openBracket",i));for(o.sendIP("out",a),(s=t[n.scope].slice(0)).reverse(),c=0,d=s.length;c<d;c++)i=s[c],o.sendIP("out",new r.IP("closeBracket",i));return o.done()}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component drops every packet it receives with no action",t.icon="trash-o",t.inPorts.add("in",{datatypes:"all",description:"Packet to be dropped"}),t.process(function(t,e){t.get("in").drop(),e.done()})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component generates a single packet and sends it to the output port. Mostly usable for debugging, but can also be useful for starting up networks.",t.icon="share",t.inPorts.add("in",{datatype:"bang",description:"Signal to send the data packet"}),t.inPorts.add("data",{datatype:"all",description:"Packet to be sent",control:!0,default:null}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;if(t.hasStream("in")&&(!t.attached("data").length||t.hasData("data")))return t.getData("in"),n=t.getData("data"),e.send({out:n}),e.done()})}},function(t,n,r){var o;o=r(0),n.getComponent=function(){var t,n;return(t=new o.Component).description='Evaluates a function each time data hits the "in" port and sends the return value to "out". Within the function "x" will be the variable from the in port. For example, to make a ^2 function input "return x*x;" to the function port.',t.icon="code",t.inPorts.add("in",{datatype:"all",description:"Packet to be processed"}),t.inPorts.add("function",{datatype:"string",description:"Function to evaluate",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("function",{datatype:"function"}),t.outPorts.add("error",{datatype:"object"}),n=function(t,e){var n;if("function"!=typeof t){try{n=Function("x",t)}catch(t){return void e(t)}return e(null,n)}e(null,t)},t.process(function(t,r){t.attached("in").length&&!t.hasData("in")||(t.hasData("function","in")?n(t.getData("function"),function(e,n){var o,i,s;if(e)r.done(i);else{o=t.getData("in");try{s=n(o)}catch(t){return i=t,void r.done(i)}r.sendDone({function:n,out:s})}}):t.hasData("function")&&n(t.getData("function"),function(t,n){t?r.done(e):r.sendDone({function:n})}))})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component receives data on multiple input ports and sends the same data out to the connected output port",t.icon="compress",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){var r,o,i;o=n(0),i=o.isBrowser()?{inspect:function(t){return t}}:n(47),r=function(t,e){return null!=t?console.log(i.inspect(e,t.showHidden,t.depth,t.colors)):console.log(e)},e.getComponent=function(){var t;return(t=new o.Component).description="Sends the data items to console.log",t.icon="bug",t.inPorts.add("in",{datatype:"all",description:"Packet to be printed through console.log"}),t.inPorts.add("options",{datatype:"object",description:"Options to be passed to console.log",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n,o;if(t.hasData("in")&&(!t.attached("options").length||t.hasData("options")))return o=null,t.has("options")&&(o=t.getData("options")),n=t.getData("in"),r(o,n),e.sendDone({out:n})})}},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},o=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<i;u=r[++n])m(u)||!w(u)?s+=" "+u:s+=" "+a(u);return s},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,s={};function a(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),p(r,t,r.depth)}function u(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function c(t,e){return t}function p(t,n,r){if(t.customInspect&&n&&C(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return y(o)||(o=p(t,o,r)),o}var i=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(i)return i;var s=Object.keys(n),a=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),k(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return d(n);if(0===s.length){if(C(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(P(n))return t.stylize(Date.prototype.toString.call(n),"date");if(k(n))return d(n)}var c,w="",E=!1,x=["{","}"];(h(n)&&(E=!0,x=["[","]"]),C(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),P(n)&&(w=" "+Date.prototype.toUTCString.call(n)),k(n)&&(w=" "+d(n)),0!==s.length||E&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=E?function(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)_(e,String(s))?i.push(l(t,e,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(l(t,e,n,r,o,!0))}),i}(t,n,r,a,s):s.map(function(e){return l(t,n,r,a,e,E)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,w,x)):x[0]+w+x[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,o,i){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),_(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(u.value)<0?(a=m(n)?p(t,u.value,null):p(t,u.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),v(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function h(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function y(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===E(t)}function w(t){return"object"==typeof t&&null!==t}function P(t){return w(t)&&"[object Date]"===E(t)}function k(t){return w(t)&&("[object Error]"===E(t)||t instanceof Error)}function C(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function x(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(v(i)&&(i=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=t.pid;s[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else s[n]=function(){};return s[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=b,e.isObject=w,e.isDate=P,e.isError=k,e.isFunction=C,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(48);var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[x(t.getHours()),x(t.getMinutes()),x(t.getSeconds())].join(":"),[t.getDate(),A[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=n(49),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var O="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(O&&t[O]){var e;if("function"!=typeof(e=t[O]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,O,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise(function(t,r){e=t,n=r}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(t,r){t?n(t):e(r)});try{t.apply(this,o)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),O&&Object.defineProperty(e,O,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=O,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};e.apply(this,n).then(function(e){t.nextTick(s,null,e)},function(e){t.nextTick(I,e,s)})}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(2))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(t){var r;r=n(0),e.getComponent=function(){var e;return(e=new r.Component).description="Returns the value of a global variable.",e.icon="usd",e.inPorts.add("name",{description:"The name of the global variable."}),e.outPorts.add("value",{description:"The value of the variable."}),e.outPorts.add("error",{description:"Any errors that occured reading the variables value."}),e.forwardBrackets={name:["value","error"]},e.process(function(e,n){var o,i,s;if(e.hasData("name"))return o=e.getData("name"),void 0===(s=r.isBrowser()?window[o]:t[o])?(i=new Error('"'+o+'" is undefined on the global object.'),void n.sendDone(i)):n.sendDone({value:s})})}}).call(this,n(9))},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Forwards packets and metadata in the same way it receives them",t.icon="forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Like 'Repeat', except repeat on next tick",t.icon="step-forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),setTimeout(function(){return e.sendDone({out:n})},0)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Forward packet after a set delay",t.icon="clock-o",t.timers=[],t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded with a delay"}),t.inPorts.add("delay",{datatype:"number",description:"How much to delay",default:500,control:!0}),t.outPorts.add("out",{datatype:"all"}),t.tearDown=function(e){var n,r,o,i;for(n=0,r=(o=t.timers).length;n<r;n++)i=o[n],clearTimeout(i);return t.timers=[],e()},t.process(function(e,n){var r,o,i;if(e.hasData("in")&&(!e.attached("delay").length||e.hasData("delay")))return r=500,e.hasData("delay")&&(r=e.getData("delay")),o=e.get("in"),i=setTimeout(function(){return t.timers.splice(t.timers.indexOf(i),1),n.sendDone({out:o})},r),t.timers.push(i)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Send a packet at the given interval",t.icon="clock-o",t.inPorts.add("interval",{datatype:"number",description:"Interval at which output packets are emitted (ms)",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the emission"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop the emission"}),t.outPorts.add("out",{datatype:"bang"}),t.timers={},e=function(e){if(t.timers[e])return clearInterval(t.timers[e].interval),t.timers[e].deactivate(),t.timers[e]=null},t.tearDown=function(n){var r,o;for(o in r=t.timers)r[o],e(o);return t.timers={},n()},t.forwardBrackets={},t.process(function(n,o,i){var s,a,u;if(n.hasData("start")){if(!n.hasData("interval"))return;if("data"!==(a=n.get("start")).type)return;return s=parseInt(n.getData("interval")),e(a.scope),i.interval=setInterval(function(){var e;return(e=new r.IP("data",!0)).scope=a.scope,t.outPorts.out.sendIP(e)},s),void(t.timers[a.scope]=i)}if(n.hasData("stop")){if("data"!==(u=n.get("stop")).type)return;e(u.scope)}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Send a packet after the given time in ms",t.icon="clock-o",t.timer={},t.inPorts.add("time",{datatype:"number",description:"Time after which a packet will be sent",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the timeout before sending a packet"}),t.outPorts.add("out",{datatype:"bang"}),t.forwardBrackets={start:["out"]},t.stopTimer=function(e){if(t.timer[e])return clearTimeout(t.timer[e].timeout),t.timer[e].deactivate(),delete t.timer[e]},t.tearDown=function(e){var n,r;for(r in n=t.timer)n[r],t.stopTimer(r);return e()},t.process(function(e,n,r){var o;e.hasData("time","start")&&(o=e.getData("time"),e.getData("start"),t.stopTimer(e.scope),r.timeout=setTimeout(function(){return t.timer=null,n.sendDone({out:!0})},o),t.timer[e.scope]=r)})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Sends next packet in buffer when receiving a bang",t.icon="forward",t.inPorts.add("data",{datatype:"all"}),t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("empty",{datatype:"bang",required:!1}),t.forwardBrackets={},t.process(function(e,n){var r,o,i;if(e.hasData("in")){if(r=e.getData("in"),e.hasData("data")){for(i=!1;e.has("data")&&(!i||"data"!==t.inPorts.data.getBuffer(r.scope)[0].type);)o=e.get("data"),n.send({out:o}),"data"===o.type&&(i=!0);return n.done()}n.sendDone({empty:!0})}})}},function(t,e,n){var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="expand",t.description="This component receives data on a single input port and sends the same data out to all connected output ports",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.element=null,this.class=null,this.inPorts={element:new o.Port("object"),class:new o.Port("string")},this.outPorts={},this.inPorts.element.on("data",(t=this,function(e){if(t.element=e,t.class)return t.addClass()})),this.inPorts.class.on("data",function(t){return function(e){if(t.class=e,t.element)return t.addClass()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Add a class to an element",e.prototype.addClass=function(){return this.element.classList.add(this.class)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.parent=null,this.children=[],this.inPorts={parent:new o.Port("object"),child:new o.Port("object")},this.outPorts={},this.inPorts.parent.on("data",(t=this,function(e){if(t.parent=e,t.children.length)return t.append()})),this.inPorts.child.on("data",function(t){return function(e){if(t.parent)return t.parent.appendChild(e);t.children.push(e)}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Append elements as children of a parent element",e.prototype.append=function(){var t,e,n,r;for(e=0,n=(r=this.children).length;e<n;e++)t=r[e],this.parent.appendChild(t);return this.children=[]},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.tagName=null,this.container=null,this.inPorts={tagname:new o.Port("string"),container:new o.Port("object")},this.outPorts={element:new o.Port("object")},this.inPorts.tagname.on("data",(t=this,function(e){return t.tagName=e,t.createElement()})),this.inPorts.tagname.on("disconnect",function(t){return function(){if(!t.inPorts.container.isAttached())return t.outPorts.element.disconnect()}}(this)),this.inPorts.container.on("data",function(t){return function(e){return t.container=e,t.createElement()}}(this)),this.inPorts.container.on("disconnect",function(t){return function(){return t.outPorts.element.disconnect()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Create a new DOM Element",e.prototype.createElement=function(){var t;if(this.tagName&&(!this.inPorts.container.isAttached()||this.container))return t=document.createElement(this.tagName),this.container&&this.container.appendChild(t),this.outPorts.element.send(t)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.inPorts={in:new o.Port("bang")},this.outPorts={fragment:new o.Port("object")},this.inPorts.in.on("data",(t=this,function(){return t.outPorts.fragment.send(document.createDocumentFragment())})),this.inPorts.in.on("disconnect",function(t){return function(){return t.outPorts.fragment.disconnect()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Create a new DOM DocumentFragment",e}(),e.getComponent=function(){return new r}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Reads the given attribute from the DOM element on the in port.",t.inPorts.add("element",{datatype:"object",description:"The element from which to read the attribute from.",required:!0}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is read from the DOM element.",required:!0}),t.outPorts.add("out",{datatype:"string",description:"Value of the attribute being read."}),r.helpers.WirePattern(t,{in:["element"],out:["out"],params:["attribute"],forwardGroups:!0},function(e,n,r){var o,i;return o=t.params.attribute,i=e.getAttribute(o),r.send(i)})}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.container=null,this.inPorts={in:new o.Port("object"),selector:new o.Port("string")},this.outPorts={element:new o.Port("object"),error:new o.Port("object")},this.inPorts.in.on("data",(t=this,function(e){if("function"==typeof e.querySelector)return t.container=e;t.error("Given container doesn't support querySelectors")})),this.inPorts.selector.on("data",function(t){return function(e){return t.select(e)}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Get a DOM element matching a query",e.prototype.select=function(t){var e,n,r,o;if((e=this.container?this.container.querySelectorAll(t):document.querySelectorAll(t)).length){for(r=0,o=e.length;r<o;r++)n=e[r],this.outPorts.element.send(n);return this.outPorts.element.disconnect()}this.error("No element matching '"+t+"' found")},e.prototype.error=function(t){if(this.outPorts.error.isAttached())return this.outPorts.error.send(new Error(t)),void this.outPorts.error.disconnect();throw new Error(t)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.element=null,this.class=null,this.inPorts={element:new o.Port("object"),class:new o.Port("string")},this.outPorts={element:new o.Port("object"),missed:new o.Port("object")},this.inPorts.element.on("data",(t=this,function(e){if(t.element=e,t.class)return t.checkClass()})),this.inPorts.element.on("disconnect",function(t){return function(){if(t.outPorts.element.disconnect(),t.outPorts.missed.isAttached())return t.outPorts.missed.disconnect()}}(this)),this.inPorts.class.on("data",function(t){return function(e){if(t.class=e,t.element)return t.checkClass()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Check if an element has a given class",e.prototype.checkClass=function(){if(this.element.classList.contains(this.class))this.outPorts.element.send(this.element);else if(this.outPorts.missed.isAttached())return this.outPorts.missed.send(this.element)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.change=i(this.change,this),this.element=null,this.type=null,this.preventDefault=!1,this.inPorts={element:new o.Port("object"),type:new o.Port("string"),preventdefault:new o.Port("boolean")},this.outPorts={element:new o.Port("object"),event:new o.Port("object")},this.inPorts.element.on("data",(t=this,function(e){if(t.element&&t.type&&t.unsubscribe(t.element,t.type),t.element=e,t.type)return t.subscribe(t.element,t.type)})),this.inPorts.type.on("data",function(t){return function(e){if(t.element&&t.type&&t.unsubscribe(t.element,t.type),t.type=e,t.element)return t.subscribe(t.element,t.type)}}(this)),this.inPorts.preventdefault.on("data",function(t){return function(e){return t.preventDefault=e}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="addEventListener for specified event type",e.prototype.icon="stethoscope",e.prototype.unsubscribe=function(t,e){return t.removeEventListener(e,this.change)},e.prototype.subscribe=function(t,e){return t.addEventListener(e,this.change)},e.prototype.change=function(t){if(this.preventDefault&&t.preventDefault(),this.outPorts.element.isAttached()&&this.outPorts.element.send(this.element),this.outPorts.event.isAttached())return this.outPorts.event.send(t)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.inPorts={container:new o.Port("object")},this.outPorts={html:new o.Port("string")},this.inPorts.container.on("data",(t=this,function(e){return t.outPorts.html.send(e.innerHTML),t.outPorts.html.disconnect()}))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Read HTML from an existing element",e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.element=null,this.class=null,this.inPorts={element:new o.Port("object"),class:new o.Port("string")},this.outPorts={},this.inPorts.element.on("data",(t=this,function(e){if(t.element=e,t.class)return t.removeClass()})),this.inPorts.class.on("data",function(t){return function(e){if(t.class=e,t.element)return t.removeClass()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Remove a class from an element",e.prototype.removeClass=function(){return this.element.classList.remove(this.class)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){this.inPorts={element:new o.Port("object")},this.inPorts.element.on("data",function(t){if(t.parentNode)return t.parentNode.removeChild(t)})}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Remove an element from DOM",e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i,s={}.hasOwnProperty;o=n(0),i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(function(){return t(+new Date)},1e3/60)},r=function(t){function e(){var t;this.running=!1,this.inPorts={start:new o.Port("bang"),stop:new o.Port("bang")},this.outPorts={out:new o.Port("bang")},this.inPorts.start.on("data",(t=this,function(e){return t.running=!0,t.animate()})),this.inPorts.stop.on("data",function(t){return function(e){return t.running=!1}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Sends bangs that correspond with screen refresh rate.",e.prototype.icon="film",e.prototype.animate=function(){if(this.running)return i(this.animate.bind(this)),this.outPorts.out.send(!0)},e.prototype.shutdown=function(){return this.running=!1},e}(),e.getComponent=function(){return new r}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Set the given attribute on the DOM element to the received value.",t.inPorts.add("element",{datatype:"object",description:"The element on which to set the attribute.",required:!0}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is set on the DOM element.",required:!0}),t.inPorts.add("value",{datatype:"string",description:"Value of the attribute being set."}),t.outPorts.add("element",{datatype:"object",description:"The element that was updated."}),r.helpers.WirePattern(t,{in:["element","value"],out:["element"],params:["attribute"],forwardGroups:!0},function(e,n,r){var o,i,s,a,u;if(o=t.params.attribute,"object"==typeof(u=e.value))if("[object Array]"===toString.call(u))u=u.join(" ");else{for(i in s=[],u)a=u[i],s.push(a);u=s.join(" ")}return"value"===o?e.element.value=u:e.element.setAttribute(o,u),r.send(e.element)})}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.container=null,this.html=null,this.inPorts={html:new o.Port("string"),container:new o.Port("object")},this.outPorts={container:new o.Port("object")},this.inPorts.html.on("data",(t=this,function(e){if(t.html=e,t.container)return t.writeHtml()})),this.inPorts.container.on("data",function(t){return function(e){if(t.container=e,null!==t.html)return t.writeHtml()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Write HTML inside an existing element",e.prototype.writeHtml=function(){if(this.container.innerHTML=this.html,this.html=null,this.outPorts.container.isAttached())return this.outPorts.container.send(this.container),this.outPorts.container.disconnect()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.inPorts.add("element",{datatype:"all",description:"element to be focused"},(t=this,function(e,n){if("data"===e)return t.element=n})),this.inPorts.add("trigger",{datatype:"bang",description:"trigger focus"},function(t){return function(e,n){if("data"===e)return window.setTimeout(function(){return t.element.focus(),t.outPorts.out.send(n)},0)}}(this)),this.outPorts.add("out")}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="focus element",e.prototype.element=null,e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.change=i(this.change,this),this.elements=[],this.inPorts={element:new o.Port("object")},this.outPorts={value:new o.ArrayPort("all")},this.inPorts.element.on("data",(t=this,function(e){return t.subscribe(e)}))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to mouse events on a DOM element",e.prototype.subscribe=function(t){return t.addEventListener("change",this.change,!1),this.elements.push(t)},e.prototype.unsubscribe=function(){var t,e,n;for(t=0,e=(n=this.elements).length;t<e;t++)n[t].removeEventListener("change",this.change,!1);return this.elements=[]},e.prototype.change=function(t){if(this.outPorts.value.sockets.length)return t.preventDefault(),t.stopPropagation(),this.outPorts.value.send(t.target.value),this.outPorts.value.disconnect()},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.dragend=i(this.dragend,this),this.dragmove=i(this.dragmove,this),this.dragstart=i(this.dragstart,this),this.inPorts={element:new o.Port("object")},this.outPorts={start:new o.ArrayPort("object"),movex:new o.ArrayPort("number"),movey:new o.ArrayPort("number"),end:new o.ArrayPort("object")},this.inPorts.element.on("data",(t=this,function(e){return t.subscribe(e)}))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to drag events on a DOM element",e.prototype.icon="arrows",e.prototype.subscribe=function(t){return t.addEventListener("dragstart",this.dragstart,!1),t.addEventListener("drag",this.dragmove,!1),t.addEventListener("dragend",this.dragend,!1)},e.prototype.dragstart=function(t){return t.preventDefault(),t.stopPropagation(),this.outPorts.start.send(t),this.outPorts.start.disconnect()},e.prototype.dragmove=function(t){return t.preventDefault(),t.stopPropagation(),this.outPorts.movex.send(t.clientX),this.outPorts.movey.send(t.clientY)},e.prototype.dragend=function(t){return t.preventDefault(),t.stopPropagation(),this.outPorts.movex.isConnected()&&this.outPorts.movex.disconnect(),this.outPorts.movey.isConnected()&&this.outPorts.movey.disconnect(),this.outPorts.end.send(t),this.outPorts.end.disconnect()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.hashChange=i(this.hashChange,this),this.current=null,this.inPorts=new o.InPorts({start:{datatype:"bang",description:"Start listening for hash changes"},stop:{datatype:"bang",description:"Stop listening for hash changes"}}),this.outPorts=new o.OutPorts({initial:{datatype:"string",required:!1},change:{datatype:"string",required:!1}}),this.inPorts.start.on("data",(t=this,function(){return t.subscribe()})),this.inPorts.stop.on("data",function(t){return function(){return t.unsubscribe()}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen for hash changes in browser's URL bar",e.prototype.icon="slack",e.prototype.subscribe=function(){return this.current=this.getHash(),window.addEventListener("hashchange",this.hashChange,!1),this.outPorts.initial.send(this.current),this.outPorts.initial.disconnect()},e.prototype.unsubscribe=function(){return window.removeEventListener("hashchange",this.hashChange,!1),this.outPorts.change.disconnect()},e.prototype.hashChange=function(t){var e;if(e=this.current,this.current=this.getHash(),e&&this.outPorts.change.beginGroup(e),this.outPorts.change.send(this.current),e)return this.outPorts.change.endGroup(e)},e.prototype.getHash=function(){return window.location.href.split("#")[1]||""},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.keypress=i(this.keypress,this),this.elements=[],this.inPorts={element:new o.Port("object"),stop:new o.Port("object")},this.outPorts={keypress:new o.Port("int")},this.inPorts.element.on("data",(t=this,function(e){return t.subscribe(e)})),this.inPorts.stop.on("data",function(t){return function(e){return t.unsubscribe(e)}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen for key presses on a given DOM element",e.prototype.icon="keyboard-o",e.prototype.subscribe=function(t){return t.addEventListener("keypress",this.keypress,!1),this.elements.push(t)},e.prototype.unsubscribe=function(t){if(-1!==this.elements.indexOf(t))return t.removeEventListener("keypress",this.keypress,!1),this.elements.splice(this.elements.indexOf(t),1)},e.prototype.keypress=function(t){if(this.outPorts.keypress.isAttached())return this.outPorts.keypress.send(t.keyCode),this.outPorts.keypress.disconnect()},e.prototype.shutdown=function(){var t,e,n,r,o;for(o=[],e=0,n=(r=this.elements).length;e<n;e++)t=r[e],o.push(this.unsubscribe(t));return o},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.keypress=i(this.keypress,this),this.keys=[],this.ignoreInput=!0,this.inPorts={keys:new o.Port("string"),ignoreinput:new o.Port("boolean"),stop:new o.Port("bang")},this.outPorts={shortcut:new o.ArrayPort("bang"),missed:new o.Port("int")},this.inPorts.keys.on("data",(t=this,function(e){return t.keys=t.normalizeKeys(e),t.subscribe()})),this.inPorts.ignoreinput.on("data",function(t){return function(e){return t.ignoreInput="true"===String(e)}}(this)),this.inPorts.stop.on("data",function(t){return function(){return t.unsubscribe()}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen for keyboard shortcuts and route them",e.prototype.icon="keyboard-o",e.prototype.subscribe=function(){return document.addEventListener("keydown",this.keypress,!1)},e.prototype.unsubscribe=function(){return document.removeEventListener("keydown",this.keypress,!1)},e.prototype.normalizeKeys=function(t){var e,n,r,o;for(n=e=0,o=(r=t.split(",")).length;e<o;n=++e)switch(r[n]){case"-":r[n]=189;break;case"=":r[n]=187;break;case"0":r[n]=48;break;case"a":r[n]=65;break;case"x":r[n]=88;break;case"c":r[n]=67;break;case"v":r[n]=86;break;case"z":r[n]=90;break;case"r":r[n]=82;break;case"s":r[n]=83}return r},e.prototype.validateTarget=function(t){return!this.ignoreInput||"TEXTAREA"!==t.target.tagName&&("INPUT"!==t.target.tagName&&"true"!==String(t.target.contentEditable))},e.prototype.keypress=function(t){var e;if((t.ctrlKey||t.metaKey)&&this.validateTarget(t)){if(-1!==(e=this.keys.indexOf(t.keyCode)))return t.preventDefault(),t.stopPropagation(),this.outPorts.shortcut.send(t.keyCode,e),this.outPorts.shortcut.disconnect();this.outPorts.missed.isAttached()&&(this.outPorts.missed.send(t.keyCode),this.outPorts.missed.disconnect())}},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.dblclick=i(this.dblclick,this),this.click=i(this.click,this),this.elements=[],this.inPorts={element:new o.Port("object")},this.outPorts={click:new o.ArrayPort("object"),dblclick:new o.ArrayPort("object")},this.inPorts.element.on("data",(t=this,function(e){return t.subscribe(e)}))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to mouse events on a DOM element",e.prototype.subscribe=function(t){return t.addEventListener("click",this.click,!1),t.addEventListener("dblclick",this.dblclick,!1),this.elements.push(t)},e.prototype.unsubscribe=function(){var t,e,n,r;for(e=0,n=(r=this.elements).length;e<n;e++)(t=r[e]).removeEventListener("click",this.click,!1),t.removeEventListener("dblclick",this.dblclick,!1);return this.elements=[]},e.prototype.click=function(t){if(this.outPorts.click.sockets.length)return t.preventDefault(),t.stopPropagation(),this.outPorts.click.send(t),this.outPorts.click.disconnect(),this.updateIcon()},e.prototype.dblclick=function(t){if(this.outPorts.dblclick.sockets.length)return t.preventDefault(),t.stopPropagation(),this.outPorts.dblclick.send(t),this.outPorts.dblclick.disconnect(),this.updateIcon()},e.prototype.updateIcon=function(){var t;if(this.setIcon&&!this.timeout)return this.originalIcon=this.getIcon(),this.setIcon("exclamation-circle"),this.timeout=setTimeout((t=this,function(){return t.setIcon(t.originalIcon),t.timeout=null}),200)},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.pointerLeave=i(this.pointerLeave,this),this.pointerEnter=i(this.pointerEnter,this),this.pointerOut=i(this.pointerOut,this),this.pointerOver=i(this.pointerOver,this),this.pointerMove=i(this.pointerMove,this),this.pointerCancel=i(this.pointerCancel,this),this.pointerUp=i(this.pointerUp,this),this.pointerDown=i(this.pointerDown,this),this.action="none",this.capture=!1,this.propagate=!1,this.elements=[],this.inPorts={element:new o.Port("object"),action:new o.Port("string"),capture:new o.Port("boolean"),propagate:new o.Port("boolean")},this.outPorts={down:new o.Port("object"),up:new o.Port("object"),cancel:new o.Port("object"),move:new o.Port("object"),over:new o.Port("object"),out:new o.Port("object"),enter:new o.Port("object"),leave:new o.Port("object")},this.inPorts.element.on("data",(t=this,function(e){return t.subscribe(e)})),this.inPorts.action.on("data",function(t){return function(e){t.action=e}}(this)),this.inPorts.capture.on("data",function(t){return function(e){t.capture=e}}(this)),this.inPorts.propagate.on("data",function(t){return function(e){t.propagate=e}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to pointer events on a DOM element",e.prototype.subscribe=function(t){return t.setAttribute&&t.setAttribute("touch-action",this.action),t.addEventListener("pointerdown",this.pointerDown,this.capture),t.addEventListener("pointerup",this.pointerUp,this.capture),t.addEventListener("pointercancel",this.pointerCancel,this.capture),t.addEventListener("pointermove",this.pointerMove,this.capture),t.addEventListener("pointerover",this.pointerOver,this.capture),t.addEventListener("pointerout",this.pointerOut,this.capture),t.addEventListener("pointerenter",this.pointerEnter,this.capture),t.addEventListener("pointerleave",this.pointerLeave,this.capture),this.elements.push(t)},e.prototype.unsubscribe=function(t){var e,n,r,o;for(e in t.removeAttribute&&t.removeAttribute("touch-action"),t.removeEventListener("pointerdown",this.pointerDown,this.capture),t.removeEventListener("pointerup",this.pointerUp,this.capture),t.removeEventListener("pointercancel",this.pointerCancel,this.capture),t.removeEventListener("pointermove",this.pointerMove,this.capture),t.removeEventListener("pointerover",this.pointerOver,this.capture),t.removeEventListener("pointerout",this.pointerOut,this.capture),t.removeEventListener("pointerenter",this.pointerEnter,this.capture),t.removeEventListener("pointerleave",this.pointerLeave,this.capture),o=[],r=this.outPorts)(n=r[e]).isAttached()&&o.push(n.disconnect());return o},e.prototype.shutdown=function(){var t,e,n,r;for(e=0,n=(r=this.elements).length;e<n;e++)t=r[e],this.unsubscribe(t);return this.elements=[]},e.prototype.pointerDown=function(t){return this.handle(t,"down")},e.prototype.pointerUp=function(t){return this.handle(t,"up")},e.prototype.pointerCancel=function(t){return this.handle(t,"cancel")},e.prototype.pointerMove=function(t){return this.handle(t,"move")},e.prototype.pointerOver=function(t){return this.handle(t,"over")},e.prototype.pointerOut=function(t){return this.handle(t,"out")},e.prototype.pointerEnter=function(t){return this.handle(t,"enter")},e.prototype.pointerLeave=function(t){return this.handle(t,"leave")},e.prototype.handle=function(t,e){var n,r,o,i;if(t.preventDefault(),this.propagate||t.stopPropagation(),this.outPorts[e].isAttached()&&(this.outPorts[e].beginGroup(t.pointerId),this.outPorts[e].send(t),this.outPorts[e].endGroup(),"up"===e||"cancel"===e||"leave"===e)){for(n in i=[],o=this.outPorts)(r=o[n]).isAttached()&&i.push(r.disconnect());return i}},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.sendSize=i(this.sendSize,this),this.inPorts={start:new o.Port("bang"),stop:new o.Port("bang")},this.outPorts={width:new o.Port("number"),height:new o.Port("number")},this.inPorts.start.on("data",(t=this,function(){return t.sendSize(),t.subscribe()})),this.inPorts.stop.on("data",function(t){return function(){return t.unsubscribe()}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to window resize events",e.prototype.icon="desktop",e.prototype.subscribe=function(){return window.addEventListener("resize",this.sendSize,!1)},e.prototype.unsubscribe=function(){return window.removeEventListener("resize",this.sendSize,!1)},e.prototype.sendSize=function(){if(this.outPorts.width.isAttached()&&(this.outPorts.width.send(window.innerWidth),this.outPorts.width.disconnect()),this.outPorts.height.isAttached())return this.outPorts.height.send(window.innerHeight),this.outPorts.height.disconnect()},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.scroll=i(this.scroll,this),this.inPorts={start:new o.Port("bang"),stop:new o.Port("bang")},this.outPorts={top:new o.Port("number"),bottom:new o.Port("number"),left:new o.Port("number"),right:new o.Port("number")},this.inPorts.start.on("data",(t=this,function(){return t.subscribe()})),this.inPorts.stop.on("data",function(t){return function(){return t.unsubscribe()}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to scroll events on the browser window",e.prototype.icon="arrows-v",e.prototype.subscribe=function(){return window.addEventListener("scroll",this.scroll,!1)},e.prototype.unsubscribe=function(){return window.removeEventListener("scroll",this.scroll,!1)},e.prototype.scroll=function(t){var e,n,r,o;if(o=window.scrollY,n=window.scrollX,this.outPorts.top.isAttached()&&(this.outPorts.top.send(o),this.outPorts.top.disconnect()),this.outPorts.bottom.isAttached()&&(e=o+window.innerHeight,this.outPorts.bottom.send(e),this.outPorts.bottom.disconnect()),this.outPorts.left.isAttached()&&(this.outPorts.left.send(n),this.outPorts.left.disconnect()),this.outPorts.right.isAttached())return r=n+window.innerWidth,this.outPorts.right.send(r),this.outPorts.right.disconnect()},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.handleError=i(this.handleError,this),this.handleResult=i(this.handleResult,this),this.recognition=!1,this.sent=[],this.inPorts={start:new o.Port("bang"),stop:new o.Port("bang")},this.outPorts={result:new o.Port("string"),error:new o.Port("object")},this.inPorts.start.on("data",(t=this,function(){return t.startListening()})),this.inPorts.stop.on("data",function(t){return function(){return t.stopListening()}}(this))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen for user's microphone and recognize phrases",e.prototype.icon="microphone",e.prototype.startListening=function(){return window.webkitSpeechRecognition||this.handleError(new Error("Speech recognition support not available")),this.recognition=new window.webkitSpeechRecognition,this.recognition.continuous=!0,this.recognition.start(),this.outPorts.result.connect(),this.recognition.onresult=this.handleResult,this.recognition.onerror=this.handleError},e.prototype.handleResult=function(t){var e,n,r,o,i,s;for(s=[],n=e=0,r=(o=t.results).length;e<r;n=++e)(i=o[n]).isFinal&&-1===this.sent.indexOf(n)&&(this.outPorts.result.send(i[0].transcript),s.push(this.sent.push(n)));return s},e.prototype.handleError=function(t){if(this.outPorts.error.isAttached())return this.outPorts.error.send(t),void this.outPorts.error.disconnect();throw t},e.prototype.stopListening=function(){if(this.recognition)return this.outPorts.result.disconnect(),this.recognition.stop(),this.recognition=null,this.sent=[]},e.prototype.shutdown=function(){return this.stopListening()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.touchend=i(this.touchend,this),this.touchmove=i(this.touchmove,this),this.touchstart=i(this.touchstart,this),this.elements=[],this.inPorts={element:new o.Port("object")},this.outPorts={start:new o.ArrayPort("object"),movex:new o.ArrayPort("number"),movey:new o.ArrayPort("number"),end:new o.ArrayPort("object")},this.inPorts.element.on("data",(t=this,function(e){return t.subscribe(e)}))}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Listen to touch events on a DOM element",e.prototype.icon="hand-o-up",e.prototype.subscribe=function(t){return t.addEventListener("touchstart",this.touchstart,!1),t.addEventListener("touchmove",this.touchmove,!1),t.addEventListener("touchend",this.touchend,!1),this.elements.push(t)},e.prototype.unsubscribe=function(){var t,e,n,r;for(e=0,n=(r=this.elements).length;e<n;e++)(t=r[e]).removeEventListener("touchstart",this.touchstart,!1),t.removeEventListener("touchmove",this.touchmove,!1),t.removeEventListener("touchend",this.touchend,!1);return this.elements=[]},e.prototype.touchstart=function(t){var e,n,r,o;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(n=e=0,r=(o=t.changedTouches).length;e<r;n=++e)o[n],this.outPorts.start.beginGroup(n),this.outPorts.start.send(t),this.outPorts.start.endGroup();return this.outPorts.start.disconnect()}},e.prototype.touchmove=function(t){var e,n,r,o,i,s;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(i=[],n=e=0,r=(o=t.changedTouches).length;e<r;n=++e)s=o[n],this.outPorts.movex.beginGroup(n),this.outPorts.movex.send(s.pageX),this.outPorts.movex.endGroup(),this.outPorts.movey.beginGroup(n),this.outPorts.movey.send(s.pageY),i.push(this.outPorts.movey.endGroup());return i}},e.prototype.touchend=function(t){var e,n,r,o;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(this.outPorts.movex.isConnected()&&this.outPorts.movex.disconnect(),this.outPorts.movey.isConnected()&&this.outPorts.movey.disconnect(),n=e=0,r=(o=t.changedTouches).length;e<r;n=++e)o[n],this.outPorts.end.beginGroup(n),this.outPorts.end.send(t),this.outPorts.end.endGroup();return this.outPorts.end.disconnect()}},e.prototype.shutdown=function(){return this.unsubscribe()},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.inPorts={event:new o.Port("object")},this.outPorts={screen:new o.Port("object"),client:new o.Port("object"),page:new o.Port("object")},this.inPorts.event.on("begingroup",(t=this,function(e){if(t.outPorts.screen.isAttached()&&t.outPorts.screen.beginGroup(e),t.outPorts.client.isAttached()&&t.outPorts.client.beginGroup(e),t.outPorts.page.isAttached())return t.outPorts.page.beginGroup(e)})),this.inPorts.event.on("data",function(t){return function(e){return t.read(e)}}(this)),this.inPorts.event.on("endgroup",function(t){return function(){if(t.outPorts.screen.isAttached()&&t.outPorts.screen.endGroup(),t.outPorts.client.isAttached()&&t.outPorts.client.endGroup(),t.outPorts.page.isAttached())return t.outPorts.page.endGroup()}}(this)),this.inPorts.event.on("disconnect",function(t){return function(){if(t.outPorts.screen.isAttached()&&t.outPorts.screen.disconnect(),t.outPorts.client.isAttached()&&t.outPorts.client.disconnect(),t.outPorts.page.isAttached())return t.outPorts.page.disconnect()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Read the coordinates from a DOM event",e.prototype.read=function(t){if(t)return this.outPorts.screen.isAttached()&&void 0!==t.screenX&&this.outPorts.screen.send({x:t.screenX,y:t.screenY}),this.outPorts.client.isAttached()&&void 0!==t.clientX&&this.outPorts.client.send({x:t.clientX,y:t.clientY}),this.outPorts.page.isAttached()&&void 0!==t.pageX?this.outPorts.page.send({x:t.pageX,y:t.pageY}):void 0},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.lastTimestamp,this.inPorts={gamepad:new o.Port("int")},this.outPorts={out:new o.Port("object"),error:new o.Port("string")},this.inPorts.gamepad.on("data",(t=this,function(e){return t.readGamepad(e)}))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Read the state of a gamepad",e.prototype.icon="gamepad",e.prototype.readGamepad=function(t){var e,n;if(!navigator.webkitGetGamepads){if(n="no webkit gamepad api available",this.outPorts.error.isAttached())return this.outPorts.error.send(n),void this.outPorts.error.disconnect();throw new Error(n)}if(!(e=navigator.webkitGetGamepads()[t])){if(n="state for gamepad '"+t+"' could not been read",this.outPorts.error.isAttached())return this.outPorts.error.send(n),void this.outPorts.error.disconnect();throw new Error(n)}if(this.lastTimestamp!==e.timestamp)return this.lastTimestamp=e.timestamp,this.outPorts.out.send(e)},e}(),e.getComponent=function(){return new r}},function(t,e,n){var r,o,i={}.hasOwnProperty;o=n(0),r=function(t){function e(){var t;this.inPorts={hash:new o.ArrayPort("string")},this.outPorts={out:new o.Port("string")},this.inPorts.hash.on("data",(t=this,function(e){if(window.location.hash="#"+e,t.outPorts.out.isAttached())return t.outPorts.out.send(e)})),this.inPorts.hash.on("disconnect",function(t){return function(){if(t.outPorts.out.isAttached())return t.outPorts.out.disconnect()}}(this))}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Component),e.prototype.description="Set the hash in browser's URL bar",e.prototype.icon="slack",e}(),e.getComponent=function(){return new r}},function(t,e,n){"use strict";t.exports=function(t){function e(t){for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){var n;function s(){if(s.enabled){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var i=s,a=Number(new Date),u=a-(n||a);i.diff=u,i.prev=n,i.curr=a,n=a,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var c=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;c++;var o=r.formatters[n];if("function"==typeof o){var s=e[c];t=o.call(i,s),e.splice(c,1),c--}return t}),r.formatArgs.call(i,e),(i.log||r.log).apply(i,e)}}return s.namespace=t,s.enabled=r.enabled(t),s.useColors=r.useColors(),s.color=e(t),s.destroy=o,s.extend=i,"function"==typeof r.init&&r.init(s),r.instances.push(s),s}function o(){var t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function i(t,e){return r(this.namespace+(void 0===e?":":e)+t)}return r.debug=r,r.default=r,r.coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){r.enable("")},r.enable=function(t){var e;r.save(t),r.names=[],r.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(e=0;e<o;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){var i=r.instances[e];i.enabled=r.enabled(i.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=n(88),Object.keys(t).forEach(function(e){r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},function(t,e){var n=1e3,r=60*n,o=60*r,i=24*o,s=7*i,a=365.25*i;function u(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var u=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*a;case"weeks":case"week":case"w":return u*s;case"days":case"day":case"d":return u*i;case"hours":case"hour":case"hrs":case"hr":case"h":return u*o;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(t);if("number"===c&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=i)return u(t,e,i,"day");if(e>=o)return u(t,e,o,"hour");if(e>=r)return u(t,e,r,"minute");if(e>=n)return u(t,e,n,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=i)return Math.round(t/i)+"d";if(e>=o)return Math.round(t/o)+"h";if(e>=r)return Math.round(t/r)+"m";if(e>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(t){(function(){var r,o,i,s,a=function(t,e){return function(){return t.apply(e,arguments)}},u={}.hasOwnProperty;s=n(11),o=n(17),i=n(5),r=function(e){function n(t,e,n){if(this.inPortName=null!=t?t:"in",this.outPortName=null!=e?e:"out",this.errPortName=null!=n?n:"error",this.error=a(this.error,this),i.deprecated("noflo.AsyncComponent is deprecated. Please port to Process API"),!this.inPorts[this.inPortName])throw new Error("no inPort named '"+this.inPortName+"'");if(!this.outPorts[this.outPortName])throw new Error("no outPort named '"+this.outPortName+"'");var r;this.load=0,this.q=[],this.errorGroups=[],this.outPorts.load=new s.Port,this.inPorts[this.inPortName].on("begingroup",(r=this,function(t){return r.load>0?r.q.push({name:"begingroup",data:t}):(r.errorGroups.push(t),r.outPorts[r.outPortName].beginGroup(t))})),this.inPorts[this.inPortName].on("endgroup",function(t){return function(){return t.load>0?t.q.push({name:"endgroup"}):(t.errorGroups.pop(),t.outPorts[t.outPortName].endGroup())}}(this)),this.inPorts[this.inPortName].on("disconnect",function(t){return function(){return t.load>0?t.q.push({name:"disconnect"}):(t.outPorts[t.outPortName].disconnect(),t.errorGroups=[],t.outPorts.load.isAttached()?t.outPorts.load.disconnect():void 0)}}(this)),this.inPorts[this.inPortName].on("data",function(t){return function(e){return t.q.length>0?t.q.push({name:"data",data:e}):t.processData(e)}}(this))}return function(t,e){for(var n in e)u.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,o.Component),n.prototype.processData=function(t){return this.incrementLoad(),this.doAsync(t,(e=this,function(t){return t&&e.error(t,e.errorGroups,e.errPortName),e.decrementLoad()}));var e},n.prototype.incrementLoad=function(){if(this.load++,this.outPorts.load.isAttached()&&this.outPorts.load.send(this.load),this.outPorts.load.isAttached())return this.outPorts.load.disconnect()},n.prototype.doAsync=function(t,e){return e(new Error("AsyncComponents must implement doAsync"))},n.prototype.decrementLoad=function(){if(0===this.load)throw new Error("load cannot be negative");return this.load--,this.outPorts.load.isAttached()&&this.outPorts.load.send(this.load),this.outPorts.load.isAttached()&&this.outPorts.load.disconnect(),void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick((e=this,function(){return e.processQueue()})):setTimeout(function(t){return function(){return t.processQueue()}}(this),0);var e},n.prototype.processQueue=function(){var t,e;if(!(this.load>0))for(e=!1;this.q.length>0;)switch((t=this.q[0]).name){case"begingroup":if(e)return;this.outPorts[this.outPortName].beginGroup(t.data),this.errorGroups.push(t.data),this.q.shift();break;case"endgroup":if(e)return;this.outPorts[this.outPortName].endGroup(),this.errorGroups.pop(),this.q.shift();break;case"disconnect":if(e)return;this.outPorts[this.outPortName].disconnect(),this.outPorts.load.isAttached()&&this.outPorts.load.disconnect(),this.errorGroups=[],this.q.shift();break;case"data":this.processData(t.data),this.q.shift(),e=!0}},n.prototype.tearDown=function(t){return this.q=[],this.errorGroups=[],t()},n.prototype.error=function(t,e,n){var r,o,i,s,a;if(null==e&&(e=[]),null==n&&(n="error"),!this.outPorts[n]||!this.outPorts[n].isAttached()&&this.outPorts[n].isRequired())throw t;for(o=0,s=e.length;o<s;o++)r=e[o],this.outPorts[n].beginGroup(r);for(this.outPorts[n].send(t),i=0,a=e.length;i<a;i++)r=e[i],this.outPorts[n].endGroup();this.outPorts[n].disconnect()},n}(),e.AsyncComponent=r}).call(this)}).call(this,n(2))},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var o,i,s,a,u,c,p,d,l,h,f,m,g,y,v,b,w,P,k,C,E,x,A,_,O=[].slice,I={}.hasOwnProperty;a=n(12).StreamSender,n(12).StreamReceiver,i=n(6),o=n(4),b=n(5),_=n(16),l=n(3)("noflo:helpers"),y=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(arg)},e.MapComponent=function(t,e,n){return b.deprecated("noflo.helpers.MapComponent is deprecated. Please port to Process API"),n||(n={}),n.inPort||(n.inPort="in"),n.outPort||(n.outPort="out"),t.forwardBrackets||(t.forwardBrackets={}),t.forwardBrackets[n.inPort]=[n.outPort],t.process(function(r,o){var i,s,a;if(r.hasData(n.inPort))return i=r.getData(n.inPort),s=h(t,n.inPort,r),a=m([n.outPort],o),e(i,s,a),o.done()})},e.WirePattern=function(e,n,r){var o,i,s,a;if(o="in"in n?n.in:"in",y(o)||(o=[o]),i="out"in n?n.out:"out",y(i)||(i=[i]),"error"in n||(n.error="error"),"async"in n||(n.async=!1),"ordered"in n||(n.ordered=!0),"group"in n||(n.group=!1),"field"in n||(n.field=null),"forwardGroups"in n||(n.forwardGroups=!1),n.forwardGroups&&("string"==typeof n.forwardGroups&&(n.forwardGroups=[n.forwardGroups]),"boolean"==typeof n.forwardGroups&&(n.forwardGroups=o)),"receiveStreams"in n||(n.receiveStreams=!1),n.receiveStreams)throw new Error("WirePattern receiveStreams is deprecated");if("sendStreams"in n||(n.sendStreams=!1),n.sendStreams)throw new Error("WirePattern sendStreams is deprecated");return n.async&&(n.sendStreams=i),"params"in n||(n.params=[]),"string"==typeof n.params&&(n.params=[n.params]),"name"in n||(n.name=""),"dropInput"in n||(n.dropInput=!1),"arrayPolicy"in n||(n.arrayPolicy={in:"any",params:"all"}),n.inPorts=o,n.outPorts=i,u(n,r),n.legacy||(null!=t&&null!=(s=t.env)?s.NOFLO_WIREPATTERN_LEGACY:void 0)?(b.deprecated("noflo.helpers.WirePattern legacy mode is deprecated"),a=v):a=P,a(e,n,r)},P=function(t,e,n){return E(t,e),A(t),C(t,e),t.ordered=e.ordered,t.process(function(r,o,i){var s,a,u,p,d,g;if(c(e,r,o)){if(t.params=w(e,r),s=f(e,r),u=h(t,e.inPorts[0],r),p=m(e.outPorts,o),l("WirePattern Process API call with",s,u,t.params,i.scope),d=function(){throw new Error("noflo.helpers.WirePattern postpone is deprecated")},g=function(){throw new Error("noflo.helpers.WirePattern resume is deprecated")},!e.async){if(a=x(t,e,o),n.call(t,s,u,p,d,g,r.scope),o.result.__resolved)return;return a(),void o.done()}return a=x(t,e,o),n.call(t,s,u,p,function(t){return a(),o.done(t)},d,g,r.scope)}})},u=function(t,e){t.group&&b.deprecated("noflo.helpers.WirePattern group option is deprecated. Please port to Process API"),t.field&&b.deprecated("noflo.helpers.WirePattern field option is deprecated. Please port to Process API"),e.length>4&&b.deprecated("noflo.helpers.WirePattern postpone and resume are deprecated. Please port to Process API"),t.async||b.deprecated("noflo.helpers.WirePattern synchronous is deprecated. Please port to Process API"),"error"!==t.error&&b.deprecated('noflo.helpers.WirePattern custom error port name is deprecated. Please switch to "error" or port to WirePattern')},E=function(t,e){var n,r,o,i,s;for(s=[],n=0,r=(i=e.params).length;n<r;n++)o=i[n],s.push(t.inPorts[o].options.control=!0);return s},C=function(t,e){var n,r,o,i,s,a,u,c;if(t.forwardBrackets={},e.forwardGroups)for(r=e.inPorts,y(e.forwardGroups)&&(r=e.forwardGroups),o=0,s=r.length;o<s;o++){for(n=r[o],t.forwardBrackets[n]=[],i=0,a=(c=e.outPorts).length;i<a;i++)u=c[i],t.forwardBrackets[n].push(u);t.outPorts.error&&t.forwardBrackets[n].push("error")}},x=function(t,e,n){var r,i,s,a;return i=[],r=function(e,n){return null==n&&(n=[]),b.deprecated("noflo.helpers.WirePattern error method is deprecated. Please send error to callback instead"),i.push({err:e,groups:n}),t.hasErrors=!0},s=function(t,e){return null==t&&(t=null),null==e&&(e=[]),b.deprecated("noflo.helpers.WirePattern fail method is deprecated. Please send error to callback instead"),t&&r(t,e),a(),n.done()},a=function(){if(i.length)return e.name&&n.sendIP("error",new o("openBracket",e.name)),i.forEach(function(t){var e,r,i,s,a,u,c,p;for(r=0,s=(u=t.groups).length;r<s;r++)e=u[r],n.sendIP("error",new o("openBracket",e));for(n.sendIP("error",new o("data",t.err)),p=[],i=0,a=(c=t.groups).length;i<a;i++)e=c[i],p.push(n.sendIP("error",new o("closeBracket",e)));return p}),e.name&&n.sendIP("error",new o("closeBracket",e.name)),t.hasErrors=!1,i=[]},t.hasErrors=!1,t.error=r,t.fail=s,a},A=function(t){var e;return e=Object.keys(t.inPorts.ports).filter(function(e){return!!t.inPorts[e].options.control&&!!t.inPorts[e].hasDefault()}),t.sendDefaults=function(){return b.deprecated("noflo.helpers.WirePattern sendDefaults method is deprecated. Please start with a Network"),e.forEach(function(e){var n;return n=i.createSocket(),t.inPorts[e].attach(n),n.send(),n.disconnect(),t.inPorts[e].detach(n)})}},w=function(t,e){var n,r,o,i,s,a,u,c,p;if(!t.params.length)return{};for(u={},r=0,i=(c=t.params).length;r<i;r++)if(a=c[r],e.ports[a].isAddressable())for(u[a]={},o=0,s=(p=e.attached(a)).length;o<s;o++)n=p[o],e.hasData([a,n])&&(u[a][n]=e.getData([a,n]));else u[a]=e.getData(a);return u},k=function(t,e){var n,r,o,i,s,a,u,c,p,d,l;for(p=null,n=[],d=[],r=i=0,a=t.length;i<a;r=++i)if("openBracket"!==(o=t[r]).type){if("closeBracket"!==o.type)e(o,n)?(p=d.slice(0)).push(o):d=[];else if(n.pop(),p&&p.push(o),d.length&&d.pop(),p&&!d.length)break}else n.push(o.data),d.push(o);if(0!==(l=t.indexOf(p[0]))){for(t.splice(l,p.length),p.reverse(),c=[],s=0,u=p.length;s<u;s++)o=p[s],c.push(t.unshift(o));return c}},g=function(t,e,n,r,o){var i;if(e.group||e.field)return e.group&&(i=n.ports[r].getBuffer(n.scope,o),k(i,function(t,e){var r,i,s,a;for(a=n.collatedBy.brackets,o=i=0,s=a.length;i<s;o=++i)if(r=a[o],e[o]!==r)return!1;return!0})),e.field?(t[e.field]=n.collatedBy.field,i=n.ports[r].getBuffer(n.scope,o),k(i,function(n){return n.data[e.field]===t[e.field]})):void 0},f=function(t,e){var n,r,o,i,s,a,u,c,p;for(n={},o=0,s=(c=t.inPorts).length;o<s;o++)if(u=c[o],e.ports[u].isAddressable())for(n[u]={},i=0,a=(p=e.attached(u)).length;i<a;i++)r=p[i],e.hasData([u,r])&&(g(n,t,e,u,r),n[u][r]=e.getData([u,r]));else e.hasData(u)&&(g(n,t,e,u),n[u]=e.getData(u));return 1===t.inPorts.length?n[t.inPorts[0]]:n},h=function(t,e,n){var r,o;return null==(null!=(r=n.result.__bracketContext)?r[e]:void 0)?[]:(null!=(o=n.collatedBy)?o.brackets:void 0)?n.collatedBy.brackets:n.result.__bracketContext[e].filter(function(t){return t.source===e}).map(function(t){return t.ip.data})},m=function(t,e){var n;return n={},t.forEach(function(t){return n[t]={connect:function(){},beginGroup:function(n,r){var i;return(i=new o("openBracket",n)).index=r,e.sendIP(t,i)},send:function(n,r){var i;return(i=new o("data",n)).index=r,e.sendIP(t,i)},endGroup:function(n,r){var i;return(i=new o("closeBracket",n)).index=r,e.sendIP(t,i)},disconnect:function(){}}}),1===t.length?n[t[0]]:n},c=function(t,e,n){var r,o,i,s,a,u,c,l,h,f,m;if(h=d(t,e),i=p(t,e),t.dropInput&&!h){for(l=!1,s=0,u=(m=t.inPorts).length;s<u;s++)if(f=m[s],e.ports[f].isAddressable()){if(!(r=e.attached(f)).length)continue;for(a=0,c=r.length;a<c;a++)for(o=r[a];e.has([f,o]);)l=!0,e.get([f,o]).drop()}else for(;e.has(f);)l=!0,e.get(f).drop();l&&n.done()}return i&&h},d=function(t,e){var n,r,o,i,s,a;for(r=0,o=(s=t.params).length;r<o;r++)if(i=s[r],e.ports[i].isRequired())if(e.ports[i].isAddressable()){if(!(n=e.attached(i)).length)return!1;if(a=n.filter(function(t){return e.hasData([i,t])}),"all"===t.arrayPolicy.params){if(a.length!==n.length)return!1;continue}if(!a.length)return!1}else if(!e.hasData(i))return!1;return!0},p=function(t,e){var n,r,o,i,s,a,u,c,p,d;for(t.group&&(r={},e.collatedBy={brackets:[],ready:!1},o=function(t,e){var n,r,o,i;for(r=o=0,i=t.length;o<i;r=++o)if(n=t[r],e[r]!==n)return!1;return!0},i=function(n,i){var s,a;if(a=i.slice(0),t.group instanceof RegExp){if(!(a=a.slice(0,1)).length)return!1;if(!t.group.test(a[0]))return!1}return e.collatedBy.ready?o(e.collatedBy.brackets,a):(s=a.join(":"),r[s]||(r[s]=[]),-1===r[s].indexOf(c)&&r[s].push(c),t.inPorts.indexOf(c)!==t.inPorts.length-1||r[s].length===t.inPorts.length&&(!e.collatedBy.ready&&(e.collatedBy.ready=!0,e.collatedBy.brackets=a,!0)))}),t.field&&(e.collatedBy={field:void 0,ready:!1}),s=function(n){var r,o,s,a,u,c,p;if(!t.group&&!t.field)return e.hasData(n);if(t.group){for(p=[],[],s=!1,u=0,c=(r=e.ports[n].getBuffer(e.scope)).length;u<c;u++)if("openBracket"!==(a=r[u]).type)if("closeBracket"!==a.type)o=i(a,p);else{if(p.pop(),p.length)continue;if(!o)continue;s=!0}else p.push(a.data);return s}return t.field?e.hasStream(n,function(n){return e.collatedBy.ready?n.data[t.field]===e.collatedBy.field:(e.collatedBy.field=n.data[t.field],e.collatedBy.ready=!0,!0)}):void 0},a=0,u=(p=t.inPorts).length;a<u;a++)if(c=p[a],e.ports[c].isAddressable()){if(!(n=e.attached(c)).length)return!1;if(d=n.filter(function(t){return s([c,t])}),"all"===t.arrayPolicy.in){if(d.length!==n.length)return!1;continue}if(!d.length)return!1}else if(!s(c))return!1;return!0},s=function(){function t(t,e){this.port=t,this.scope=e}return t.prototype.connect=function(t){return null==t&&(t=null),this.port.openBracket(null,{scope:this.scope},t)},t.prototype.beginGroup=function(t,e){return null==e&&(e=null),this.port.openBracket(t,{scope:this.scope},e)},t.prototype.send=function(t,e){return null==e&&(e=null),this.port.sendIP("data",t,{scope:this.scope},e,!1)},t.prototype.endGroup=function(t,e){return null==e&&(e=null),this.port.closeBracket(t,{scope:this.scope},e)},t.prototype.disconnect=function(t){return null==t&&(t=null),this.endGroup(t)},t.prototype.isConnected=function(){return this.port.isConnected()},t.prototype.isAttached=function(){return this.port.isAttached()},t}(),v=function(t,n,o){var u,c,p,d,h,f,m,g,y,v,b,w,P,k,C,E,x,A,I,S,D,T,N,L,j,R,B,G,F;"gcFrequency"in n||(n.gcFrequency=100),"gcTimeout"in n||(n.gcTimeout=300),!1!==(d=n.forwardGroups)&&n.group&&(d=!0);for(y=0,w=(T=n.inPorts).length;y<w;y++)if(I=T[y],!t.inPorts[I])throw new Error("no inPort named '"+I+"'");for(v=0,P=(N=n.outPorts).length;v<P;v++)if(I=N[v],!t.outPorts[I])throw new Error("no outPort named '"+I+"'");h=function(){var e,r,o,i,s;for(s=[],e=0,r=(i=n.outPorts).length;e<r;e++)o=i[e],t.outPorts[o].isConnected()?s.push(t.outPorts[o].disconnect()):s.push(void 0);return s},G=function(e){var r,o,i,s,a;for(a=[],r=0,o=(s=n.outPorts).length;r<o;r++)i=s[r],a.push(t.outPorts[i].beginGroup(e));return a},p=function(e){var r,o,i,s,a;for(a=[],r=0,o=(s=n.outPorts).length;r<o;r++)i=s[r],a.push(t.outPorts[i].endGroup(e));return a},t.requiredParams=[],t.defaultedParams=[],t.gcCounter=0,t._wpData={},u=function(e){return e in t._wpData||(t._wpData[e]={},t._wpData[e].groupedData={},t._wpData[e].groupedGroups={},t._wpData[e].groupedDisconnects={},t._wpData[e].outputQ=[],t._wpData[e].taskQ=[],t._wpData[e].params={},t._wpData[e].completeParams=[],t._wpData[e].receivedParams=[],t._wpData[e].defaultsSent=!1,t._wpData[e].disconnectData={},t._wpData[e].disconnectQ=[],t._wpData[e].groupBuffers={},t._wpData[e].keyBuffers={},t._wpData[e].gcTimestamps={}),t._wpData[e]},t.params={},F=function(e){return t.params=u(e).params},D=function(t){for(var e,r,o,i,s;u(t).outputQ.length>0;){if(e=!1,null===(i=u(t).outputQ[0]))h(),e=!0;else for(r in 1===n.outPorts.length&&((s={})[n.outPorts[0]]=i,i=s),i)(o=i[r]).resolved&&(o.flush(),e=!0);if(e&&u(t).outputQ.shift(),!e)return}},n.async&&("load"in t.outPorts&&(t.load=0),t.beforeProcess=function(e,r){if(n.ordered&&u(e).outputQ.push(r),t.load++,t.emit("activate",t.load),"load"in t.outPorts&&t.outPorts.load.isAttached())return t.outPorts.load.send(t.load),t.outPorts.load.disconnect()},t.afterProcess=function(e,n,r){return D(e),t.load--,"load"in t.outPorts&&t.outPorts.load.isAttached()&&(t.outPorts.load.send(t.load),t.outPorts.load.disconnect()),t.emit("deactivate",t.load)}),t.sendDefaults=function(e){var n,r,o,s,a;if(t.defaultedParams.length>0)for(n=0,r=(s=t.defaultedParams).length;n<r;n++)o=s[n],-1===u(e).receivedParams.indexOf(o)&&(a=i.createSocket(),t.inPorts[o].attach(a),a.send(),a.disconnect(),t.inPorts[o].detach(a));return u(e).defaultsSent=!0},B=function(e){var n,r,o;if(u(e).completeParams.length===t.requiredParams.length&&u(e).taskQ.length>0){for(o=u(e).taskQ.slice(0),u(e).taskQ=[],n=[];o.length>0;)r=o.shift(),n.push(r());return n}};for(b=0,k=(L=n.params).length;b<k;b++){if(S=L[b],!t.inPorts[S])throw new Error("no inPort named '"+S+"'");t.inPorts[S].isRequired()&&t.requiredParams.push(S),t.inPorts[S].hasDefault()&&t.defaultedParams.push(S)}for(f=function(e){var r;return(r=t.inPorts[e]).handle=function(o){var i,s,a,c;if(i=o.type,a=o.data,c=o.scope,s=o.index,"data"===i){if(r.isAddressable()){if(e in u(c).params||(u(c).params[e]={}),u(c).params[e][s]=a,"all"===n.arrayPolicy.params&&Object.keys(u(c).params[e]).length<r.listAttached().length)return}else u(c).params[e]=a;return-1===u(c).completeParams.indexOf(e)&&t.requiredParams.indexOf(e)>-1&&u(c).completeParams.push(e),u(c).receivedParams.push(e),B(c)}}},x=0,C=(j=n.params).length;x<C;x++)f(S=j[x]);for(t.dropRequest=function(t,e){if(e in u(t).disconnectData&&delete u(t).disconnectData[e],e in u(t).groupedData&&delete u(t).groupedData[e],e in u(t).groupedGroups)return delete u(t).groupedGroups[e]},g=function(){var e,r,o,i,s,a,c,p;if(t.gcCounter++,t.gcCounter%n.gcFrequency==0){for(a=[],i=0,o=(s=Object.keys(t._wpData)).length;i<o;i++)c=s[i],e=(new Date).getTime(),a.push(function(){var o,i;for(r in i=[],o=u(c).gcTimestamps)p=o[r],e-p>1e3*n.gcTimeout?(t.dropRequest(c,r),i.push(delete u(c).gcTimestamps[r])):i.push(void 0);return i}());return a}},m=function(i){var c,f;return c=t.inPorts[i],f=d instanceof Array&&-1!==d.indexOf(i),c.handle=function(m){var y,v,b,w,P,k,C,E,x,A,S,T,N,L,j,R,M,q,U,z,H,J,Y,W,K,Q,X,V,Z,$,tt,et,nt,rt,ot,it,st;switch(C=m.index,M=m.data,$=m.scope,i in u($).groupBuffers||(u($).groupBuffers[i]=[]),i in u($).keyBuffers||(u($).keyBuffers[i]=null),m.type){case"openBracket":if(null===M)return;if(u($).groupBuffers[i].push(M),n.forwardGroups&&(!0===d||f)&&!n.async)return G(M);break;case"closeBracket":if(u($).groupBuffers[i]=u($).groupBuffers[i].slice(0,u($).groupBuffers[i].length-1),!n.forwardGroups||!0!==d&&!f||n.async||p(M),0===u($).groupBuffers[i].length){if(1===n.inPorts.length)return n.async||n.StreamSender?n.ordered?(u($).outputQ.push(null),D($)):u($).disconnectQ.push(!0):h();v=!1,(E=u($).keyBuffers[i])in u($).disconnectData||(u($).disconnectData[E]=[]);for(k=N=0,J=u($).disconnectData[E].length;0<=J?N<J:N>J;k=0<=J?++N:--N)if(!(i in u($).disconnectData[E][k])){v=!0,u($).disconnectData[E][k][i]=!0,Object.keys(u($).disconnectData[E][k]).length===n.inPorts.length&&(u($).disconnectData[E].shift(),n.async||n.StreamSender?n.ordered?(u($).outputQ.push(null),D($)):u($).disconnectQ.push(!0):h(),0===u($).disconnectData[E].length&&delete u($).disconnectData[E]);break}if(!v)return(L={})[i]=!0,u($).disconnectData[E].push(L)}break;case"data":if(1!==n.inPorts.length||c.isAddressable()){if(E="",n.group&&u($).groupBuffers[i].length>0){if(E=u($).groupBuffers[i].toString(),n.group instanceof RegExp){for(Q=null,z=0,x=(Y=u($).groupBuffers[i]).length;z<x;z++)if(P=Y[z],n.group.test(P)){Q=P;break}E=Q||""}}else n.field&&"object"===r(M)&&n.field in M&&(E=M[n.field]);u($).keyBuffers[i]=E,E in u($).groupedData||(u($).groupedData[E]=[]),E in u($).groupedGroups||(u($).groupedGroups[E]=[]),v=!1,X=n.inPorts.length,n.field&&++X;for(k=H=0,W=u($).groupedData[E].length;0<=W?H<W:H>W;k=0<=W?++H:--H)if(!(i in u($).groupedData[E][k])||t.inPorts[i].isAddressable()&&"all"===n.arrayPolicy.in&&!(C in u($).groupedData[E][k][i])){if(v=!0,t.inPorts[i].isAddressable()?(i in u($).groupedData[E][k]||(u($).groupedData[E][k][i]={}),u($).groupedData[E][k][i][C]=M):u($).groupedData[E][k][i]=M,f?u($).groupedGroups[E][k]=_.unique(O.call(u($).groupedGroups[E][k]).concat(O.call(u($).groupBuffers[i]))):!0===d&&(u($).groupedGroups[E][k][i]=u($).groupBuffers[i]),t.inPorts[i].isAddressable()&&"all"===n.arrayPolicy.in&&Object.keys(u($).groupedData[E][k][i]).length<t.inPorts[i].listAttached().length)return;if(Object.keys(u($).groupedData[E][k]).length===X){y=u($).groupedData[E].splice(k,1)[0],1===n.inPorts.length&&c.isAddressable()&&(y=y[i]),w=u($).groupedGroups[E].splice(k,1)[0],!0===d&&(w=_.intersection.apply(null,_.getValues(w))),0===u($).groupedData[E].length&&delete u($).groupedData[E],0===u($).groupedGroups[E].length&&delete u($).groupedGroups[E],n.group&&E&&delete u($).gcTimestamps[E];break}return}if(!v){if(L={},n.field&&(L[n.field]=E),t.inPorts[i].isAddressable()?(L[i]={},L[i][C]=M):L[i]=M,1!==n.inPorts.length||!t.inPorts[i].isAddressable()||"any"!==n.arrayPolicy.in&&1!==t.inPorts[i].listAttached().length)return u($).groupedData[E].push(L),f?u($).groupedGroups[E].push(u($).groupBuffers[i]):!0===d?((nt={})[i]=u($).groupBuffers[i],u($).groupedGroups[E].push(nt)):u($).groupedGroups[E].push([]),void(n.group&&E&&(u($).gcTimestamps[E]=(new Date).getTime()));y=L[i],w=u($).groupBuffers[i]}}else y=M,w=u($).groupBuffers[i];if(n.dropInput&&u($).completeParams.length!==t.requiredParams.length)return;for(R={},Z=0,A=(K=n.outPorts).length;Z<A;Z++)I=K[Z],st=new s(t.outPorts[I],$),n.async||n.sendStreams&&-1!==n.sendStreams.indexOf(I)?R[I]=new a(st,n.ordered):R[I]=st;if(1===n.outPorts.length&&(R=R[n.outPorts[0]]),w||(w=[]),w=function(){var t,e,n;for(e=[],n=0,t=w.length;n<t;n++)null!==(b=w[n])&&e.push(b);return e}(),it=w.slice(0),ot=function(e){var r,o,s,a,c;for(I in e&&t.error(e,it,"error",$),"function"==typeof t.fail&&t.hasErrors&&t.fail(null,[],$),a=R,1===n.outPorts.length&&((a={})[i]=R),r=!1,u($).disconnectQ.length>0&&(u($).disconnectQ.shift(),r=!0),a){if(s=a[I],n.forwardGroups&&n.async)for(c=0,o=it.length;c<o;c++)k=it[c],s.endGroup();r&&s.disconnect(),(n.async||n.StreamSender)&&s.done()}if("function"==typeof t.afterProcess)return t.afterProcess($,e||t.hasErrors,R)},"function"==typeof t.beforeProcess&&t.beforeProcess($,R),n.forwardGroups&&n.async)if(1===n.outPorts.length)for(tt=0,S=w.length;tt<S;tt++)b=w[tt],R.beginGroup(b);else for(I in R)for(j=R[I],rt=0,T=w.length;rt<T;rt++)b=w[rt],j.beginGroup(b);return e.MultiError(t,n.name,n.error,w,$),l("WirePattern Legacy API call with",y,w,t.params,$),n.async?(q=function(){},V=function(){},U=!1,et=function(){return F($),o.call(t,y,w,R,ot,q,V,$)},q=function(t){if(null==t&&(t=!0),U=t,t)return u($).taskQ.push(et)},V=function(){return U?B():et()}):et=function(){return F($),o.call(t,y,w,R,null,null,null,$),ot()},u($).taskQ.push(et),B($),g()}}},A=0,E=(R=n.inPorts).length;A<E;A++)m(S=R[A]);return c=t.tearDown,t.tearDown=function(e){return t.requiredParams=[],t.defaultedParams=[],t.gcCounter=0,t._wpData={},t.params={},c.call(t,e)},t},e.GroupedInput=e.WirePattern,e.CustomError=function(t,n){var r;return r=new Error(t),e.CustomizeError(r,n)},e.CustomizeError=function(t,e){var n,r;for(n in e)I.call(e,n)&&(r=e[n],t[n]=r);return t},e.MultiError=function(t,e,n,r,o){var i;return null==e&&(e=""),null==n&&(n="error"),null==r&&(r=[]),null==o&&(o=null),b.deprecated("noflo.helpers.MultiError is deprecated. Send errors to error port instead"),t.hasErrors=!1,t.errors=[],t.name&&!e&&(e=t.name),e||(e="Component"),t.error=function(e,n){return null==n&&(n=[]),t.errors.push({err:e,groups:r.concat(n)}),t.hasErrors=!0},t.fail=function(r,i){var s,a,u,c,p,d,l,h,f,m,g;if(null==r&&(r=null),null==i&&(i=[]),r&&t.error(r,i),t.hasErrors&&n in t.outPorts&&t.outPorts[n].isAttached()){for(e&&t.outPorts[n].openBracket(e,{scope:o}),u=0,d=(f=t.errors).length;u<d;u++){for(c=0,l=(m=(s=f[u]).groups).length;c<l;c++)a=m[c],t.outPorts[n].openBracket(a,{scope:o});for(t.outPorts[n].data(s.err,{scope:o}),p=0,h=(g=s.groups).length;p<h;p++)a=g[p],t.outPorts[n].closeBracket(a,{scope:o})}return e&&t.outPorts[n].closeBracket(e,{scope:o}),t.hasErrors=!1,t.errors=[]}},i=t.tearDown,t.tearDown=function(e){return t.hasErrors=!1,t.errors=[],i.call(t,e)},t}}).call(this)}).call(this,n(2))},function(t,e,n){(function(){var t,r,o,i={}.hasOwnProperty;o=n(11),r=n(5),t=function(t){function e(t){this.type=t,r.deprecated("noflo.ArrayPort is deprecated. Please port to noflo.InPort/noflo.OutPort and use addressable: true"),e.__super__.constructor.call(this,this.type)}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,o.Port),e.prototype.attach=function(t,e){return null==e&&(e=null),null===e&&(e=this.sockets.length),this.sockets[e]=t,this.attachSocket(t,e)},e.prototype.connect=function(t){if(null==t&&(t=null),null!==t){if(!this.sockets[t])throw new Error(this.getId()+": No connection '"+t+"' available");return this.sockets[t].connect()}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach(function(t){if(t)return t.connect()})},e.prototype.beginGroup=function(t,e){if(null==e&&(e=null),null!==e){var n;if(!this.sockets[e])throw new Error(this.getId()+": No connection '"+e+"' available");return this.isConnected(e)?this.sockets[e].beginGroup(t):(this.sockets[e].once("connect",function(n){return function(){return n.sockets[e].beginGroup(t)}}(this)),this.sockets[e].connect())}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach((n=this,function(e,r){if(e)return n.beginGroup(t,r)}))},e.prototype.send=function(t,e){if(null==e&&(e=null),null!==e){var n;if(!this.sockets[e])throw new Error(this.getId()+": No connection '"+e+"' available");return this.isConnected(e)?this.sockets[e].send(t):(this.sockets[e].once("connect",function(n){return function(){return n.sockets[e].send(t)}}(this)),this.sockets[e].connect())}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach((n=this,function(e,r){if(e)return n.send(t,r)}))},e.prototype.endGroup=function(t){if(null==t&&(t=null),null!==t){var e;if(!this.sockets[t])throw new Error(this.getId()+": No connection '"+t+"' available");return this.sockets[t].endGroup()}if(!this.sockets.length)throw new Error(this.getId()+": No connections available");this.sockets.forEach((e=this,function(t,n){if(t)return e.endGroup(n)}))},e.prototype.disconnect=function(t){var e,n,r,o;if(null==t&&(t=null),null!==t){if(this.sockets[t])return this.sockets[t].disconnect()}else{if(!this.sockets.length)throw new Error(this.getId()+": No connections available");for(e=0,n=(r=this.sockets).length;e<n;e++){if(!(o=r[e]))return;o.disconnect()}}},e.prototype.isConnected=function(t){var e;return null==t&&(t=null),null===t?(e=!1,this.sockets.forEach(function(t){if(t)return t.isConnected()?e=!0:void 0}),e):!!this.sockets[t]&&this.sockets[t].isConnected()},e.prototype.isAddressable=function(){return!0},e.prototype.isAttached=function(t){var e,n,r;if(void 0===t){for(e=0,n=(r=this.sockets).length;e<n;e++)if(r[e])return!0;return!1}return!!this.sockets[t]},e}(),e.ArrayPort=t}).call(this)},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(){var o,i,s,a,u,c,p,d,l,h,f,m;o=n(10).ComponentLoader,a=n(15).Network,s=n(4),c=n(6),i=n(7).Graph,p=function(e,n){return e||(e={}),e.name||(e.name=n),e.loader&&(e.baseDir=e.loader.baseDir),!e.baseDir&&t&&t.cwd&&(e.baseDir=t.cwd()),e.loader||(e.loader=new o(e.baseDir)),e.raw||(e.raw=!1),e},h=function(t,e,n){return e.loader.load(t,function(r,o){var s,u,c,p,d,l;if(r)return n(r);for(l in s=new i(e.name),p=e.name,s.addNode(p,t),u=o.inPorts.ports||o.inPorts,d=o.outPorts.ports||o.outPorts,u)u[l],s.addInport(l,p,l);for(l in d)d[l],s.addOutport(l,p,l);return s.componentLoader=e.loader,(c=new a(s,e)).connect(function(t){return t?n(t):n(null,c)})})},f=function(t,e,n,r){var o,i,a,u,p,d;return p=t.getNode(n.name),o=Object.keys(t.graph.inports),i={},o.forEach(function(t){return i[t]=c.createSocket(),p.component.inPorts[t].attach(i[t])}),d=[],a=Object.keys(t.graph.outports),u={},a.forEach(function(t){return u[t]=c.createSocket(),p.component.outPorts[t].attach(u[t]),u[t].on("ip",function(e){var n;return(n={})[t]=e,d.push(n)})}),t.once("end",function(){var t,e;for(t in u)e=u[t],p.component.outPorts[t].detach(e);return u={},i={},r(null,d)}),t.start(function(t){var n,o,a,u,c,p;if(t)return r(t);for(c=[],n=0,a=e.length;n<a;n++)o=e[n],c.push(function(){var t;for(u in t=[],o)p=o[u],s.isIP(p)?i[u].post(p):t.push(i[u].post(new s("data",p)));return t}());return c})},u=function(t,e){var n;if("object"!==r(t))return"simple";if(Array.isArray(t))return t.filter(function(t){return"map"===u(t,e)}).length===t.length?"sequence":"simple";if(!Object.keys(t).length)return"simple";for(n in t)if(t[n],!e.graph.inports[n])return"simple";return"map"},l=function(t,e,n){var r,o;return"sequence"===e?t:"map"===e?[t]:(r=Object.keys(n.graph.inports)[0],n.graph.inports.in&&(r="in"),(o={})[r]=t,[o])},d=function(t,e){var n,r,o,i,s,a;if(e.raw)return t;for(s=null,n=a=[],r=0,o=t.length;r<o;r++)"openBracket"===(i=t[r]).type&&(s=n,n=[],s.push(n)),"data"===i.type&&n.push(i.data),"closeBracket"===i.type&&(n=s);return 1===a.length?a[0]:a},m=function(t,e,n,r){var o,i,s,a,u,c,p,l,h,f,m;if((o=t.filter(function(t){return null!=t.error}).map(function(t){return t.error})).length)return r(d(o,n));if("sequence"===e)return r(null,t.map(function(t){var e,r,o;for(e in r={},t)o=t[e],n.raw?r[e]=o:r[e]=d([o],n);return r}));for(c={},i=0,a=t.length;i<a;i++)for(s in u=t[i])f=u[s],c[s]||(c[s]=[]),c[s].push(f);if(0===(m=Object.keys(c).filter(function(t){return c[t].length>0})).length)return r(null);if(1===m.length&&"simple"===e)return r(null,d(c[m[0]],n));for(l in h={},c)p=c[l],h[l]=d(p,n);return r(null,h)},e.asCallback=function(t,e){return e=p(e,t),function(n,r){return h(t,e,function(t,o){var i,s;return t?r(t):(s=u(n,o),i=l(n,s,o),f(o,i,e,function(t,n){return t?r(t):m(n,s,e,r)}))})}}}).call(this)}).call(this,n(2))},function(t,e,n){t.exports={iframe:n(94),opener:n(105)}},function(t,e,n){var r,o,i;r=window,o=n(22),(i=function(t){o.call(this,t),this.setClient(r.parent)}).prototype=new o,t.exports=function(t){t=o.normalizeOptions(t);var e=new i(t);return o.subscribe(r,function(t,n){"iframe"!==t.protocol||"setcontent"!==t.command?e.receive(t.protocol,t.command,t.payload,{href:n.origin}):document.body.innerHTML=t.payload}),e}},function(t,e,n){(function(){var e,r,o,i,s,a,u,c={}.hasOwnProperty;i=n(0),e=n(1).EventEmitter,u=function(t,e,n){var r;switch(r=i.internalSocket.createSocket(),t.attach(r),e){case"connect":r.connect();break;case"disconnect":r.disconnect();break;case"begingroup":r.beginGroup(n);break;case"endgroup":r.endGroup(n);break;case"data":r.send(n)}return t.detach(r)},o=function(t,e,n){var r,o,i;if(t.graph&&(null!=(o=n?t.graph.inports[e]:t.graph.outports[e])?o.process:void 0)&&(r=null!=(i=t.getNode(o.process))?i.component:void 0))return n?r.inPorts[o.port]:r.outPorts[o.port]},s=function(t,e,n,r){var i,s,a,u;return i={id:t,type:"all",description:null!=(a=e.metadata)?a.description:void 0,addressable:!1,required:!1},(s=o(n,t,r))?(i.type=s.getDataType(),s.getSchema&&(i.schema=s.getSchema()),i.description=(null!=(u=e.metadata)?u.description:void 0)||s.getDescription(),i.addressable=s.isAddressable(),i.required=s.isRequired(),i):i},a=function(t,e){var n,r,o,i,a;if(r={graph:t,inPorts:[],outPorts:[]},!(null!=e?e.graph:void 0))return r;for(o in i=e.graph.inports)n=i[o],r.inPorts.push(s(o,n,e,!0));for(o in a=e.graph.outports)n=a[o],r.outPorts.push(s(o,n,e,!1));return r},r=function(t){function n(t){var e;this.transport=t,this.outputSockets={},this.mainGraph=null,this.transport.network.on("addnetwork",(e=this,function(t,n){return e.subscribeExportedPorts(n,t,!0),e.subscribeOutPorts(n,t),e.sendPorts(n,t),t.isStarted()&&e.subscribeOutdata(n,t,!0),t.on("start",function(){return e.subscribeOutdata(n,t,!0)})})),this.transport.network.on("removenetwork",function(t){return function(e,n){return t.subscribeOutdata(n,e,!1),t.subscribeOutPorts(n,e),t.subscribeExportedPorts(n,e.graph,!1),t.sendPorts(n,null)}}(this))}return function(t,e){for(var n in e)c.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,e),n.prototype.send=function(t,e,n){return this.transport.send("runtime",t,e,n)},n.prototype.sendAll=function(t,e){return this.transport.sendAll("runtime",t,e)},n.prototype.sendError=function(t,e){return this.send("error",new Error(t),e)},n.prototype.receive=function(t,e,n){var r;if("packet"!==t||this.transport.canDo("protocol:runtime",e.secret))switch(t){case"getruntime":return this.getRuntime(e,n);case"packet":return this.sendPacket(e,(r=this,function(t){t&&r.sendError(t.message,n)}))}else this.send("error",new Error(t+" not permitted"),n)},n.prototype.getRuntime=function(t,e){var n,r,o,s,a,u,c,p;for(r in(c=this.transport.options.type)||(c=i.isBrowser()?"noflo-browser":"noflo-nodejs"),(n=this.transport.options.capabilities)||(n=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource"]),s=n.filter((p=this,function(e){return p.transport.canDo(e,t.secret)})),t={type:c,version:this.transport.version,capabilities:s,allCapabilities:n},this.mainGraph&&(t.graph=this.mainGraph),this.transport.options.id&&(t.id=this.transport.options.id),this.transport.options.label&&(t.label=this.transport.options.label),this.transport.options.namespace&&(t.namespace=this.transport.options.namespace),this.transport.options.repository&&(t.repository=this.transport.options.repository),this.transport.options.repositoryVersion&&(t.repositoryVersion=this.transport.options.repositoryVersion),this.send("runtime",t,e),u=[],a=this.transport.network.networks)o=a[r],u.push(this.sendPorts(r,o,e));return u},n.prototype.sendPorts=function(t,e,n){var r;return r=a(t,e),this.emit("ports",r),n?this.send("ports",r,n):this.sendAll("ports",r)},n.prototype.setMainGraph=function(t){return this.mainGraph=t},n.prototype.subscribeExportedPorts=function(t,e,n){var r,o,i,s,a,u,c,p,d;for(d=this,p=function(){return d.sendPorts(t,e)},i=0,a=(o=["addInport","addOutport","removeInport","removeOutport"]).length;i<a;i++)r=o[i],e.graph.removeListener(r,p);if(n){for(c=[],s=0,u=o.length;s<u;s++)r=o[s],c.push(e.graph.on(r,p));return c}},n.prototype.subscribeOutPorts=function(t,e,n){var r,o,i,s;if(s=this,i=function(){return s.subscribeOutdata(t,e,!1)},o=function(n){return function(){return n.subscribeOutdata(t,e,!0)}}(this),(r=e.graph).removeListener("addOutport",o),r.removeListener("removeOutport",i),n)return r.on("addOutport",o),r.on("removeOutport",i)},n.prototype.subscribeOutdata=function(t,e,n){var r,o,s,a,u,c,p,d;for(c in o=["data","begingroup","endgroup","connect","disconnect"],this.outputSockets[t]||(this.outputSockets[t]={}),s=this.outputSockets[t])for(p=s[c],a=0,u=o.length;a<u;a++)r=o[a],p.removeAllListeners(r);if(s={},n)return Object.keys(e.graph.outports).forEach((d=this,function(n){var a,u,c,l,h;for(a=e.graph.outports[n],p=i.internalSocket.createSocket(),s[n]=p,e.processes[a.process].component.outPorts[a.port].attach(p),h=function(e){return function(r){return d.emit("packet",{port:n,event:e,graph:t,payload:r}),d.sendAll("packet",{port:n,event:e,graph:t,payload:r})}},l=[],u=0,c=o.length;u<c;u++)r=o[u],l.push(p.on(r,h(r)));return l}))},n.prototype.sendPacket=function(t,e){var n,r;return(n=this.transport.network.networks[t.graph])?(r=o(n.network,t.port,!0))?u(r,t.event,t.payload):e(new Error("Cannot find internal port for "+t.port)):e(new Error("Cannot find network for graph "+t.graph))},n}(),t.exports=r}).call(this)},function(t,e,n){(function(){var e,r;r=n(0),e=function(){function t(t){this.transport=t,this.graphs={}}return t.prototype.send=function(t,e,n){return this.transport.send("graph",t,e,n)},t.prototype.sendAll=function(t,e){return this.transport.sendAll("graph",t,e)},t.prototype.receive=function(t,e,n){var r;if(this.transport.canDo("protocol:graph",e.secret))if("clear"===t||(r=this.resolveGraph(e,n)))switch(t){case"clear":return this.initGraph(e,n);case"addnode":return this.addNode(r,e,n);case"removenode":return this.removeNode(r,e,n);case"renamenode":return this.renameNode(r,e,n);case"changenode":return this.changeNode(r,e,n);case"addedge":return this.addEdge(r,e,n);case"removeedge":return this.removeEdge(r,e,n);case"changeedge":return this.changeEdge(r,e,n);case"addinitial":return this.addInitial(r,e,n);case"removeinitial":return this.removeInitial(r,e,n);case"addinport":return this.addInport(r,e,n);case"removeinport":return this.removeInport(r,e,n);case"renameinport":return this.renameInport(r,e,n);case"addoutport":return this.addOutport(r,e,n);case"removeoutport":return this.removeOutport(r,e,n);case"renameoutport":return this.renameOutport(r,e,n);case"addgroup":return this.addGroup(r,e,n);case"removegroup":return this.removeGroup(r,e,n);case"renamegroup":return this.renameGroup(r,e,n);case"changegroup":return this.changeGroup(r,e,n)}else this.send("error",new Error("Graph '"+e.graph+"' not found"),n);else this.send("error",new Error(t+" not permitted"),n)},t.prototype.resolveGraph=function(t,e){if(t.graph){if(this.graphs[t.graph])return this.graphs[t.graph];this.send("error",new Error("Requested graph not found"),e)}else this.send("error",new Error("No graph specified"),e)},t.prototype.getLoader=function(t){return this.transport.component.getLoader(t,this.transport.options)},t.prototype.sendGraph=function(t,e,n){var r;return r={graph:t,description:e.toJSON()},this.send("graph",r,n)},t.prototype.initGraph=function(t,e){var n,o;if(t.id)return t.name||(t.name="NoFlo runtime"),o=new r.Graph(t.name),n=t.id,t.library&&(t.library=t.library.replace("noflo-",""),o.properties.library=t.library,n=t.library+"/"+n),t.icon&&(o.properties.icon=t.icon),t.description&&(o.properties.description=t.description),o.baseDir=this.transport.options.baseDir,this.subscribeGraph(t.id,o,e),t.main?this.transport.runtime.setMainGraph(n,o,e):this.transport.component.registerGraph(n,o,e),this.graphs[t.id]=o,this.sendAll("clear",{id:t.id,name:t.name,library:t.library,main:t.main,icon:t.icon,description:t.description},e);this.send("error",new Error("No graph ID provided"),e)},t.prototype.registerGraph=function(t,e){return"default/main"===t&&this.transport.runtime.setMainGraph(t,e),this.subscribeGraph(t,e,""),this.graphs[t]=e},t.prototype.subscribeGraph=function(t,e,n){var r;return e.on("addNode",(r=this,function(e){return e.graph=t,r.sendAll("addnode",e,n)})),e.on("removeNode",function(e){return function(r){var o;return o={id:r.id,graph:t},e.sendAll("removenode",o,n)}}(this)),e.on("renameNode",function(e){return function(r,o){return e.sendAll("renamenode",{from:r,to:o,graph:t},n)}}(this)),e.on("changeNode",function(e){return function(r,o){return e.sendAll("changenode",{id:r.id,metadata:r.metadata,graph:t},n)}}(this)),e.on("addEdge",function(e){return function(r){var o;return"number"!=typeof r.from.index&&delete r.from.index,"number"!=typeof r.to.index&&delete r.to.index,o={src:r.from,tgt:r.to,metadata:r.metadata,graph:t},e.sendAll("addedge",o,n)}}(this)),e.on("removeEdge",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,graph:t},e.sendAll("removeedge",o,n)}}(this)),e.on("changeEdge",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,metadata:r.metadata,graph:t},e.sendAll("changeedge",o,n)}}(this)),e.on("addInitial",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,metadata:r.metadata,graph:t},e.sendAll("addinitial",o,n)}}(this)),e.on("removeInitial",function(e){return function(r){var o;return o={src:r.from,tgt:r.to,graph:t},e.sendAll("removeinitial",o,n)}}(this)),e.on("addGroup",function(e){return function(r){var o;return o={name:r.name,nodes:r.nodes,metadata:r.metadata,graph:t},e.sendAll("addgroup",o,n)}}(this)),e.on("removeGroup",function(e){return function(r){var o;return o={name:r.name,graph:t},e.sendAll("removegroup",o,n)}}(this)),e.on("renameGroup",function(e){return function(r,o){var i;return i={from:r,to:o,graph:t},e.sendAll("renamegroup",i,n)}}(this)),e.on("changeGroup",function(e){return function(r){var o;return o={name:r.name,metadata:r.metadata,graph:t},e.sendAll("changegroup",o,n)}}(this)),e.on("addInport",function(e){return function(r,o){var i;return i={public:r,node:o.process,port:o.port,metadata:o.metadata,graph:t},e.sendAll("addinport",i,n)}}(this)),e.on("addOutport",function(e){return function(r,o){var i;return i={public:r,node:o.process,port:o.port,metadata:o.metadata,graph:t},e.sendAll("addoutport",i,n)}}(this)),e.on("removeInport",function(e){return function(r,o){var i;return i={public:r,graph:t},e.sendAll("removeinport",i,n)}}(this)),e.on("removeOutport",function(e){return function(r,o){var i;return i={public:r,graph:t},e.sendAll("removeoutport",i,n)}}(this))},t.prototype.addNode=function(t,e,n){if(e.id||e.component)return t.addNode(e.id,e.component,e.metadata);this.send("error",new Error("No ID or component supplied"),n)},t.prototype.removeNode=function(t,e,n){if(e.id)return t.removeNode(e.id);this.send("error",new Error("No ID supplied"),n)},t.prototype.renameNode=function(t,e,n){if(e.from||e.to)return t.renameNode(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.changeNode=function(t,e,n){if(e.id||e.metadata)return t.setNodeMetadata(e.id,e.metadata);this.send("error",new Error("No id or metadata supplied"),n)},t.prototype.addEdge=function(t,e,n){if(e.src||e.tgt){if("number"!=typeof e.src.index&&"number"!=typeof e.tgt.index||!t.addEdgeIndex)return t.addEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata);t.addEdgeIndex(e.src.node,e.src.port,e.src.index,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}else this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.removeEdge=function(t,e,n){if(e.src||e.tgt)return t.removeEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port);this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.changeEdge=function(t,e,n){if(e.src||e.tgt)return t.setEdgeMetadata(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata);this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.addInitial=function(t,e,n){if(e.src||e.tgt){if(!t.addInitialIndex||"number"!=typeof e.tgt.index)return t.addInitial(e.src.data,e.tgt.node,e.tgt.port,e.metadata);t.addInitialIndex(e.src.data,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}else this.send("error",new Error("No src or tgt supplied"),n)},t.prototype.removeInitial=function(t,e,n){if(e.tgt)return t.removeInitial(e.tgt.node,e.tgt.port);this.send("error",new Error("No tgt supplied"),n)},t.prototype.addInport=function(t,e,n){if(e.public||e.node||e.port)return t.addInport(e.public,e.node,e.port,e.metadata);this.send("error",new Error("Missing exported inport information"),n)},t.prototype.removeInport=function(t,e,n){if(e.public)return t.removeInport(e.public);this.send("error",new Error("Missing exported inport name"),n)},t.prototype.renameInport=function(t,e,n){if(e.from||e.to)return t.renameInport(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.addOutport=function(t,e,n){if(e.public||e.node||e.port)return t.addOutport(e.public,e.node,e.port,e.metadata);this.send("error",new Error("Missing exported outport information"),n)},t.prototype.removeOutport=function(t,e,n){if(e.public)return t.removeOutport(e.public);this.send("error",new Error("Missing exported outport name"),n)},t.prototype.renameOutport=function(t,e,n){if(e.from||e.to)return t.renameOutport(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.addGroup=function(t,e,n){if(e.name||e.nodes||e.metadata)return t.addGroup(e.name,e.nodes,e.metadata);this.send("error",new Error("No name or nodes or metadata supplied"),n)},t.prototype.removeGroup=function(t,e,n){if(e.name)return t.removeGroup(e.name);this.send("error",new Error("No name supplied"),n)},t.prototype.renameGroup=function(t,e,n){if(e.from||e.to)return t.renameGroup(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)},t.prototype.changeGroup=function(t,e,n){if(e.name||e.metadata)return t.setEdgeMetadata(e.name,e.metadata);this.send("error",new Error("No name or metadata supplied"),n)},t}(),t.exports=e}).call(this)},function(t,e,n){(function(e){(function(){var r,o,i,s,a,u,c,p,d={}.hasOwnProperty;c=n(0),r=n(1).EventEmitter,p=function(t,n){var r,o,i,s;if(r={id:t.id,graph:n.graph},t.socket.from&&(r.src={node:t.socket.from.process.id,port:t.socket.from.port}),t.socket.to&&(r.tgt={node:t.socket.to.process.id,port:t.socket.to.port}),t.subgraph&&(r.subgraph=t.subgraph),t.group&&(r.group=t.group),t.datatype&&(r.type=t.datatype),t.schema&&(r.schema=t.schema),void 0!==t.data){if(c.isBrowser()||e.isBuffer(t.data)&&(t.data=t.data.slice(0,20)),(null!=(o=t.data)?o.toJSON:void 0)&&(r.data=t.data.toJSON()),null!=(i=t.data)?i.toString:void 0){if(r.data=t.data.toString(),"[object Object]"===r.data)try{r.data=JSON.parse(JSON.stringify(t.data))}catch(t){}}else r.data=t.data;(null!=(s=t.metadata)?s.secure:void 0)&&(r.data="DATA")}return r},a=function(t){return t?t.process+"("+t.port+")":""},s=function(t){return a(t.src)+" -> "+a(t.tgt)},i=function(t){return t?t.process.id+"("+t.port+")":""},u=function(t){return i(t.from)+" -> "+i(t.to)},o=function(t){function e(t){this.transport=t,this.networks={}}return function(t,e){for(var n in e)d.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,r),e.prototype.send=function(t,e,n){return this.transport.send("network",t,e,n)},e.prototype.sendAll=function(t,e){return this.transport.sendAll("network",t,e)},e.prototype.receive=function(t,e,n){var r;if(this.transport.canDo("protocol:network",e.secret)){if("list"===t||(r=this.resolveGraph(e,n)))switch(t){case"start":return this.startNetwork(r,e,n);case"stop":return this.stopNetwork(r,e,n);case"edges":return this.updateEdgesFilter(r,e,n);case"debug":return this.debugNetwork(r,e,n);case"getstatus":return this.getStatus(r,e,n)}}else this.send("error",new Error(t+" not permitted"),n)},e.prototype.resolveGraph=function(t,e){if(t.graph){if(this.transport.graph.graphs[t.graph])return this.transport.graph.graphs[t.graph];this.send("error",new Error("Requested graph not found"),e)}else this.send("error",new Error("No graph specified"),e)},e.prototype.updateEdgesFilter=function(t,e,n){var r,o,i,a,u,c;for((a=this.networks[e.graph])?a.filters={}:(a={network:null,filters:{}},this.networks[e.graph]=a),o=0,i=(u=e.edges).length;o<i;o++)r=u[o],c=s(r),a.filters[c]=!0;return this.send("edges",{graph:e.graph,edges:e.edges},n)},e.prototype.eventFiltered=function(t,e){var n;return!this.transport.options.filterData||(n=u(e.socket),this.networks[t].filters[n])},e.prototype.initNetwork=function(t,e,n,r){var o,i,s;if(!this.networks[e.graph]||!this.networks[e.graph].network)return t.componentLoader=this.transport.component.getLoader(t.baseDir,this.transport.options),(i=JSON.parse(JSON.stringify(this.transport.options))).delay=!0,c.createNetwork(t,function(t){return function(o,i){return o?r(o):(t.networks[e.graph]&&t.networks[e.graph].network?t.networks[e.graph].network=i:t.networks[e.graph]={network:i,filters:{}},t.emit("addnetwork",i,e.graph,t.networks),t.subscribeNetwork(i,e,n),i.connect(r))}}(this),i);(o=this.networks[e.graph].network).stop((s=this,function(i){return i?r(i):(delete s.networks[e.graph],s.emit("removenetwork",o,e.graph,s.networks),s.initNetwork(t,e,n,r))}))},e.prototype.subscribeNetwork=function(t,e,n){var r;return t.on("start",(r=this,function(o){return r.sendAll("started",{time:o.start,graph:e.graph,running:t.isRunning(),started:t.isStarted()},n)})),t.on("end",function(r){return function(o){return r.sendAll("stopped",{time:new Date,uptime:o.uptime,graph:e.graph,running:t.isRunning(),started:t.isStarted()},n)}}(this)),t.on("icon",function(t){return function(r){return r.graph=e.graph,t.sendAll("icon",r,n)}}(this)),t.on("connect",function(t){return function(r){if(t.eventFiltered(e.graph,r))return t.sendAll("connect",p(r,e),n)}}(this)),t.on("ip",function(t){return function(r){var o;if(t.eventFiltered(e.graph,r)){switch(o={id:r.id,socket:r.socket,subgraph:r.subgraph,metadata:r.metadata},r.type){case"openBracket":o.type="begingroup",o.group=r.data;break;case"data":o.type="data",o.data=r.data,o.datatype=r.datatype,o.schema=r.schema;break;case"closeBracket":o.type="endgroup",o.group=r.data}return t.sendAll(o.type,p(o,e),n)}}}(this)),t.on("disconnect",function(t){return function(r){if(t.eventFiltered(e.graph,r))return t.sendAll("disconnect",p(r,e),n)}}(this)),t.on("process-error",function(t){return function(r){var o,i,s,a,u;if(i=r.error.message,r.error.stack)for(o=r.error.stack.split("\n"),s=a=0,u=Math.min(o.length,3);0<=u?a<=u:a>=u;s=0<=u?++a:--a)i+="\n"+o[s];return t.sendAll("processerror",{id:r.id,error:i,graph:e.graph},n)}}(this))},e.prototype.startNetwork=function(t,e,n){var r,o,i;if(i=this,r=function(t){return t.start(function(t){if(t)return i.send("error",t,content)})},!(o=this.networks[e.graph])||!o.network)return this.initNetwork(t,e,n,function(t){return function(i){return i?t.send("error",i,n):(o=t.networks[e.graph],r(o.network))}}(this));r(o.network)},e.prototype.stopNetwork=function(t,e,n){var r;if(this.networks[e.graph]&&(r=this.networks[e.graph].network)){var o;if(!r.isStarted())return this.send("stopped",{time:new Date,graph:e.graph,running:r.isRunning(),started:r.isStarted()},n);this.networks[e.graph].network.stop((o=this,function(t){if(t)return o.send("error",t,n)}))}},e.prototype.debugNetwork=function(t,e,n){var r;if(this.networks[e.graph]&&(r=this.networks[e.graph].network))return null!=r.setDebug?r.setDebug(e.enable):console.log("Warning: Network.setDebug not supported. Update to newer NoFlo")},e.prototype.getStatus=function(t,e,n){var r;if(this.networks[e.graph]&&(r=this.networks[e.graph].network))return this.send("status",{graph:e.graph,running:r.isRunning(),started:r.isStarted()},n)},e}(),t.exports=o}).call(this)}).call(this,n(14).Buffer)},function(t,e,n){(function(){var e,r,o;o=n(0),r=n(99),e=function(){function t(t){this.transport=t}return t.prototype.loaders={},t.prototype.send=function(t,e,n){return this.transport.send("component",t,e,n)},t.prototype.receive=function(t,e,n){if(this.transport.canDo("protocol:component",e.secret))if("source"!==t||this.transport.canDo("component:setsource",e.secret))if("getsource"!==t||this.transport.canDo("component:getsource",e.secret))switch(t){case"list":return this.listComponents(e,n);case"getsource":return this.getSource(e,n);case"source":return this.setSource(e,n)}else this.send("error",new Error(t+" not permitted"),n);else this.send("error",new Error(t+" not permitted"),n);else this.send("error",new Error(t+" not permitted"),n)},t.prototype.getLoader=function(t,e){return null==e&&(e={}),this.loaders[t]||(this.loaders[t]=new o.ComponentLoader(t,e)),this.loaders[t]},t.prototype.listComponents=function(t,e){var n,r,o;return n=this.transport.options.baseDir,(r=this.getLoader(n,this.transport.options)).listComponents((o=this,function(t,n){var i,s;if(!t)return i=Object.keys(n),s=0,i.forEach(function(t){return o.processComponent(r,t,e,function(t){if(!(++s<i.length))return o.send("componentsready",s,e)})});o.send("error",t,e)}))},t.prototype.getSource=function(t,e){var n,r;return n=this.transport.options.baseDir,this.getLoader(n,this.transport.options).getSource(t.name,(r=this,function(n,o){var i,s;return n?null==(i=r.transport.graph.graphs[t.name])?void r.send("error",n,e):(s=t.name.split("/"),r.send("source",{name:s[1],library:s[0],code:JSON.stringify(i.toJSON()),language:"json"},e)):r.send("source",o,e)}))},t.prototype.setSource=function(t,e){var n,r,o;return n=this.transport.options.baseDir,(r=this.getLoader(n,this.transport.options)).setSource(t.library,t.name,t.code,t.language,(o=this,function(n){if(!n)return o.processComponent(r,r.normalizeName(t.library,t.name),e);o.send("error",n,e)}))},t.prototype.processComponent=function(t,e,n,r){return r||(r=function(){}),t.load(e,(o=this,function(t,i){if(!i){if(t instanceof Error)return o.send("error",t,n),r(t);i=t}if(i.isReady())return o.sendComponent(e,i,n),r(null);i.once("ready",function(){return o.sendComponent(e,i,n),r(null)})}),!0);var o},t.prototype.sendComponent=function(t,e,n){var r,o,i,s,a,u,c;for(a in o=[],i=[],u=e.inPorts)(s=u[a])&&"function"!=typeof s&&s.canAttach&&o.push({id:a,type:s.getDataType?s.getDataType():void 0,schema:s.getSchema?s.getSchema():void 0,required:s.isRequired?s.isRequired():void 0,addressable:s.isAddressable?s.isAddressable():void 0,description:s.getDescription?s.getDescription():void 0,values:s.options&&s.options.values?s.options.values:void 0,default:s.options&&s.options.default?s.options.default:void 0});for(a in c=e.outPorts)(s=c[a])&&"function"!=typeof s&&s.canAttach&&i.push({id:a,type:s.getDataType?s.getDataType():void 0,schema:s.getSchema?s.getSchema():void 0,required:s.isRequired?s.isRequired():void 0,addressable:s.isAddressable?s.isAddressable():void 0,description:s.getDescription?s.getDescription():void 0});return r=e.getIcon?e.getIcon():"blank",this.send("component",{name:t,description:e.description,subgraph:e.isSubgraph(),icon:r,inPorts:o,outPorts:i},n)},t.prototype.registerGraph=function(t,e,n){var o,i,s,a;return a=this,s=function(){return a.processComponent(o,t,n)},i=r.debounce(s,10),(o=this.getLoader(e.baseDir,this.transport.options)).listComponents(function(r){return function(s,a){if(!s)return o.registerComponent("",t,e),i();r.send("error",s,n)}}(this)),e.on("addNode",i),e.on("removeNode",i),e.on("renameNode",i),e.on("addEdge",i),e.on("removeEdge",i),e.on("addInitial",i),e.on("removeInitial",i),e.on("addInport",i),e.on("removeInport",i),e.on("renameInport",i),e.on("addOutport",i),e.on("removeOutport",i),e.on("renameOutport",i)},t}(),t.exports=e}).call(this)},function(t,e,n){(function(t,n){var r;!function(){var o="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},i=o._,s=Array.prototype,a=Object.prototype,u="undefined"!=typeof Symbol?Symbol.prototype:null,c=s.push,p=s.slice,d=a.toString,l=a.hasOwnProperty,h=Array.isArray,f=Object.keys,m=Object.create,g=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};e.nodeType?o._=y:(!n.nodeType&&n.exports&&(e=n.exports=y),e._=y),y.VERSION="1.9.1";var v,b=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}},w=function(t,e,n){return y.iteratee!==v?y.iteratee(t,e):null==t?y.identity:y.isFunction(t)?b(t,e,n):y.isObject(t)&&!y.isArray(t)?y.matcher(t):y.property(t)};y.iteratee=v=function(t,e){return w(t,e,1/0)};var P=function(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),o=0;o<n;o++)r[o]=arguments[o+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var i=Array(e+1);for(o=0;o<e;o++)i[o]=arguments[o];return i[e]=r,t.apply(this,i)}},k=function(t){if(!y.isObject(t))return{};if(m)return m(t);g.prototype=t;var e=new g;return g.prototype=null,e},C=function(t){return function(e){return null==e?void 0:e[t]}},E=function(t,e){return null!=t&&l.call(t,e)},x=function(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0},A=Math.pow(2,53)-1,_=C("length"),O=function(t){var e=_(t);return"number"==typeof e&&e>=0&&e<=A};y.each=y.forEach=function(t,e,n){var r,o;if(e=b(e,n),O(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var i=y.keys(t);for(r=0,o=i.length;r<o;r++)e(t[i[r]],i[r],t)}return t},y.map=y.collect=function(t,e,n){e=w(e,n);for(var r=!O(t)&&y.keys(t),o=(r||t).length,i=Array(o),s=0;s<o;s++){var a=r?r[s]:s;i[s]=e(t[a],a,t)}return i};var I=function(t){return function(e,n,r,o){var i=arguments.length>=3;return function(e,n,r,o){var i=!O(e)&&y.keys(e),s=(i||e).length,a=t>0?0:s-1;for(o||(r=e[i?i[a]:a],a+=t);a>=0&&a<s;a+=t){var u=i?i[a]:a;r=n(r,e[u],u,e)}return r}(e,b(n,o,4),r,i)}};y.reduce=y.foldl=y.inject=I(1),y.reduceRight=y.foldr=I(-1),y.find=y.detect=function(t,e,n){var r=(O(t)?y.findIndex:y.findKey)(t,e,n);if(void 0!==r&&-1!==r)return t[r]},y.filter=y.select=function(t,e,n){var r=[];return e=w(e,n),y.each(t,function(t,n,o){e(t,n,o)&&r.push(t)}),r},y.reject=function(t,e,n){return y.filter(t,y.negate(w(e)),n)},y.every=y.all=function(t,e,n){e=w(e,n);for(var r=!O(t)&&y.keys(t),o=(r||t).length,i=0;i<o;i++){var s=r?r[i]:i;if(!e(t[s],s,t))return!1}return!0},y.some=y.any=function(t,e,n){e=w(e,n);for(var r=!O(t)&&y.keys(t),o=(r||t).length,i=0;i<o;i++){var s=r?r[i]:i;if(e(t[s],s,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,r){return O(t)||(t=y.values(t)),("number"!=typeof n||r)&&(n=0),y.indexOf(t,e,n)>=0},y.invoke=P(function(t,e,n){var r,o;return y.isFunction(e)?o=e:y.isArray(e)&&(r=e.slice(0,-1),e=e[e.length-1]),y.map(t,function(t){var i=o;if(!i){if(r&&r.length&&(t=x(t,r)),null==t)return;i=t[e]}return null==i?i:i.apply(t,n)})}),y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,n){var r,o,i=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=O(t)?t:y.values(t)).length;a<u;a++)null!=(r=t[a])&&r>i&&(i=r);else e=w(e,n),y.each(t,function(t,n,r){((o=e(t,n,r))>s||o===-1/0&&i===-1/0)&&(i=t,s=o)});return i},y.min=function(t,e,n){var r,o,i=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=O(t)?t:y.values(t)).length;a<u;a++)null!=(r=t[a])&&r<i&&(i=r);else e=w(e,n),y.each(t,function(t,n,r){((o=e(t,n,r))<s||o===1/0&&i===1/0)&&(i=t,s=o)});return i},y.shuffle=function(t){return y.sample(t,1/0)},y.sample=function(t,e,n){if(null==e||n)return O(t)||(t=y.values(t)),t[y.random(t.length-1)];var r=O(t)?y.clone(t):y.values(t),o=_(r);e=Math.max(Math.min(e,o),0);for(var i=o-1,s=0;s<e;s++){var a=y.random(s,i),u=r[s];r[s]=r[a],r[a]=u}return r.slice(0,e)},y.sortBy=function(t,e,n){var r=0;return e=w(e,n),y.pluck(y.map(t,function(t,n,o){return{value:t,index:r++,criteria:e(t,n,o)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var S=function(t,e){return function(n,r,o){var i=e?[[],[]]:{};return r=w(r,o),y.each(n,function(e,o){var s=r(e,o,n);t(i,e,s)}),i}};y.groupBy=S(function(t,e,n){E(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=S(function(t,e,n){t[n]=e}),y.countBy=S(function(t,e,n){E(t,n)?t[n]++:t[n]=1});var D=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(t){return t?y.isArray(t)?p.call(t):y.isString(t)?t.match(D):O(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:O(t)?t.length:y.keys(t).length},y.partition=S(function(t,e,n){t[n?0:1].push(e)},!0),y.first=y.head=y.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return p.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return p.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,Boolean)};var T=function(t,e,n,r){for(var o=(r=r||[]).length,i=0,s=_(t);i<s;i++){var a=t[i];if(O(a)&&(y.isArray(a)||y.isArguments(a)))if(e)for(var u=0,c=a.length;u<c;)r[o++]=a[u++];else T(a,e,n,r),o=r.length;else n||(r[o++]=a)}return r};y.flatten=function(t,e){return T(t,e,!1)},y.without=P(function(t,e){return y.difference(t,e)}),y.uniq=y.unique=function(t,e,n,r){y.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=w(n,r));for(var o=[],i=[],s=0,a=_(t);s<a;s++){var u=t[s],c=n?n(u,s,t):u;e&&!n?(s&&i===c||o.push(u),i=c):n?y.contains(i,c)||(i.push(c),o.push(u)):y.contains(o,u)||o.push(u)}return o},y.union=P(function(t){return y.uniq(T(t,!0,!0))}),y.intersection=function(t){for(var e=[],n=arguments.length,r=0,o=_(t);r<o;r++){var i=t[r];if(!y.contains(e,i)){var s;for(s=1;s<n&&y.contains(arguments[s],i);s++);s===n&&e.push(i)}}return e},y.difference=P(function(t,e){return e=T(e,!0,!0),y.filter(t,function(t){return!y.contains(e,t)})}),y.unzip=function(t){for(var e=t&&y.max(t,_).length||0,n=Array(e),r=0;r<e;r++)n[r]=y.pluck(t,r);return n},y.zip=P(y.unzip),y.object=function(t,e){for(var n={},r=0,o=_(t);r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n};var N=function(t){return function(e,n,r){n=w(n,r);for(var o=_(e),i=t>0?0:o-1;i>=0&&i<o;i+=t)if(n(e[i],i,e))return i;return-1}};y.findIndex=N(1),y.findLastIndex=N(-1),y.sortedIndex=function(t,e,n,r){for(var o=(n=w(n,r,1))(e),i=0,s=_(t);i<s;){var a=Math.floor((i+s)/2);n(t[a])<o?i=a+1:s=a}return i};var L=function(t,e,n){return function(r,o,i){var s=0,a=_(r);if("number"==typeof i)t>0?s=i>=0?i:Math.max(i+a,s):a=i>=0?Math.min(i+1,a):i+a+1;else if(n&&i&&a)return r[i=n(r,o)]===o?i:-1;if(o!=o)return(i=e(p.call(r,s,a),y.isNaN))>=0?i+s:-1;for(i=t>0?s:a-1;i>=0&&i<a;i+=t)if(r[i]===o)return i;return-1}};y.indexOf=L(1,y.findIndex,y.sortedIndex),y.lastIndexOf=L(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),i=0;i<r;i++,t+=n)o[i]=t;return o},y.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,o=t.length;r<o;)n.push(p.call(t,r,r+=e));return n};var j=function(t,e,n,r,o){if(!(r instanceof e))return t.apply(n,o);var i=k(t.prototype),s=t.apply(i,o);return y.isObject(s)?s:i};y.bind=P(function(t,e,n){if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var r=P(function(o){return j(t,r,e,this,n.concat(o))});return r}),y.partial=P(function(t,e){var n=y.partial.placeholder,r=function(){for(var o=0,i=e.length,s=Array(i),a=0;a<i;a++)s[a]=e[a]===n?arguments[o++]:e[a];for(;o<arguments.length;)s.push(arguments[o++]);return j(t,r,this,this,s)};return r}),y.partial.placeholder=y,y.bindAll=P(function(t,e){var n=(e=T(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=y.bind(t[r],t)}}),y.memoize=function(t,e){var n=function(r){var o=n.cache,i=""+(e?e.apply(this,arguments):r);return E(o,i)||(o[i]=t.apply(this,arguments)),o[i]};return n.cache={},n},y.delay=P(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,n){var r,o,i,s,a=0;n||(n={});var u=function(){a=!1===n.leading?0:y.now(),r=null,s=t.apply(o,i),r||(o=i=null)},c=function(){var c=y.now();a||!1!==n.leading||(a=c);var p=e-(c-a);return o=this,i=arguments,p<=0||p>e?(r&&(clearTimeout(r),r=null),a=c,s=t.apply(o,i),r||(o=i=null)):r||!1===n.trailing||(r=setTimeout(u,p)),s};return c.cancel=function(){clearTimeout(r),a=0,r=o=i=null},c},y.debounce=function(t,e,n){var r,o,i=function(e,n){r=null,n&&(o=t.apply(e,n))},s=P(function(s){if(r&&clearTimeout(r),n){var a=!r;r=setTimeout(i,e),a&&(o=t.apply(this,s))}else r=y.delay(i,e,this,s);return o});return s.cancel=function(){clearTimeout(r),r=null},s},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},y.once=y.partial(y.before,2),y.restArguments=P;var R=!{toString:null}.propertyIsEnumerable("toString"),B=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],G=function(t,e){var n=B.length,r=t.constructor,o=y.isFunction(r)&&r.prototype||a,i="constructor";for(E(t,i)&&!y.contains(e,i)&&e.push(i);n--;)(i=B[n])in t&&t[i]!==o[i]&&!y.contains(e,i)&&e.push(i)};y.keys=function(t){if(!y.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)E(t,n)&&e.push(n);return R&&G(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return R&&G(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r},y.mapObject=function(t,e,n){e=w(e,n);for(var r=y.keys(t),o=r.length,i={},s=0;s<o;s++){var a=r[s];i[a]=e(t[a],a,t)}return i},y.pairs=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=[e[o],t[e[o]]];return r},y.invert=function(t){for(var e={},n=y.keys(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()};var F=function(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var o=1;o<r;o++)for(var i=arguments[o],s=t(i),a=s.length,u=0;u<a;u++){var c=s[u];e&&void 0!==n[c]||(n[c]=i[c])}return n}};y.extend=F(y.allKeys),y.extendOwn=y.assign=F(y.keys),y.findKey=function(t,e,n){e=w(e,n);for(var r,o=y.keys(t),i=0,s=o.length;i<s;i++)if(e(t[r=o[i]],r,t))return r};var M,q,U=function(t,e,n){return e in n};y.pick=P(function(t,e){var n={},r=e[0];if(null==t)return n;y.isFunction(r)?(e.length>1&&(r=b(r,e[1])),e=y.allKeys(t)):(r=U,e=T(e,!1,!1),t=Object(t));for(var o=0,i=e.length;o<i;o++){var s=e[o],a=t[s];r(a,s,t)&&(n[s]=a)}return n}),y.omit=P(function(t,e){var n,r=e[0];return y.isFunction(r)?(r=y.negate(r),e.length>1&&(n=e[1])):(e=y.map(T(e,!1,!1),String),r=function(t,n){return!y.contains(e,n)}),y.pick(t,r,n)}),y.defaults=F(y.allKeys,!0),y.create=function(t,e){var n=k(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),r=n.length;if(null==t)return!r;for(var o=Object(t),i=0;i<r;i++){var s=n[i];if(e[s]!==o[s]||!(s in o))return!1}return!0},M=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&q(t,e,n,r)},q=function(t,e,n,r){t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var o=d.call(t);if(o!==d.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return u.valueOf.call(t)===u.valueOf.call(e)}var i="[object Array]"===o;if(!i){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(y.isFunction(s)&&s instanceof s&&y.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var c=(n=n||[]).length;c--;)if(n[c]===t)return r[c]===e;if(n.push(t),r.push(e),i){if((c=t.length)!==e.length)return!1;for(;c--;)if(!M(t[c],e[c],n,r))return!1}else{var p,l=y.keys(t);if(c=l.length,y.keys(e).length!==c)return!1;for(;c--;)if(p=l[c],!E(e,p)||!M(t[p],e[p],n,r))return!1}return n.pop(),r.pop(),!0},y.isEqual=function(t,e){return M(t,e)},y.isEmpty=function(t){return null==t||(O(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=h||function(t){return"[object Array]"===d.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){y["is"+t]=function(e){return d.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return E(t,"callee")});var z=o.document&&o.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof z&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return!y.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&isNaN(t)},y.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===d.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){if(!y.isArray(e))return E(t,e);for(var n=e.length,r=0;r<n;r++){var o=e[r];if(null==t||!l.call(t,o))return!1;t=t[o]}return!!n},y.noConflict=function(){return o._=i,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=function(t){return y.isArray(t)?function(e){return x(e,t)}:C(t)},y.propertyOf=function(t){return null==t?function(){}:function(e){return y.isArray(e)?x(t,e):t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,n){var r=Array(Math.max(0,t));e=b(e,n,1);for(var o=0;o<t;o++)r[o]=e(o);return r},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},J=y.invert(H),Y=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(o,e):t}};y.escape=Y(H),y.unescape=Y(J),y.result=function(t,e,n){y.isArray(e)||(e=[e]);var r=e.length;if(!r)return y.isFunction(n)?n.call(t):n;for(var o=0;o<r;o++){var i=null==t?void 0:t[e[o]];void 0===i&&(i=n,o=r),t=y.isFunction(i)?i.call(t):i}return t};var W=0;y.uniqueId=function(t){var e=++W+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},X=/\\|'|\r|\n|\u2028|\u2029/g,V=function(t){return"\\"+Q[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var r,o=RegExp([(e.escape||K).source,(e.interpolate||K).source,(e.evaluate||K).source].join("|")+"|$","g"),i=0,s="__p+='";t.replace(o,function(e,n,r,o,a){return s+=t.slice(i,a).replace(X,V),i=a+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(t){return r.call(this,t,y)},u=e.variable||"obj";return a.source="function("+u+"){\n"+s+"}",a},y.chain=function(t){var e=y(t);return e._chain=!0,e};var Z=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){return y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),Z(this,n.apply(y,t))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],Z(this,n)}}),y.each(["concat","join","slice"],function(t){var e=s[t];y.prototype[t]=function(){return Z(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)},void 0===(r=function(){return y}.apply(e,[]))||(n.exports=r)}()}).call(this,n(9),n(100)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){(function(){var e,r,o,i,s,a,u,c,p,d;p=n(0),i=n(3)("noflo-runtime-base:trace"),u=JSON.stringify;try{u=n(102)}catch(a){s=a,console.log("WARN: failed to load json-stringify-safe, circular objects may cause fail.\n"+s.message)}o=function(t){var e;return e=u(t),JSON.parse(e)},e=function(){function t(){this.events=[]}return t.prototype.add=function(t){return this.events.push(t)},t.prototype.getAll=function(t,e){var n,r,o;for(n=0,r=(o=this.events).length;n<r;n++)t(s=o[n]);return e(null)},t}(),d=function(t,e,n,r){var o,i,s,a,u,c,d,l,h;for(c in i={},d=t.graph.outports)for(a=d[c],h=p.internalSocket.createSocket(),i[c]=h,t.processes[a.process].component.outPorts[a.port].attach(h),l=function(t){return function(n){var o;return o={id:"EXPORT: "+e+" "+c.toUpperCase()+" ->",payload:n,socket:{to:{process:{id:e},port:c}}},r(t,o)}},s=0,u=n.length;s<u;s++)o=n[s],h.on(o,l(o));return i},c=function(t,e,n){var r,a,u,c,p,d,l,h,f;switch(i("event",t,e,"'"+n.id+"'"),f=n.socket,h=function(t){var e;try{return t.group=n.group.toString()}catch(e){return i("group serialization error",s=e),t.error=s.message}},u=(a={protocol:"network",command:e,payload:{time:(new Date).toISOString(),graph:t,error:null,src:{node:null!=(c=f.from)?c.process.id:void 0,port:null!=(p=f.from)?p.port:void 0},tgt:{node:null!=(d=f.to)?d.process.id:void 0,port:null!=(l=f.to)?l.port:void 0},id:void 0,subgraph:void 0}}).payload,e){case"connect":case"disconnect":break;case"begingroup":case"endgroup":h(a.payload);break;case"data":try{u.data=o(n.data)}catch(r){i("data serialization error",s=r),u.error=s.message}break;default:throw new Error("trace: Unknown event type "+e)}return i("event done",t,e,"'"+n.id+"'"),a},r=function(){function t(t){this.options=t,this.buffer=new e,this.header={graphs:{}}}return t.prototype.attach=function(t){var e,n,r;return n=t.graph.name||t.graph.properties.name||"default",i("attach",n),(e=["connect","begingroup","data","endgroup","disconnect"]).forEach((r=this,function(e){return t.on(e,function(t){var o;return o=c(n,e,t),r.buffer.add(o)})})),d(t,n,e,function(t){return function(e,r){var o;return o=c(n,e,r),t.buffer.add(o)}}(this)),this.header.graphs[n]=t.graph.toJSON()},t.prototype.detach=function(t){},t.prototype.dumpString=function(t){var e,n,r;return n=[],e=function(t){return n.push(t)},this.buffer.getAll(e,(r=this,function(e){var o;return o={header:r.header,events:n},t(e,JSON.stringify(o,null,2))}))},t.prototype.dumpFile=function(t,e){var r,o,s,a;return r=n(8),s=n(103),o=function(e){return r.open(t,"w",function(n,r){return e(n,{path:t,fd:r})})},t||(o=function(t){return s.open({suffix:".json"},t)}),o((a=this,function(t,n){var o,s,u,c;return t?e(t):(o=0,u=function(t,e){return r.write(n.fd,t,{encoding:"utf-8"},e)},c=function(t){var e;return e=o?",":"",o+=1,e+=JSON.stringify(t,null,2),u(e,function(t){})},i("streaming to file",n.path),s=JSON.stringify(a.header,null,2),u('{\n "header": '+s+'\n, "events":\n[',function(t){return a.buffer.getAll(c,function(t){return t?e(t):(i("streamed "+o+" events"),u("]\n }",function(t){return i("completed stream",n.path),e(t,n.path)}))})}))}))},t}(),t.exports.Tracer=r}).call(this)},function(t,e){function n(t,e){var n=[],r=[];return null==e&&(e=function(t,e){return n[0]===e?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(e)).join(".")+"]"}),function(o,i){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?r.splice(s,1/0,o):r.push(o),~n.indexOf(i)&&(i=e.call(this,o,i))}else n.push(i);return null==t?i:t.call(this,o,i)}}(t.exports=function(t,e,r,o){return JSON.stringify(t,n(e,o),r)}).getSerialize=n},function(t,e){t.exports=require("temp")},function(t,e,n){(function(t){(function(){var t,r,o,i,s=function(t,e){for(var n in e)a.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},a={}.hasOwnProperty;t=n(23),i=n(1).EventEmitter,o=function(e){function n(t){n.__super__.constructor.call(this,t),this.clients=[]}return s(n,t),n.prototype._connect=function(t){return this.clients.push(t),t.on("send",(e=this,function(n){return e._receive(n,{client:t})}));var e},n.prototype._disconnect=function(t){if(-1!==this.clients.indexOf(t))return this.clients.splice(this.clients.indexOf(t),1),t.removeAllListeners("send")},n.prototype._receive=function(t,e){return this.receive(t.protocol,t.command,t.payload,e)},n.prototype.send=function(t,e,n,r){var o;if(r.client)return o={protocol:t,command:e,payload:n},r.client._receive(o)},n.prototype.sendAll=function(t,e,n){var r,o,i,s,a,u;for(s={protocol:t,command:e,payload:n},u=[],o=0,i=(a=this.clients).length;o<i;o++)r=a[o],u.push(r._receive(s));return u},n}(),r=function(t){function e(t,n){this.name=n,e.__super__.constructor.call(this),this.runtime=t,this.name||(this.name="Unnamed client")}return s(e,i),e.prototype.connect=function(){return this.runtime._connect(this)},e.prototype.disconnect=function(){return this.runtime._disconnect(this)},e.prototype.send=function(t,e,n){var r;return r={protocol:t,command:e,payload:n},this.emit("send",r)},e.prototype._receive=function(t){return setTimeout((e=this,function(){return e.emit("message",t)}),1);var e},e}(),e.Client=r,e.Runtime=o}).call(this)}).call(this,n(2))},function(t,e,n){var r,o;window,r=n(22),((o=function(t,e){r.call(this,t),e&&e.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),this.openClient(e.getAttribute("href"))}.bind(this))}).prototype=new r).openClient=function(t){var e=window.open(t,"_blank");if(!e)throw new Error("Unable to open client window");this.context={href:"*"};var n=function(t){var e;(e="string"==typeof t.data?JSON.parse(t.data):t.data).protocol&&e.command&&this.receive(e.protocol,e.command,e.payload,this.context)}.bind(this),r=setInterval(function(){e&&!e.closed||(this.setClient(null),window.removeEventListener("message",n),clearInterval(r))}.bind(this),1e3);this.setClient(e),window.addEventListener("message",n)},t.exports=function(t,e){return t=r.normalizeOptions(t),new o(t,e)}}]);